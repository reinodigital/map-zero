import{a as z,b as J}from"./chunk-B7XUX2AB.js";import{a as j}from"./chunk-B2MQD4SO.js";import{a as U}from"./chunk-SVF2QQ2X.js";import{a as G}from"./chunk-QULINWIQ.js";import{b as R,c as o,d as w,e as A,h as O,k as L,n as V,o as M,p as k,q as P,t as q,u as B}from"./chunk-UQEQGUXM.js";import{A as I,k as _,p as F,r as T,v as N,z as D}from"./chunk-K4252JJD.js";import{Ba as b,Ib as t,La as c,Va as g,_a as s,ba as a,eb as C,ia as E,ja as x,jb as u,ob as e,pb as i,qb as d,ub as y,wa as f,yb as S,zb as v}from"./chunk-QAVPLLNK.js";function X(r,l){r&1&&(e(0,"small",13),t(1," nombre debe tener m\xE1s de 2 caracteres "),i())}function $(r,l){r&1&&(e(0,"small",13),t(1," tel\xE9fono debe ser un n\xFAmero de 8 d\xEDgitos "),i())}function H(r,l){r&1&&(e(0,"small",13),t(1," formato incorrecto de correo "),i())}function K(r,l){r&1&&(e(0,"small",13),t(1," c\xE9dula debe tener enter 9 a 12 caracteres "),i())}function Q(r,l){if(r&1){let n=y();e(0,"form",7),S("ngSubmit",function(){E(n);let p=v();return x(p.onSubmit())}),e(1,"div",8)(2,"div",9)(3,"label",10),t(4,"Nombre "),e(5,"span",11),t(6,"*"),i()(),d(7,"input",12),s(8,X,2,0,"small",13),i(),e(9,"div",9)(10,"label",14),t(11," Tipo contacto "),e(12,"span",11),t(13,"*"),i()(),e(14,"select",15)(15,"option",16),t(16,"CLIENTE"),i(),e(17,"option",17),t(18,"PROVEEDOR"),i()()(),e(19,"div",9)(20,"label",18),t(21,"Tel\xE9fono "),e(22,"span",11),t(23,"*"),i()(),d(24,"input",19),s(25,$,2,0,"small",13),i(),e(26,"div",9)(27,"label",20),t(28," Correo electr\xF3nico "),e(29,"span",11),t(30,"*"),i()(),d(31,"input",21),s(32,H,2,0,"small",13),i(),e(33,"div",9)(34,"label",22),t(35," C\xE9dula "),e(36,"span",11),t(37,"*"),i()(),d(38,"input",23),s(39,K,2,0,"small",13),i(),e(40,"div",9)(41,"label",24),t(42," Tipo C\xE9dula "),e(43,"span",11),t(44,"*"),i()(),e(45,"select",25)(46,"option",26),t(47,"F\xEDsica"),i(),e(48,"option",27),t(49,"Jur\xEDdica"),i(),e(50,"option",28),t(51,"DIMEX"),i(),e(52,"option",29),t(53,"NITE"),i()()(),e(54,"div",9)(55,"label",30),t(56," Moneda "),e(57,"span",11),t(58,"*"),i()(),e(59,"select",31)(60,"option",32),t(61,"USD"),i(),e(62,"option",33),t(63,"CRC"),i()()(),e(64,"div",9)(65,"label",34),t(66," Vendedor "),e(67,"span",35),t(68,"opcional"),i()(),d(69,"ng-select",36),i()(),e(70,"div",8)(71,"div",37)(72,"label",38),t(73," Notas "),e(74,"span",35),t(75,"opcional"),i()(),d(76,"textarea",39),i()(),e(77,"div",40)(78,"button",41),t(79,"Editar"),i()()()}if(r&2){let n=v();C("formGroup",n.editClientForm()),c(8),u(n.validField("name")?8:-1),c(17),u(n.validField("mobile")?25:-1),c(7),u(n.validField("email")?32:-1),c(7),u(n.validField("identity")?39:-1),c(30),C("items",n.sellers())("searchable",!0)}}var h=class r{platformId=a(b);fb=a(q);commonAdminService=a(j);router=a(T);activatedRoute=a(F);authService=a(N);clientService=a(D);formErrorService=a(U);customToastService=a(G);clientId;client=f(null);sellers=f([]);emailPattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$";editClientForm=f(null);get isBrowser(){return _(this.platformId)}constructor(){this.clientId=this.activatedRoute.snapshot.params.id}ngOnInit(){this.fetchClient()}fetchClient(){this.clientService.fetchOne(this.clientId).subscribe(l=>{l&&l.id&&(this.client.set(l),this.fetchSellers())})}fetchSellers(){this.authService.fetchAllSellers().subscribe(l=>{if(l&&l.length){this.sellers.set(l);let n=this.sellers().find(m=>m.name===this.client()?.defaultSeller)||null;this.fillOutClientForm(n?.name??null)}})}fillOutClientForm(l){this.editClientForm.set(this.fb.group({name:[this.client()?.name??"",[o.required,o.minLength(2)]],type:[this.client()?.type,[o.required]],email:[this.client()?.email??"",[o.required,o.pattern(this.emailPattern)]],mobile:[this.client()?.mobile??"",[o.required,o.minLength(8),o.maxLength(8)]],identity:[this.client()?.identity??"",[o.required,o.minLength(8),o.maxLength(12)]],identityType:[this.client()?.identityType,[o.required]],currency:[this.client()?.currency??"USD",[o.required]],notes:[this.client()?.notes??"",[]],defaultSeller:[l,[]]}))}validField(l){return this.editClientForm().controls[l].touched&&this.editClientForm().controls[l].invalid}onSubmit(){if(this.editClientForm()?.invalid){this.formErrorService.throwFormErrors(this.editClientForm());return}let l={};l.updatedAt=I(new Date);for(let n in this.editClientForm()?.value)if(this.editClientForm()?.value.hasOwnProperty(n)){let m=this.editClientForm().controls[n],p=m.value;m&&(l[n]=p),!p&&n==="defaultSeller"&&(l[n]=null)}this.clientService.update(this.clientId,l).subscribe(n=>{n&&n.msg?(this.customToastService.add({message:n.msg,type:"success",duration:5e3}),this.router.navigateByUrl("/list-clients")):this.customToastService.add({message:n.message,type:"error",duration:5e3})})}comeBackToList(){this.commonAdminService.comeBackToList("/list-clients")}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=g({type:r,selectors:[["edit-client"]],decls:9,vars:1,consts:[[1,"main_content"],[1,"box"],[1,"d-flex","justify-content-between"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[1,"form",3,"formGroup"],[1,"form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],[1,"asterisk"],["type","text","formControlName","name"],[1,"text-danger"],["for","type"],["formControlName","type"],["value","CLIENTE"],["value","PROVEEDOR"],["for","mobile"],["type","text","formControlName","mobile"],["for","email"],["type","text","formControlName","email"],["for","identity"],["type","text","formControlName","identity"],["for","identityType"],["formControlName","identityType",1,"w-100"],["value","01"],["value","02"],["value","03"],["value","04"],["for","currency"],["formControlName","currency",1,"w-100"],["value","USD"],["value","CRC"],["for","defaultSeller"],[1,"muted"],["bindLabel","name","bindValue","name","placeholder","--Seleccione--","formControlName","defaultSeller",3,"items","searchable"],[1,"col-12"],["for","notes"],["formControlName","notes","rows","2"],[1,"d-flex","flex-column","justify-content-center","align-items-center","mt-5"],["type","submit",1,"btn","btn-success"]],template:function(n,m){n&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t(4,"Editar contacto"),i(),e(5,"h4",4),S("click",function(){return m.comeBackToList()}),d(6,"i",5),t(7," Regresar "),i()(),s(8,Q,80,7,"form",6),i()()),n&2&&(c(8),u(m.editClientForm()?8:-1))},dependencies:[B,O,k,P,R,M,w,A,L,V,J,z],encapsulation:2,changeDetection:0})};export{h as default};
