import{a as R}from"./chunk-CSQSEWJN.js";import"./chunk-DZLN3OZ3.js";import{a as M}from"./chunk-KGOR65YN.js";import{a as $}from"./chunk-YRVU5RW6.js";import"./chunk-APDWSLEU.js";import"./chunk-QULINWIQ.js";import{b as k,d as O,e as I,h as N,k as V,n as D,t as j,u as G}from"./chunk-3MY7L4GX.js";import{w as T}from"./chunk-7DHE3FAM.js";import{Ib as c,Jb as _,Kb as g,La as s,Va as L,_a as A,ba as d,eb as C,ec as w,ia as v,ja as b,jb as f,mb as y,na as F,nb as E,ob as e,pb as i,qb as p,ub as h,wa as r,yb as m,zb as u}from"./chunk-QAVPLLNK.js";var U=(n,o)=>o.id;function z(n,o){n&1&&p(0,"i",5)}function P(n,o){n&1&&p(0,"i",6)}function q(n,o){n&1&&(e(0,"div",17)(1,"div",20)(2,"div",21)(3,"h4",22),c(4,"Loading"),i(),p(5,"i",23),e(6,"p",24),c(7,"Cargando..."),i()()()())}function B(n,o){if(n&1){let t=h();e(0,"tr",32),m("click",function(){let l=v(t).$implicit,x=u(2);return b(x.listAccountsService.displayModalCreateOrUpdateAccount(l))}),e(1,"td"),c(2),i(),e(3,"td",33)(4,"div",34)(5,"span",35),c(6),i(),e(7,"small"),c(8),i()()(),e(9,"td"),c(10),i()()}if(n&2){let t=o.$implicit;s(2),_(t.code),s(4),_(t.name),s(2),_(t.description),s(2),_(t.accountType.name)}}function H(n,o){if(n&1&&(e(0,"tr")(1,"div",36)(2,"div",37),c(3),i()()()),n&2){let t=u(2);s(3),g(" ",t.isActiveFilters()?"Sin resultados para esa b\xFAsqueda":"No existen cuentas por el momento en el sistema"," ")}}function J(n,o){if(n&1){let t=h();e(0,"div",18)(1,"div",2)(2,"div",10)(3,"div",25)(4,"h3"),c(5),i(),e(6,"div",26)(7,"button",27),m("click",function(){v(t);let l=u();return b(l.listAccountsService.displayModalCreateOrUpdateAccount())}),c(8," + Agregar cuenta "),i()()(),e(9,"div",28)(10,"table",29)(11,"thead")(12,"tr")(13,"th"),c(14,"C\xF3digo"),i(),e(15,"th"),c(16,"Nombre"),i(),e(17,"th"),c(18,"Tipo cuenta"),i()()(),e(19,"tbody",30),y(20,B,11,4,"tr",31,U,!1,H,4,1,"tr"),i()()()()()()}if(n&2){let t=u();s(5),g("Listado cuentas (",t.total(),")"),s(15),E(t.accounts())}}function K(n,o){if(n&1){let t=h();e(0,"div",19)(1,"app-pagination",38),m("offsetEmitter",function(l){v(t);let x=u();return b(x.detectChangeOffset(l))}),i()()}if(n&2){let t=u();s(),C("total",t.total())("factor",t.limit)("initialOffset",t.offset())}}var S=class n{fb=d(j);destroyRef=d(F);accountService=d(T);listAccountsService=d(R);accounts=r([]);limit=5;offset=w(()=>this.listAccountsService.lastOffsetListAccounts());total=r(0);isLoading=r(!0);filtersOpen=r(!1);filters=r({});isActiveFilters=r(!1);searchForm=r(this.fb.group({name:["",[]]}));ngOnInit(){this.fetchAllAccounts(),this.listAccountsService.newAccount$.pipe(M(this.destroyRef)).subscribe(o=>this.fetchAllAccounts())}fetchAllAccounts(){this.accountService.fetchAll(this.limit,this.offset(),this.filters()).subscribe(o=>{o&&o.count>=0&&(this.total.set(o.count),this.accounts.set(o.accounts)),this.isLoading.set(!1)})}openCloseFilters(){this.filtersOpen.set(!this.filtersOpen())}searchFormSubmit(){this.filters.set(this.searchForm().value),this.listAccountsService.lastOffsetListAccounts.set(0),this.isActiveFilters.set(!0),this.fetchAllAccounts()}restartFilters(){this.listAccountsService.lastOffsetListAccounts.set(0),this.isActiveFilters.set(!1),this.filters.set({}),this.searchForm().reset(),this.fetchAllAccounts()}detectChangeOffset(o){this.isLoading.set(!0),this.listAccountsService.lastOffsetListAccounts.set(o),this.fetchAllAccounts()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=L({type:n,selectors:[["list-accounts"]],decls:24,vars:5,consts:[[1,"main_content"],[1,"filters","mb-4"],[1,"box"],["data-bs-toggle","collapse","data-bs-target","#collapseFilters","aria-expanded","false","aria-controls","collapseFilters",1,"d-flex","justify-content-between","align-items-center","cp","mb-2",3,"click"],[1,"mb-0"],[1,"fa-solid","fa-window-minimize"],[1,"fa-solid","fa-window-maximize"],["id","collapseFilters",1,"collapse"],[1,"card","card-body"],["autocomplete","off",1,"search_form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],["type","text","formControlName","name"],[1,"d-flex","justify-content-start","mt-4"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-light","ms-2",3,"click"],[1,"row","animate__animated","animate__fadeIn"],[1,"table_clients"],[1,"d-flex","justify-content-center","w_100","mt-4"],[1,"col-12"],["role","alert",1,"alert","alert-info","text-center"],[1,"alert-heading"],[1,"fa","fa-spin","fa-refresh","fa-2x"],[1,"mb-o"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"hstack","gap-3"],[1,"btn","btn-primary","mb-2",3,"click"],[1,"table-responsive"],[1,"table"],[1,"animate__animated","animate__fadeIn"],[1,"admin_tr"],[1,"admin_tr",3,"click"],[1,"fs-5"],[1,"d-flex","flex-column"],[1,"text","text-primary"],[1,"w-100","d-flex","justify-content-start"],[1,"alert","alert-warning"],[3,"offsetEmitter","total","factor","initialOffset"]],template:function(t,a){t&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),m("click",function(){return a.openCloseFilters()}),e(4,"h3",4),c(5,"Filtrar cuentas"),i(),A(6,z,1,0,"i",5)(7,P,1,0,"i",6),i(),e(8,"div",7)(9,"div",8)(10,"form",9),m("ngSubmit",function(){return a.searchFormSubmit()}),e(11,"div",10)(12,"div",11)(13,"label",12),c(14,"Nombre"),i(),p(15,"input",13),i()(),e(16,"div",14)(17,"button",15),c(18,"Filtrar"),i(),e(19,"button",16),m("click",function(){return a.restartFilters()}),c(20," Restablecer filtros "),i()()()()()()(),A(21,q,8,0,"div",17)(22,J,23,2,"div",18)(23,K,2,3,"div",19),i()),t&2&&(s(6),f(a.filtersOpen()?6:7),s(4),C("formGroup",a.searchForm()),s(11),f(a.isLoading()?21:-1),s(),f(a.isLoading()?-1:22),s(),f(a.total()?23:-1))},dependencies:[G,N,k,O,I,V,D,$],encapsulation:2,changeDetection:0})};export{S as default};
