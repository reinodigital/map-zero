import{a as Z}from"./chunk-B5KQJGYI.js";import{a as g}from"./chunk-KGOR65YN.js";import"./chunk-YRVU5RW6.js";import{a as Y}from"./chunk-H3WDBP26.js";import{a as X}from"./chunk-EO4DNGQO.js";import{a as W}from"./chunk-QULINWIQ.js";import{b as B,c as C,d as O,e as G,h as M,i as L,k as j,n as U,o as q,p as z,q as H,r as J,t as K,u as Q}from"./chunk-7DSSDOH7.js";import{A as k,C as $,I as P,k as D,p as N,r as w,w as V}from"./chunk-GCLW45SM.js";import{Ba as A,Ib as n,Kb as f,La as r,Va as R,_a as x,ba as l,eb as m,ia as _,ja as y,jb as h,kb as E,mb as d,na as F,nb as p,ob as e,pb as i,qb as c,ub as I,wa as v,yb as S,zb as u}from"./chunk-QAVPLLNK.js";var ee=(a,o)=>o.id;function ie(a,o){a&1&&(e(0,"small",22),n(1," nombre debe tener m\xE1s de 2 caracteres "),i())}function ne(a,o){if(a&1&&(e(0,"option",30),n(1),i()),a&2){let t=o.$implicit;m("value",t.id),r(),f(" ",`${t.code} - ${t.name}`," ")}}function oe(a,o){if(a&1&&(e(0,"option",30),n(1),i()),a&2){let t=o.$implicit;m("value",t.code),r(),f(" ",`${t.code} - ${t.label}`," ")}}function ae(a,o){if(a&1&&(e(0,"option",30),n(1),i()),a&2){let t=o.$implicit;m("value",t.id),r(),f(" ",`${t.code} - ${t.name}`," ")}}function re(a,o){if(a&1&&(e(0,"option",30),n(1),i()),a&2){let t=o.$implicit;m("value",t.code),r(),f(" ",`${t.code} - ${t.label}`," ")}}function le(a,o){if(a&1){let t=I();e(0,"form",16),S("ngSubmit",function(){_(t);let b=u();return y(b.onSubmit())}),e(1,"div",17)(2,"div",18)(3,"label",19),n(4,"Nombre "),e(5,"span",20),n(6,"*"),i()(),c(7,"input",21),x(8,ie,2,0,"small",22),i()(),e(9,"h2",23),n(10,"Compra"),i(),e(11,"div",17)(12,"div",18)(13,"label",24),n(14," Coste "),e(15,"span",25),n(16,"opcional"),i()(),c(17,"input",26),i(),e(18,"div",18)(19,"label",27),n(20," Cuenta de compra "),e(21,"span",25),n(22,"opcional"),i()(),e(23,"select",28)(24,"option",29),n(25,"--Seleccione--"),i(),d(26,ne,2,2,"option",30,ee),i()(),e(28,"div",18)(29,"label",31),n(30," Impuesto "),e(31,"span",25),n(32,"opcional"),i()(),e(33,"select",32)(34,"option",29),n(35,"--Seleccione--"),i(),d(36,oe,2,2,"option",30,E),i()()(),e(38,"div",17)(39,"div",33)(40,"label",34),n(41," Descripci\xF3n compra "),e(42,"span",25),n(43,"opcional"),i()(),c(44,"textarea",35),i()(),e(45,"h2",23),n(46,"Venta"),i(),e(47,"div",17)(48,"div",18)(49,"label",36),n(50," Precio venta "),e(51,"span",25),n(52,"opcional"),i()(),c(53,"input",37),i(),e(54,"div",18)(55,"label",38),n(56," Cuenta de venta "),e(57,"span",25),n(58,"opcional"),i()(),e(59,"select",39)(60,"option",29),n(61,"--Seleccione--"),i(),d(62,ae,2,2,"option",30,ee),i()(),e(64,"div",18)(65,"label",40),n(66," Impuesto "),e(67,"span",25),n(68,"opcional"),i()(),e(69,"select",41)(70,"option",29),n(71,"--Seleccione--"),i(),d(72,re,2,2,"option",30,E),i()()(),e(74,"div",17)(75,"div",33)(76,"label",42),n(77," Descripci\xF3n venta "),e(78,"span",25),n(79,"opcional"),i()(),c(80,"textarea",43),i()(),e(81,"div",44)(82,"button",45),n(83,"Editar"),i()()()}if(a&2){let t=u();m("formGroup",t.editItemForm()),r(8),h(t.validField("name")?8:-1),r(18),p(t.accounts()),r(10),p(t.taxesArray),r(26),p(t.accounts()),r(10),p(t.taxesArray)}}function me(a,o){if(a&1){let t=I();e(0,"cabys-select",46),S("cabysChange",function(b){_(t);let te=u();return y(te.onCabysChange(b))}),i()}if(a&2){let t=u();m("cabysInput",t.item().cabys.code)}}var T=class a{platformId=l(A);fb=l(K);commonAdminService=l(Y);destroyRef=l(F);activatedRoute=l(N);router=l(w);itemService=l(P);accountService=l(V);formErrorService=l(X);customToastService=l(W);itemId;item=v(null);accounts=v([]);taxesArray=$;editItemForm=v(null);get isBrowser(){return D(this.platformId)}constructor(){this.itemId=this.activatedRoute.snapshot.params.id}ngOnInit(){this.fetchItem(),this.fetchAccounts()}fetchAccounts(){this.accountService.fetchAll(999,0,{}).pipe(g(this.destroyRef)).subscribe(o=>{o&&o.accounts&&this.accounts.set(o.accounts)})}fetchItem(){this.itemService.fetchOne(this.itemId).pipe(g(this.destroyRef)).subscribe(o=>{o&&o.id&&(this.item.set(o),this.fillOutForm())})}fillOutForm(){this.editItemForm.set(this.fb.group({name:[this.item()?.name??"",[C.required,C.minLength(2)]],cabys:[this.item()?.cabys?.code??null,[C.required]],costPrice:[this.item()?.costPrice??null,[]],purchaseAccountId:[this.item()?.purchaseAccount?.id??"",[]],purchaseTaxRate:[this.item()?.purchaseTaxRate??"",[]],purchaseDescription:[this.item()?.purchaseDescription??"",[]],salePrice:[this.item()?.salePrice??null,[]],saleAccountId:[this.item()?.saleAccount?.id??"",[]],saleTaxRate:[this.item()?.saleTaxRate??"",[]],saleDescription:[this.item()?.saleDescription??"",[]]}))}validField(o){return this.editItemForm().controls[o].touched&&this.editItemForm().controls[o].invalid}onCabysChange(o){this.editItemForm()?.controls.cabys.patchValue(o)}onSubmit(){if(this.editItemForm()?.value.cabys||this.customToastService.add({message:"Cabys es necesario para editar Item y est\xE1 faltando.",type:"error",duration:5e3}),this.editItemForm()?.invalid){this.formErrorService.throwFormErrors(this.editItemForm());return}let o=this.editItemForm()?.value;o.updatedAt=k(new Date),this.itemService.update(this.itemId,o).subscribe(t=>{t&&t.msg?(this.customToastService.add({message:t.msg,type:"success",duration:5e3}),this.router.navigateByUrl("/list-items")):this.customToastService.add({message:t.message,type:"error",duration:5e3})})}comeBackToList(){this.commonAdminService.comeBackToList("/list-items")}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=R({type:a,selectors:[["edit-item"]],decls:20,vars:2,consts:[[1,"main_content"],[1,"box"],[1,"d-flex","justify-content-between","mb-4"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[1,"d-flex","justify-content-between","align-items-center"],["id","pills-tab","role","tablist",1,"nav","nav-pills","mb-4","div_pills"],["role","presentation",1,"nav-item"],["id","pills-fields-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-fields","role","tab","aria-controls","pills-fields","aria-selected","true",1,"nav-link","active"],["id","pills-cabys-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-cabys","role","tab","aria-controls","pills-cabys","aria-selected","false",1,"nav-link"],["id","pills-tabContent",1,"tab-content"],["id","pills-fields","role","tabpanel","aria-labelledby","pills-fields-tab","tabindex","0",1,"tab-pane","fade","active","show"],[1,"form",3,"formGroup"],["id","pills-cabys","role","tabpanel","aria-labelledby","pills-cabys-tab","tabindex","0",1,"tab-pane","fade"],[3,"cabysInput"],[1,"form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],[1,"asterisk"],["type","text","formControlName","name"],[1,"text-danger"],[1,"mt-5"],["for","costPrice"],[1,"muted"],["type","number","min","0","formControlName","costPrice"],["for","purchaseAccountId"],["formControlName","purchaseAccountId"],["value",""],[3,"value"],["for","purchaseTaxRate"],["formControlName","purchaseTaxRate"],[1,"col-12"],["for","purchaseDescription"],["formControlName","purchaseDescription","rows","1"],["for","salePrice"],["type","number","min","0","formControlName","salePrice"],["for","saleAccountId"],["formControlName","saleAccountId"],["for","saleTaxRate"],["formControlName","saleTaxRate"],["for","saleDescription"],["formControlName","saleDescription","rows","1"],[1,"d-flex","flex-column","justify-content-center","align-items-center","mt-5"],["type","submit",1,"btn","btn-success"],[3,"cabysChange","cabysInput"]],template:function(t,s){t&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),n(4,"Editar item"),i(),e(5,"h4",4),S("click",function(){return s.comeBackToList()}),c(6,"i",5),n(7," Regresar "),i()(),e(8,"div",6)(9,"ul",7)(10,"li",8)(11,"button",9),n(12," Formulario "),i(),e(13,"button",10),n(14," C\xF3digo cabys "),i()()()(),e(15,"div",11)(16,"div",12),x(17,le,84,2,"form",13),i(),e(18,"div",14),x(19,me,1,1,"cabys-select",15),i()()()()),t&2&&(r(17),h(s.editItemForm()?17:-1),r(2),h(s.item()?19:-1))},dependencies:[Q,M,z,H,B,L,q,O,G,J,j,U,Z],encapsulation:2,changeDetection:0})};export{T as default};
