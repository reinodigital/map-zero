import{u as R,w as U}from"./chunk-G7SYGITX.js";import{b as P,c as D,d as N,e as w,g as A,h as I,j as O,u as F}from"./chunk-XXXEA7T5.js";import{m as S,z as T}from"./chunk-RV3QXS3Q.js";import{g as x}from"./chunk-SF27WFEL.js";import{Jb as o,Kb as p,Ma as l,Tb as h,Ub as M,Wa as g,Za as v,ba as m,fb as b,ic as E,lb as C,nb as k,ob as y,pb as n,qb as t,rb as d,ta as _,zb as s}from"./chunk-BXSYLYWC.js";var u=class a{transform(i,e="d MMMM y h:mm a",r="en-US"){return i?x(i,e,r,"UTC"):null}static \u0275fac=function(e){return new(e||a)};static \u0275pipe=v({name:"readableDateTime",type:a,pure:!0})};var f=class a{dialogRef=m(R);note=new A("",[D.required]);closePopUp(i){i==="continue"&&!this.note.value||this.dialogRef.close(i==="continue"?this.note.value:null)}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=g({type:a,selectors:[["modal-add-note"]],decls:13,vars:1,consts:[[1,"square"],[1,"d-flex","justify-content-between","align-items-start"],[1,"fa-solid","fa-circle-xmark","btn_close",3,"click"],[1,"note"],[1,"note_form"],["rows","3","placeholder","escriba la nota",1,"w-100",3,"formControl"],[1,"hstack","gap-3","buttons"],[1,"btn","btn-light",3,"click"],[1,"btn","btn-success","ms-2",3,"click"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"h3"),o(3,"Agregar nota"),t(),n(4,"i",2),s("click",function(){return r.closePopUp("cancel")}),t()(),n(5,"div",3)(6,"form",4),d(7,"textarea",5),t(),n(8,"div",6)(9,"button",7),s("click",function(){return r.closePopUp("cancel")}),o(10," Cancelar "),t(),n(11,"button",8),s("click",function(){return r.closePopUp("continue")}),o(12," Agregar "),t()()()()),e&2&&(l(7),b("formControl",r.note))},dependencies:[F,I,P,N,w,O],styles:[".square[_ngcontent-%COMP%]{border-radius:.5rem;padding:2rem;position:relative;height:100%;width:100%}.btn_close[_ngcontent-%COMP%]{cursor:pointer;color:var(--primary);font-size:2.2rem}.note[_ngcontent-%COMP%]   .note_form[_ngcontent-%COMP%]{margin-top:2rem}.note[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{position:absolute;right:2rem;bottom:1rem}"],changeDetection:0})};function B(a,i){if(a&1&&(n(0,"div",14)(1,"div",10)(2,"span",15),o(3),h(4,"readableDateTime"),t()(),n(5,"div",11)(6,"span",15),o(7),t()(),n(8,"div",10)(9,"span",15),o(10),t()(),n(11,"div",12)(12,"span",15),o(13),t()()(),d(14,"div",13)),a&2){let e=i.$implicit;l(3),p(M(4,4,e.executedAt)),l(4),p(e.executedBy),l(3),p(e.action.toLocaleUpperCase()),l(3),p(e.detail)}}var L=class a{dialogRef=m(U);sharedService=m(T);tracking=_.required();entity=_.required();trackingList=E(()=>this.tracking());addNote(){let i=this.dialogRef.open(f,{width:"35rem",height:"24rem",autoFocus:!1,data:null});i.updatePosition({top:"100px"}),i.afterClosed().subscribe(e=>{if(e){let r={createdAt:S(new Date),note:e,refEntity:this.entity().refEntity,refEntityId:this.entity().refEntityId};this.sharedService.addTrackingNote(r).subscribe(c=>{c&&c.id&&this.trackingList.set([c,...this.trackingList()])})}})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=g({type:a,selectors:[["tracking-entity"]],inputs:{tracking:[1,"tracking"],entity:[1,"entity"]},decls:23,vars:0,consts:[[1,"list-group","cp","mt-5"],[1,"list-group-item","list-group-item-secondary"],[1,"div_collapse_btn"],["data-bs-toggle","collapse","data-bs-target","#collapseExample","aria-expanded","false","aria-controls","collapseExample",1,"div_collapse"],[1,"fw-bold"],[1,"fa-regular","fa-square-caret-down","fs-4","ms-3"],[1,"btn","btn-outline-secondary","div_btn",3,"click"],["id","collapseExample",1,"collapse"],[1,"card","card-body"],[1,"row","mb-2"],[1,"col-12","col-md-6","col-lg-2"],[1,"col-12","col-md-6","col-lg-3"],[1,"col-12","col-md-6","col-lg-5"],[1,"line_row_tracking"],[1,"row","row_tracking"],[1,"tracking_info"]],template:function(e,r){e&1&&(n(0,"ul",0)(1,"li",1)(2,"div",2)(3,"div",3)(4,"span",4),d(5,"i",5),o(6," Historial de cambios "),t()(),n(7,"button",6),s("click",function(){return r.addNote()}),o(8," + Agregar nota "),t()()()(),n(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10),o(13,"Fecha"),t(),n(14,"div",11),o(15,"Usuario"),t(),n(16,"div",10),o(17,"Acci\xF3n"),t(),n(18,"div",12),o(19,"Detalle"),t()(),d(20,"div",13),k(21,B,15,6,null,null,C),t()()),e&2&&(l(21),y(r.trackingList()))},dependencies:[u],styles:[".div_collapse_btn[_ngcontent-%COMP%]{position:relative}.div_collapse[_ngcontent-%COMP%]{width:100%}.div_btn[_ngcontent-%COMP%]{position:absolute;top:-.2rem;right:1rem}.tracking_info[_ngcontent-%COMP%]{font-size:1.2rem}.line_row_tracking[_ngcontent-%COMP%]{background-color:var(--light);height:.08rem;width:100%}.row_tracking[_ngcontent-%COMP%]{padding:.6rem 0rem}"],changeDetection:0})};export{L as a};
