import{a as ee,b as te}from"./chunk-6V7YCQEU.js";import{a as T}from"./chunk-QVQJSET7.js";import"./chunk-2JQHP4ZC.js";import{a as Z}from"./chunk-T4UO7T6E.js";import{a as Y}from"./chunk-3L4S2P7E.js";import{a as X}from"./chunk-IETRKHQE.js";import{b as O,c as h,d as B,e as G,h as M,i as j,k as U,n as q,o as z,p as H,q as J,r as K,t as Q,u as W}from"./chunk-XXXEA7T5.js";import{c as V,e as w,i as N,m as P,o as $,v as L}from"./chunk-ZUYKIS5S.js";import{q as k}from"./chunk-SF27WFEL.js";import{$a as _,Ab as p,Ba as A,Jb as i,Lb as v,Ma as l,Wa as D,ba as m,fb as c,ia as x,ja as C,kb as y,lb as I,na as R,nb as u,ob as f,pb as e,qb as t,rb as s,vb as g,wa as S,zb as b}from"./chunk-BXSYLYWC.js";var ie=(a,o)=>o.id;function ne(a,o){a&1&&(e(0,"small",22),i(1," nombre debe tener m\xE1s de 2 caracteres "),t())}function oe(a,o){if(a&1&&(e(0,"option",32),i(1),t()),a&2){let n=o.$implicit;c("value",n.id),l(),v(" ",`${n.code} - ${n.name}`," ")}}function ae(a,o){if(a&1&&(e(0,"option",32),i(1),t()),a&2){let n=o.$implicit;c("value",n.code),l(),v(" ",`${n.code} - ${n.label}`," ")}}function re(a,o){if(a&1&&(e(0,"option",32),i(1),t()),a&2){let n=o.$implicit;c("value",n.id),l(),v(" ",`${n.code} - ${n.name}`," ")}}function le(a,o){if(a&1&&(e(0,"option",32),i(1),t()),a&2){let n=o.$implicit;c("value",n.code),l(),v(" ",`${n.code} - ${n.label}`," ")}}function me(a,o){if(a&1){let n=g();e(0,"form",16),b("ngSubmit",function(){x(n);let d=p();return C(d.onSubmit())}),e(1,"div",17)(2,"div",18)(3,"label",19),i(4,"Nombre "),e(5,"span",20),i(6,"*"),t()(),s(7,"input",21),_(8,ne,2,0,"small",22),t(),e(9,"div",18)(10,"label",23),i(11,"Tipo "),e(12,"span",20),i(13,"*"),t()(),e(14,"custom-checkbox",24),b("checkboxEmitter",function(d){x(n);let E=p();return C(E.onTypeItemChange(d))}),t()()(),e(15,"h2",25),i(16,"Compra"),t(),e(17,"div",17)(18,"div",18)(19,"label",26),i(20," Coste "),e(21,"span",27),i(22,"opcional"),t()(),s(23,"input",28),t(),e(24,"div",18)(25,"label",29),i(26," Cuenta de compra "),e(27,"span",27),i(28,"opcional"),t()(),e(29,"select",30)(30,"option",31),i(31,"--Seleccione--"),t(),u(32,oe,2,2,"option",32,ie),t()(),e(34,"div",18)(35,"label",33),i(36," Impuesto "),e(37,"span",27),i(38,"opcional"),t()(),e(39,"select",34)(40,"option",31),i(41,"--Seleccione--"),t(),u(42,ae,2,2,"option",32,I),t()()(),e(44,"div",17)(45,"div",35)(46,"label",36),i(47," Descripci\xF3n compra "),e(48,"span",27),i(49,"opcional"),t()(),s(50,"textarea",37),t()(),e(51,"h2",25),i(52,"Venta"),t(),e(53,"div",17)(54,"div",18)(55,"label",38),i(56," Precio venta "),e(57,"span",27),i(58,"opcional"),t()(),s(59,"input",39),t(),e(60,"div",18)(61,"label",40),i(62," Cuenta de venta "),e(63,"span",27),i(64,"opcional"),t()(),e(65,"select",41)(66,"option",31),i(67,"--Seleccione--"),t(),u(68,re,2,2,"option",32,ie),t()(),e(70,"div",18)(71,"label",42),i(72," Impuesto "),e(73,"span",27),i(74,"opcional"),t()(),e(75,"select",43)(76,"option",31),i(77,"--Seleccione--"),t(),u(78,le,2,2,"option",32,I),t()()(),e(80,"div",17)(81,"div",35)(82,"label",44),i(83," Descripci\xF3n venta "),e(84,"span",27),i(85,"opcional"),t()(),s(86,"textarea",45),t()(),e(87,"div",46)(88,"button",47),i(89,"Editar"),t()()()}if(a&2){let n,r=p();c("formGroup",r.editItemForm()),l(8),y(r.validField("name")?8:-1),l(6),c("affirmativeLabel","Producto")("negativeLabel","Servicio")("checkboxDefaultValue",((n=r.item())==null?null:n.type)==="Producto")("hostCheckboxDefaultClass","d-flex align-items-end justify-content-start cp w-100"),l(18),f(r.accounts()),l(10),f(r.taxesArray),l(26),f(r.accounts()),l(10),f(r.taxesArray)}}function ce(a,o){if(a&1){let n=g();e(0,"cabys-select",48),b("cabysChange",function(d){x(n);let E=p();return C(E.onCabysChange(d))}),t()}if(a&2){let n=p();c("cabysInput",n.item().cabys.code)}}var F=class a{platformId=m(A);fb=m(Q);commonAdminService=m(Z);destroyRef=m(R);activatedRoute=m(V);router=m(w);itemService=m(L);accountService=m(N);formErrorService=m(Y);customToastService=m(X);itemId;item=S(null);accounts=S([]);taxesArray=$;editItemForm=S(null);get isBrowser(){return k(this.platformId)}constructor(){this.itemId=this.activatedRoute.snapshot.params.id}ngOnInit(){this.fetchItem(),this.fetchAccounts()}fetchAccounts(){this.accountService.fetchAll(999,0,{}).pipe(T(this.destroyRef)).subscribe(o=>{o&&o.accounts&&this.accounts.set(o.accounts)})}fetchItem(){this.itemService.fetchOne(this.itemId).pipe(T(this.destroyRef)).subscribe(o=>{o&&o.id&&(this.item.set(o),this.fillOutForm())})}fillOutForm(){this.editItemForm.set(this.fb.group({name:[this.item()?.name??"",[h.required,h.minLength(2)]],type:[this.item()?.type,[h.required]],cabys:[this.item()?.cabys?.code??null,[h.required]],costPrice:[this.item()?.costPrice??null,[]],purchaseAccountId:[this.item()?.purchaseAccount?.id??"",[]],purchaseTaxRate:[this.item()?.purchaseTaxRate??"",[]],purchaseDescription:[this.item()?.purchaseDescription??"",[]],salePrice:[this.item()?.salePrice??null,[]],saleAccountId:[this.item()?.saleAccount?.id??"",[]],saleTaxRate:[this.item()?.saleTaxRate??"",[]],saleDescription:[this.item()?.saleDescription??"",[]]}))}onTypeItemChange(o){o?this.editItemForm()?.controls.type.patchValue("Producto"):this.editItemForm()?.controls.type.patchValue("Servicio")}validField(o){return this.editItemForm().controls[o].touched&&this.editItemForm().controls[o].invalid}onCabysChange(o){this.editItemForm()?.controls.cabys.patchValue(o)}onSubmit(){if(this.editItemForm()?.value.cabys||this.customToastService.add({message:"Cabys es necesario para editar Item y est\xE1 faltando.",type:"error",duration:5e3}),this.editItemForm()?.invalid){this.formErrorService.throwFormErrors(this.editItemForm());return}let o=this.editItemForm()?.value;o.updatedAt=P(new Date),this.itemService.update(this.itemId,o).subscribe(n=>{n&&n.msg?(this.customToastService.add({message:n.msg,type:"success",duration:5e3}),this.router.navigateByUrl("/list-items")):this.customToastService.add({message:n.message,type:"error",duration:5e3})})}comeBackToList(){this.commonAdminService.comeBackToList("/list-items")}static \u0275fac=function(n){return new(n||a)};static \u0275cmp=D({type:a,selectors:[["edit-item"]],decls:20,vars:2,consts:[[1,"main_content"],[1,"box"],[1,"d-flex","justify-content-between","mb-4"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[1,"d-flex","justify-content-between","align-items-center"],["id","pills-tab","role","tablist",1,"nav","nav-pills","mb-4","div_pills"],["role","presentation",1,"nav-item"],["id","pills-fields-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-fields","role","tab","aria-controls","pills-fields","aria-selected","true",1,"nav-link","active"],["id","pills-cabys-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-cabys","role","tab","aria-controls","pills-cabys","aria-selected","false",1,"nav-link"],["id","pills-tabContent",1,"tab-content"],["id","pills-fields","role","tabpanel","aria-labelledby","pills-fields-tab","tabindex","0",1,"tab-pane","fade","active","show"],[1,"form",3,"formGroup"],["id","pills-cabys","role","tabpanel","aria-labelledby","pills-cabys-tab","tabindex","0",1,"tab-pane","fade"],[3,"cabysInput"],[1,"form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],[1,"asterisk"],["type","text","formControlName","name"],[1,"text-danger"],["for","type"],[3,"checkboxEmitter","affirmativeLabel","negativeLabel","checkboxDefaultValue","hostCheckboxDefaultClass"],[1,"mt-5"],["for","costPrice"],[1,"muted"],["type","number","min","0","formControlName","costPrice"],["for","purchaseAccountId"],["formControlName","purchaseAccountId"],["value",""],[3,"value"],["for","purchaseTaxRate"],["formControlName","purchaseTaxRate"],[1,"col-12"],["for","purchaseDescription"],["formControlName","purchaseDescription","rows","1"],["for","salePrice"],["type","number","min","0","formControlName","salePrice"],["for","saleAccountId"],["formControlName","saleAccountId"],["for","saleTaxRate"],["formControlName","saleTaxRate"],["for","saleDescription"],["formControlName","saleDescription","rows","1"],[1,"d-flex","flex-column","justify-content-center","align-items-center","mt-5"],["type","submit",1,"btn","btn-success"],[3,"cabysChange","cabysInput"]],template:function(n,r){n&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),i(4,"Editar item"),t(),e(5,"h4",4),b("click",function(){return r.comeBackToList()}),s(6,"i",5),i(7," Regresar "),t()(),e(8,"div",6)(9,"ul",7)(10,"li",8)(11,"button",9),i(12," Formulario "),t(),e(13,"button",10),i(14," C\xF3digo cabys "),t()()()(),e(15,"div",11)(16,"div",12),_(17,me,90,6,"form",13),t(),e(18,"div",14),_(19,ce,1,1,"cabys-select",15),t()()()()),n&2&&(l(17),y(r.editItemForm()?17:-1),l(2),y(r.item()?19:-1))},dependencies:[W,M,H,J,O,j,z,B,G,K,U,q,ee,te],encapsulation:2,changeDetection:0})};export{F as default};
