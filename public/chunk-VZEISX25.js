import{a as H,b as J}from"./chunk-A27DZUJB.js";import"./chunk-YAGYQ226.js";import{a as G}from"./chunk-RZZHY2IM.js";import"./chunk-7H4JIEJ2.js";import{a as $}from"./chunk-UV7LDJRE.js";import"./chunk-UYDUL6F7.js";import{a as I}from"./chunk-KGOR65YN.js";import{a as j}from"./chunk-H3WDBP26.js";import"./chunk-QULINWIQ.js";import"./chunk-7DSSDOH7.js";import{J as U,i as L,j as N,k as P,p as z,s as O}from"./chunk-GCLW45SM.js";import{Ba as B,Ib as i,Jb as _,Kb as v,La as a,Rb as T,Sb as Q,Tb as q,Va as M,_a as w,ba as E,eb as k,hb as g,ia as f,ja as S,jb as m,mb as F,na as V,nb as R,ob as t,pb as e,qb as u,ub as C,wa as D,yb as x,zb as s}from"./chunk-QAVPLLNK.js";var K=(n,d)=>d.id;function W(n,d){if(n&1&&(t(0,"button",13),u(1,"i",38),i(2," Editar "),e()),n&2){let l=s(2);k("routerLink","/edit-quote/"+l.quoteId)}}function X(n,d){if(n&1){let l=C();t(0,"button",39),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.markAsAccepted(r.quoteId))}),i(1," Marcar como aceptada "),e()}}function Y(n,d){n&1&&(t(0,"button",15),i(1,"Crear factura"),e())}function Z(n,d){n&1&&u(0,"div",17)}function tt(n,d){n&1&&u(0,"i",18)}function et(n,d){if(n&1){let l=C();t(0,"li")(1,"button",40),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.markAsAccepted(r.quoteId))}),u(2,"i",41),i(3," Marcar como aceptada "),e()()}}function it(n,d){if(n&1){let l=C();t(0,"li")(1,"button",40),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.displayModalQuoteEmail(r.quote()))}),u(2,"i",42),i(3," Enviar "),e()()}}function nt(n,d){if(n&1){let l=C();t(0,"li")(1,"button",40),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.markAsSent(r.quoteId))}),u(2,"i",43),i(3," Marcar como enviada "),e()()}}function ot(n,d){if(n&1){let l=C();t(0,"li")(1,"button",40),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.undoMarkAsAccepted(r.quoteId))}),u(2,"i",44),i(3," Desmarcar como aceptada "),e()()}}function at(n,d){if(n&1){let l=C();t(0,"li")(1,"button",40),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.undoMarkAsDeclined(r.quoteId))}),u(2,"i",44),i(3," Desmarcar como rechazada "),e()()}}function lt(n,d){if(n&1){let l=C();t(0,"li")(1,"button",40),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.undoMarkAsInvoiced(r.quoteId))}),u(2,"i",44),i(3," Desmarcar como facturada "),e()()}}function rt(n,d){if(n&1){let l=C();t(0,"li")(1,"button",40),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.markAsDeclined(r.quoteId))}),u(2,"i",45),i(3," Marcar como rechazada "),e()()}}function dt(n,d){if(n&1){let l=C();t(0,"li")(1,"button",40),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.markAsInvoiced(r.quoteId))}),u(2,"i",46),i(3," Marcar como facturada "),e()()}}function ct(n,d){if(n&1&&(t(0,"li")(1,"button",47),u(2,"i",48),i(3," Editar "),e()()),n&2){let l=s(2);a(),k("routerLink","/edit-quote/"+l.quoteId)}}function ut(n,d){if(n&1){let l=C();t(0,"li")(1,"button",40),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.removeQuote(r.quote()))}),u(2,"i",49),i(3," Remover "),e()()}}function mt(n,d){if(n&1&&(t(0,"tr")(1,"td")(2,"span"),i(3),e()(),t(4,"td")(5,"span"),i(6),e()(),t(7,"td")(8,"span"),i(9),e()(),t(10,"td")(11,"span"),i(12),e()(),t(13,"td")(14,"span"),i(15),e()(),t(16,"td")(17,"span"),i(18),e()(),t(19,"td")(20,"span"),i(21),e()(),t(22,"td")(23,"span"),i(24),e()(),t(25,"td",50)(26,"span"),i(27),e()()()),n&2){let l,c,r,p=d.$implicit,b=s(2);a(3),_(p.item.name),a(3),_(p.description),a(3),_(p.quantity),a(3),_(p.price),a(3),_(p.discount),a(3),_((l=p.account==null?null:p.account.name)!==null&&l!==void 0?l:"_"),a(3),v(" ",b.detailQuoteService.getTaxRateLabel((c=p.taxRate)!==null&&c!==void 0?c:"")," "),a(3),_((r=p.seller==null?null:p.seller.name)!==null&&r!==void 0?r:"_"),a(3),_(p.amount)}}function st(n,d){n&1&&(t(0,"tr",30)(1,"td",51),i(2," No existen Art\xEDculos ni servicios en esta cotizaci\xF3n. "),e()())}function pt(n,d){if(n&1&&(t(0,"div",8)(1,"div",9)(2,"span",10),i(3),e(),t(4,"span"),i(5),e()(),t(6,"div",11)(7,"button",12),i(8,"Imprimir PDF"),e(),w(9,W,3,1,"button",13)(10,X,2,0,"button",14)(11,Y,2,0,"button",15),t(12,"div",16),w(13,Z,1,0,"div",17)(14,tt,1,0,"i",18),t(15,"ul",19),w(16,et,4,0,"li")(17,it,4,0,"li")(18,nt,4,0,"li")(19,ot,4,0,"li")(20,at,4,0,"li")(21,lt,4,0,"li")(22,rt,4,0,"li")(23,dt,4,0,"li")(24,ct,4,1,"li")(25,ut,4,0,"li"),t(26,"li"),u(27,"div",20),t(28,"small",21),i(29,"Acciones"),e()()()()()(),t(30,"div",22)(31,"div",23)(32,"label"),i(33,"Cliente"),e(),t(34,"span"),i(35),e()(),t(36,"div",23)(37,"label"),i(38,"Fecha inicio"),e(),t(39,"span"),i(40),T(41,"readableDate"),e()(),t(42,"div",23)(43,"label"),i(44,"Fecha expira"),e(),t(45,"span"),i(46),T(47,"readableDate"),e()(),t(48,"div",23)(49,"label"),i(50,"N\xFAmero cotizaci\xF3n"),e(),t(51,"span"),i(52),e()(),t(53,"div",23)(54,"label"),i(55,"Moneda"),e(),t(56,"span"),i(57),e()(),t(58,"div",23)(59,"label"),i(60,"Estado"),e(),t(61,"span"),i(62),e()()(),t(63,"div",24)(64,"table",25)(65,"thead")(66,"tr")(67,"th",26)(68,"span"),i(69,"Item"),e()(),t(70,"th",27)(71,"span"),i(72,"Descripci\xF3n"),e()(),t(73,"th",28)(74,"span"),i(75," Cantidad "),e()(),t(76,"th",28)(77,"span"),i(78,"Precio"),e()(),t(79,"th",28)(80,"span"),i(81,"Descuento"),e()(),t(82,"th",28)(83,"span"),i(84,"Cuenta"),e()(),t(85,"th",28)(86,"span"),i(87,"Impuesto"),e()(),t(88,"th",28)(89,"span"),i(90,"Vendedor"),e()(),t(91,"th",29)(92,"span"),i(93,"Monto"),e()()()(),t(94,"tbody"),F(95,mt,28,9,"tr",null,K,!1,st,3,0,"tr",30),e()()(),t(98,"div",31)(99,"div",32)(100,"ul",33)(101,"li",34)(102,"span"),i(103,"Subtotal"),e(),t(104,"span"),i(105),T(106,"number"),e()(),t(107,"li",34)(108,"span"),i(109,"Descuento total"),e(),t(110,"span",35),i(111),T(112,"number"),e()(),t(113,"li",34)(114,"span"),i(115,"Impuesto total"),e(),t(116,"span"),i(117),T(118,"number"),e()(),u(119,"div",36),t(120,"li",37)(121,"span"),i(122,"Total"),e(),t(123,"strong"),i(124),T(125,"number"),e()()()()()),n&2){let l,c,r,p,b,y,A,o=s();a(3),_((l=o.quote())==null?null:l.quoteNumber),a(),g(o.detailQuoteService.getStatusBadgeFromQuote((c=(c=o.quote())==null?null:c.status)!==null&&c!==void 0?c:"")),a(),v(" ",(r=o.quote())==null?null:r.status," "),a(4),m(o.allowedStatusToBeEditedFromDraft.includes(o.quote().status)?9:-1),a(),m(o.allowedStatusToBeAccepted.includes(o.quote().status)?10:-1),a(),m(o.allowedStatusToBeInvoiced.includes(o.quote().status)?11:-1),a(2),m(o.detailQuoteService.isSendEmailFromDetailComponentSubmitting()?13:14),a(3),m(o.allowedStatusToBeAccepted.includes(o.quote().status)?16:-1),a(),m(o.allowedStatusToBeSent.includes(o.quote().status)?17:-1),a(),m(o.allowedStatusToMarkAsSent.includes(o.quote().status)?18:-1),a(),m(o.allowedStatusToUnMarkAsAccepted.includes(o.quote().status)?19:-1),a(),m(o.allowedStatusToUnMarkAsDeclined.includes(o.quote().status)?20:-1),a(),m(o.allowedStatusToUnMarkAsInvoiced.includes(o.quote().status)?21:-1),a(),m(o.allowedStatusToBeDeclined.includes(o.quote().status)?22:-1),a(),m(o.allowedStatusToBeInvoiced.includes(o.quote().status)?23:-1),a(),m(o.allowedStatusToBeEdited.includes(o.quote().status)?24:-1),a(),m(o.quote().status!=="removida"?25:-1),a(10),_((p=o.quote())==null||p.client==null?null:p.client.name),a(5),_(Q(41,31,o.quote().initDate)),a(6),v(" ",o.quote().expireDate?Q(47,33,o.quote().expireDate):"_"," "),a(6),v(" ",o.quote().quoteNumber," "),a(5),v(" ",o.quote().currency," "),a(4),g(o.detailQuoteService.getStatusBadgeFromQuote((b=(b=o.quote())==null?null:b.status)!==null&&b!==void 0?b:"")),a(),v(" ",(y=o.quote())==null?null:y.status," "),a(33),R((A=o.quote())==null?null:A.quoteItems),a(10),_(q(106,35,o.subtotal(),"1.2-2")),a(6),v(" - ",q(112,38,o.totalDiscount(),"1.2-2")," "),a(6),_(q(118,41,o.totalTax(),"1.2-2")),a(7),v(" ",q(125,44,o.totalAmount(),"1.2-2")," ")}}function _t(n,d){if(n&1&&u(0,"tracking-entity",7),n&2){let l=s();k("tracking",l.quote().tracking)}}var h=class n{platformId=E(B);activatedRoute=E(z);commonAdminService=E(j);destroyRef=E(V);quoteService=E(U);detailQuoteService=E(H);allowedStatusToBeEditedFromDraft=["borrador"];allowedStatusToBeSent=["borrador","enviada"];allowedStatusToMarkAsSent=["borrador"];allowedStatusToBeAccepted=["enviada"];allowedStatusToBeInvoiced=["aceptada"];allowedStatusToBeDeclined=["enviada"];allowedStatusToBeEdited=["borrador","enviada"];allowedStatusToUnMarkAsAccepted=["aceptada"];allowedStatusToUnMarkAsDeclined=["rechazada"];allowedStatusToUnMarkAsInvoiced=["facturada"];get isBrowser(){return P(this.platformId)}quoteId;quote=D(null);subtotal=D(0);totalDiscount=D(0);totalTax=D(0);totalAmount=D(0);constructor(){this.quoteId=this.activatedRoute.snapshot.params.id}ngOnInit(){this.fetchQuote(),this.detailQuoteService.statusChange$.pipe(I(this.destroyRef)).subscribe(()=>{this.fetchQuote()})}fetchQuote(){this.quoteService.fetchOne(this.quoteId).pipe(I(this.destroyRef)).subscribe(d=>{d&&d.id&&(this.quote.set(d),this.updateTotals())})}updateTotals(){let d=this.detailQuoteService.calculateTotalsOnDetail(this.quote()?.quoteItems??[]);this.subtotal.set(d.subtotal),this.totalDiscount.set(d.discounts),this.totalTax.set(d.iva),this.totalAmount.set(d.total)}comeBackToList(){this.commonAdminService.comeBackToList("/list-quotes")}static \u0275fac=function(l){return new(l||n)};static \u0275cmp=M({type:n,selectors:[["detail-quote"]],decls:11,vars:6,consts:[[1,"main_content"],[3,"primaryText","primaryLink","secondaryText","secondaryLink"],[1,"box"],[1,"d-flex","justify-content-between","mb-3"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[3,"tracking"],[1,"d-flex","justify-content-between","mb-4"],[1,"d-flex","align-items-center"],[1,"me-3"],[1,"hstack","gap-3"],[1,"btn","btn-outline-secondary"],["type","button",1,"btn","btn-primary",3,"routerLink"],["type","button",1,"btn","btn-primary"],[1,"btn","btn-primary"],[1,"dropdown"],[1,"spinner","ms-1"],["data-bs-toggle","dropdown","aria-expanded","false",1,"fa-solid","fa-ellipsis-vertical","three_points_dropdown"],[1,"dropdown-menu"],[1,"line_divider","mt-3","mb-2"],[1,"ms-3","fs-4"],[1,"row","mb-5"],[1,"col-12","col-md-3","col-lg-2"],[1,"row","table_items"],[1,"table","table-sm","mb-3"],[1,"col-2"],[1,"col-3"],[1,"col-1"],[1,"col-1","text-end"],[1,"no-elements"],[1,"row","mt-4"],[1,"col-md-6","col-lg-4","offset-md-6","offset-lg-8"],[1,"list-group","list-group-flush"],[1,"total_price","d-flex","justify-content-between"],[1,"text-danger"],[1,"line_divider"],[1,"total_price","d-flex","justify-content-between","mt-3"],[1,"fa-solid","fa-pen-to-square","me-2"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"dropdown-item",3,"click"],[1,"fa-solid","fa-check","icon_accepted","me-2"],[1,"fa-solid","fa-paper-plane","icon_sent","me-2"],[1,"fa-solid","fa-marker","icon_mark_as_sent","me-2"],[1,"fa-solid","fa-repeat","icon_trash","me-2"],[1,"fa-solid","fa-xmark","icon_declined","me-2"],[1,"fa-solid","fa-file-invoice-dollar","icon_accepted","me-2"],["type","button",1,"dropdown-item",3,"routerLink"],[1,"fa-solid","fa-pen-to-square","icon_pencil","me-2"],[1,"fa-solid","fa-trash","icon_trash","me-2"],[1,"text-end"],["colspan","12"]],template:function(l,c){l&1&&(t(0,"div",0),u(1,"breadcrumb",1),t(2,"div",2)(3,"div",3)(4,"h3",4),i(5,"Detalle cotizaci\xF3n"),e(),t(6,"h4",5),x("click",function(){return c.comeBackToList()}),u(7,"i",6),i(8," Regresar "),e()(),w(9,pt,126,47),e()(),w(10,_t,1,1,"tracking-entity",7)),l&2&&(a(),k("primaryText","Vista de ventas")("primaryLink","/sales-overview")("secondaryText","Listado cotizaciones")("secondaryLink","/list-quotes"),a(8),m(c.quote()?9:-1),a(),m(c.quote()?10:-1))},dependencies:[N,L,O,J,G,$],styles:[".table_items[_ngcontent-%COMP%]{padding-top:4rem}th[_ngcontent-%COMP%]{color:var(--text);font-size:medium;font-weight:400}.total_price[_ngcontent-%COMP%]{font-size:1.3rem;margin-bottom:.4rem}"],changeDetection:0})};export{h as default};
