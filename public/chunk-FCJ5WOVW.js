import{a as w}from"./chunk-QVQJSET7.js";import{a as A}from"./chunk-2JQHP4ZC.js";import{b as q,d as j,e as R,g as B,h as H,j as $,u as z}from"./chunk-XXXEA7T5.js";import{k as N}from"./chunk-NXK32U4M.js";import{$a as O,Ab as u,G as D,Jb as c,Kb as p,Lb as E,Ma as a,S as I,Wa as g,ba as _,fb as v,hb as b,ia as y,ib as P,ic as F,ja as x,kb as S,na as V,nb as L,ob as T,p as M,pb as i,qb as o,rb as f,sa as h,ta as m,vb as k,wa as l,zb as d}from"./chunk-BXSYLYWC.js";var Q=(n,e)=>e.code;function W(n,e){n&1&&(i(0,"div",5)(1,"div",8)(2,"div",9)(3,"h4",10),c(4,"Loading"),o(),f(5,"i",11),i(6,"p",12),c(7,"Cargando..."),o()()()())}function X(n,e){if(n&1){let t=k();i(0,"tr",15),d("click",function(){let r=y(t).$implicit,C=u(2);return x(C.selectOneCabys(r.code))}),i(1,"td")(2,"span",16),c(3,"_"),o()(),i(4,"td"),c(5),o(),i(6,"td"),c(7),o(),i(8,"td"),c(9),o()()}if(n&2){let t=e.$implicit,s=u(2);a(2),b("cabysSelected",s.selectedCabys()===t.code),a(3),p(t.code),a(2),p(t.description),a(2),p(t.tax)}}function Y(n,e){if(n&1&&(i(0,"tr")(1,"td"),c(2),o()()),n&2){let t=u(2);a(2),p(t.searchMessage())}}function Z(n,e){if(n&1&&(i(0,"div",6)(1,"table",13)(2,"thead"),f(3,"th"),i(4,"th"),c(5,"Cabys"),o(),i(6,"th"),c(7,"Descripci\xF3n"),o(),i(8,"th"),c(9,"Impuesto"),o()(),i(10,"tbody"),L(11,X,10,5,"tr",14,Q,!1,Y,3,1,"tr"),o()()()),n&2){let t=u();a(11),T(t.cabysSuggestions())}}function ee(n,e){if(n&1){let t=k();i(0,"div",7)(1,"app-pagination",17),d("offsetEmitter",function(r){y(t);let C=u();return x(C.detectChangeOffset(r))}),o()()}if(n&2){let t=u();a(),v("total",t.total())("factor",t.limit)}}var G=class n{destroyRef=_(V);cabysService=_(N);cabysInput=m(null);cabysChange=h();cabysSuggestions=l([]);selectedCabys=l(null);limit=12;offset=l(0);total=l(0);isLoading=l(!1);inputSearch=l(new B("",[]));searchMessage=l("");ngOnInit(){this.onInputChange(),this.selectedCabys.set(this.cabysInput())}findCabysSuggestions(e){return this.cabysService.getCabysSuggestions(e,this.limit,this.offset())}selectOneCabys(e){this.selectedCabys()!==e&&(this.selectedCabys.set(e),this.cabysChange.emit(e))}detectChangeOffset(e){this.isLoading.set(!0),this.offset.set(e),this.cabysService.getCabysSuggestions(this.inputSearch().value,this.limit,this.offset()).pipe(w(this.destroyRef)).subscribe(t=>{t&&t.isValid&&(this.cabysSuggestions.set(t.suggestions),this.total.set(t.count)),this.isLoading.set(!1)})}onInputChange(){this.inputSearch().valueChanges.pipe(w(this.destroyRef),D(500),I(e=>!e||e.length<5?(this.cabysSuggestions.set([]),M([])):this.findCabysSuggestions(e))).subscribe(e=>{e?e.isValid?(this.cabysSuggestions.set(e.suggestions),this.total.set(e.count)):(this.cabysSuggestions.set([]),this.displaySearchMessage(Object.keys(e).some(t=>t==="isValid")?"Sin resultados para esa b\xFAsqueda":"Escribe al menos 5 caracteres para la b\xFAsqueda"),this.total.set(0)):(this.cabysSuggestions.set([]),this.total.set(0),this.displaySearchMessage("Error de conexi\xF3n al servidor.")),this.isLoading.set(!1),this.offset.set(0)})}displaySearchMessage(e){this.searchMessage.set(e),setTimeout(()=>{this.searchMessage.set("")},3e3)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=g({type:n,selectors:[["cabys-select"]],inputs:{cabysInput:[1,"cabysInput"]},outputs:{cabysChange:"cabysChange"},decls:13,vars:4,consts:[[1,"row"],[1,"w_100"],["type","text","placeholder","por su c\xF3digo o su descripci\xF3n",1,"w_100","input_search",3,"formControl"],[1,"mt-5"],[1,"badge","bg-success"],[1,"row","animate__animated","animate__fadeIn"],[1,"table-responsive","mt-5"],[1,"d-flex","justify-content-center","w_100","mt-4"],[1,"col-12"],["role","alert",1,"alert","alert-info","text-center"],[1,"alert-heading"],[1,"fa","fa-spin","fa-refresh","fa-2x"],[1,"mb-o"],[1,"table"],[1,"row_cabys"],[1,"row_cabys",3,"click"],[1,"row_cabys_square"],[3,"offsetEmitter","total","factor"]],template:function(t,s){if(t&1&&(i(0,"form")(1,"div",0)(2,"label",1),c(3,"Buscar cabys "),o(),f(4,"input",2),o()(),i(5,"div",3)(6,"h4"),c(7," Cabys seleccionado: "),i(8,"span",4),c(9),o()()(),O(10,W,8,0,"div",5)(11,Z,14,1,"div",6)(12,ee,2,2,"div",7)),t&2){let r;a(4),v("formControl",s.inputSearch()),a(5),p((r=s.selectedCabys())!==null&&r!==void 0?r:"_"),a(),S(s.isLoading()?10:11),a(2),S(s.total()?12:-1)}},dependencies:[z,H,q,j,R,$,A],styles:[".cabysSelected[_ngcontent-%COMP%]{background-color:var(--primary_orange)}.row_cabys[_ngcontent-%COMP%]{cursor:pointer}.row_cabys[_ngcontent-%COMP%]:hover{background-color:var(--light)}.row_cabys_square[_ngcontent-%COMP%]{border:2px solid var(--light);border-radius:.3rem;color:transparent;display:block;height:1.4rem;width:1.4rem}"],changeDetection:0})};var U=class n{negativeLabel=m.required();affirmativeLabel=m.required();checkboxDefaultValue=m(!1);hostCheckboxDefaultClass=m("d-flex align-items-end justify-content-end cp w-100 me-2 mb-1");checkboxEmitter=h();checkboxValue=F(()=>this.checkboxDefaultValue());get getHostClasses(){return this.hostCheckboxDefaultClass()}toggleCheckbox(e){this.checkboxValue.set(e),this.checkboxEmitter.emit(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=g({type:n,selectors:[["custom-checkbox"]],hostVars:2,hostBindings:function(t,s){t&2&&P(s.getHostClasses)},inputs:{negativeLabel:[1,"negativeLabel"],affirmativeLabel:[1,"affirmativeLabel"],checkboxDefaultValue:[1,"checkboxDefaultValue"],hostCheckboxDefaultClass:[1,"hostCheckboxDefaultClass"]},outputs:{checkboxEmitter:"checkboxEmitter"},decls:5,vars:6,consts:[[1,"custom_checkbox"],[1,"custom_checkbox_true",3,"click"],[1,"custom_checkbox_false",3,"click"]],template:function(t,s){t&1&&(i(0,"div",0)(1,"div",1),d("click",function(){return s.toggleCheckbox(!0)}),c(2),o(),i(3,"div",2),d("click",function(){return s.toggleCheckbox(!1)}),c(4),o()()),t&2&&(a(),b("checked",s.checkboxValue()),a(),E(" ",s.affirmativeLabel()," "),a(),b("checked",!s.checkboxValue()),a(),E(" ",s.negativeLabel()," "))},styles:[".custom_checkbox[_ngcontent-%COMP%]{border-radius:.3rem;background-color:var(--light);display:flex;height:2.4rem;position:relative;width:fit-content}.custom_checkbox[_ngcontent-%COMP%]   .custom_checkbox_false[_ngcontent-%COMP%], .custom_checkbox[_ngcontent-%COMP%]   .custom_checkbox_true[_ngcontent-%COMP%]{cursor:pointer;color:var(--black);display:flex;justify-content:center;align-items:center;font-size:1rem;padding:0rem .8rem;width:50%}.checked[_ngcontent-%COMP%]{background-color:var(--primary_blue);color:var(--white)!important}"],changeDetection:0})};export{G as a,U as b};
