import{u as N,v as z}from"./chunk-G7SYGITX.js";import{a as O}from"./chunk-IETRKHQE.js";import{b as R,c as g,d as T,e as k,h as F,k as V,n as j,t as P,u as D}from"./chunk-XXXEA7T5.js";import{m as y}from"./chunk-RV3QXS3Q.js";import{$a as E,Ab as l,Jb as o,Lb as Q,Ma as _,Ra as b,Wa as S,ba as u,fb as h,ia as s,ja as c,kb as x,lb as v,nb as M,ob as w,pb as i,qb as n,rb as f,vb as C,wa as p,zb as d}from"./chunk-BXSYLYWC.js";function A(r,t){if(r&1){let e=C();i(0,"div",8)(1,"span"),o(2),i(3,"i",17),d("click",function(){let a=s(e).$index,$=l(2);return c($.removeEmail(a))}),n()()()}if(r&2){let e=t.$implicit;_(2),Q(" ",e," ")}}function q(r,t){if(r&1){let e=C();i(0,"div",0)(1,"div",1)(2,"h3"),o(3,"Enviar cotizaci\xF3n"),n(),i(4,"i",2),d("click",function(){s(e);let a=l();return c(a.closePopUp("cancel"))}),n()(),i(5,"form",3)(6,"label",4),o(7,"Bandeja "),i(8,"span",5),o(9,"*"),n()(),f(10,"input",6),i(11,"div",7),M(12,A,4,1,"div",8,v),n(),i(14,"button",9),d("click",function(){s(e);let a=l();return c(a.addEmail())}),o(15," + Agregar email "),n(),i(16,"label",10),o(17,"Encabezado"),n(),f(18,"input",11),i(19,"label",12),o(20,"Mensaje"),n(),f(21,"textarea",13),i(22,"div",14)(23,"button",15),d("click",function(){s(e);let a=l();return c(a.closePopUp("cancel"))}),o(24," Cancelar "),n(),i(25,"button",16),d("click",function(){s(e);let a=l();return c(a.closePopUp("send"))}),o(26," Enviar "),n()()()()}if(r&2){let e=l();_(5),h("formGroup",e.newSendQuoteEmailForm()),_(7),w(e.emails())}}var I=class r{constructor(t){this.dataMessage=t;this.data.set(t),this.buildEmail()}fb=u(P);dialogRef=u(N);customToastService=u(O);data=p(null);emailPattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$";emails=p([]);newSendQuoteEmailForm=p(this.fb.group({email:["",[g.required,g.pattern(this.emailPattern)]],subject:["",[]],message:["",[]]}));buildEmail(){let t=`Hola ${this.data()?.clientName},

Esta es la cotizaci\xF3n correspondiente a su pedido por ${this.data()?.currency} ${this.data()?.total.toFixed(2)}

Si\xE9ntese libre de comunicarse con nosotros si existe alguna duda.

Ver pdf de cotizaci\xF3n adjunto a este correo.

T\xE9rminos: ${this.data()?.terms}

Saludos.`,e="Cotizaci\xF3n de parte de Map Soluciones";this.newSendQuoteEmailForm().controls.message.patchValue(t),this.newSendQuoteEmailForm().controls.subject.patchValue(e)}addEmail(){let t=this.newSendQuoteEmailForm().controls.email,e=t.value;if(e&&this.emails().includes(e)){this.newSendQuoteEmailForm().controls.email.patchValue("");return}t.valid&&e?(this.emails().push(e),this.newSendQuoteEmailForm().controls.email.patchValue("")):this.customToastService.add({message:"Formato de correo electr\xF3nico inv\xE1lido.",type:"error",duration:8e3})}removeEmail(t){this.emails().splice(t,1)}closePopUp(t){if(t!=="send"){this.dialogRef.close(null);return}this.onSend()}onSend(){if(!this.emails().length){this.customToastService.add({message:"Se ocupa al menos un correo electr\xF3nico de bandeja.",type:"error",duration:6e3});return}let t={sentAt:y(new Date),emails:this.emails(),message:this.newSendQuoteEmailForm().controls.message.value??"",subject:this.newSendQuoteEmailForm().controls.subject.value??""};this.dialogRef.close(JSON.stringify(t))}static \u0275fac=function(e){return new(e||r)(b(z))};static \u0275cmp=S({type:r,selectors:[["custom-modal-send-quote-email-recipient"]],decls:1,vars:1,consts:[[1,"square"],[1,"d-flex","justify-content-between","align-items-start"],[1,"fa-solid","fa-circle-xmark","btn_close",3,"click"],[1,"form",3,"formGroup"],["for","email"],[1,"asterisk"],["type","email","formControlName","email","placeholder","agregar correo bandeja"],[1,"form_email_list"],[1,"form_email_list_badge"],[1,"btn","btn-outline-primary","mt-2",3,"click"],["for","subject",1,"mt-4"],["type","text","formControlName","subject","placeholder","encabezado"],["for","message",1,"mt-4"],["formControlName","message","rows","12","placeholder","mensaje"],[1,"hstack","gap-3","buttons"],["type","button",1,"btn","btn-light",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[1,"fa-solid","fa-xmark",3,"click"]],template:function(e,m){e&1&&E(0,q,27,1,"div",0),e&2&&x(m.data()?0:-1)},dependencies:[D,F,R,T,k,V,j],styles:[".square[_ngcontent-%COMP%]{border-radius:.5rem;padding:2rem;position:relative;height:100%;width:100%}.btn_close[_ngcontent-%COMP%]{cursor:pointer;color:var(--primary);font-size:2.2rem}.info[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.form[_ngcontent-%COMP%]{margin-bottom:3rem}.form[_ngcontent-%COMP%]   .form_email_list[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.form[_ngcontent-%COMP%]   .form_email_list[_ngcontent-%COMP%]   .form_email_list_badge[_ngcontent-%COMP%]{border-radius:2rem;background-color:var(--primary_orange);color:var(--white);font-size:1rem;padding:.3rem .6rem;margin-top:.2rem;margin-right:.1rem}.form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{position:absolute;right:2rem;bottom:1rem}"],changeDetection:0})};export{I as a};
