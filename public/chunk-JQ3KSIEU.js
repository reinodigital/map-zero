import{a as ie}from"./chunk-B5KQJGYI.js";import{a as k}from"./chunk-KGOR65YN.js";import"./chunk-YRVU5RW6.js";import{a as te}from"./chunk-H3WDBP26.js";import{a as ee}from"./chunk-EO4DNGQO.js";import{a as Z}from"./chunk-QULINWIQ.js";import{b as B,c as g,d as j,e as G,h as q,i as U,k as z,n as H,o as J,p as K,q as Q,r as W,t as X,u as Y}from"./chunk-7DSSDOH7.js";import{A as M,C as O,I as $,k as R,r as V,w as L}from"./chunk-GCLW45SM.js";import{Ba as N,C as I,G as w,Ib as i,Kb as s,La as l,Va as x,_a as F,ba as c,eb as p,gb as _,gc as P,jb as A,kb as y,mb as b,na as D,nb as f,ob as e,pb as t,qb as u,sa as T,ta as v,wa as h,yb as m}from"./chunk-QAVPLLNK.js";var C=class a{negativeLabel=v.required();affirmativeLabel=v.required();checkboxDefaultValue=v(!1);checkboxEmitter=T();checkboxValue=P(()=>this.checkboxDefaultValue());toggleCheckbox(n){this.checkboxValue.set(n),this.checkboxEmitter.emit(n)}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=x({type:a,selectors:[["custom-checkbox"]],hostAttrs:[1,"d-flex","align-items-end","justify-content-end","cp","w-100","me-2","mb-1"],inputs:{negativeLabel:[1,"negativeLabel"],affirmativeLabel:[1,"affirmativeLabel"],checkboxDefaultValue:[1,"checkboxDefaultValue"]},outputs:{checkboxEmitter:"checkboxEmitter"},decls:5,vars:6,consts:[[1,"custom_checkbox"],[1,"custom_checkbox_false",3,"click"],[1,"custom_checkbox_true",3,"click"]],template:function(o,r){o&1&&(e(0,"div",0)(1,"div",1),m("click",function(){return r.toggleCheckbox(!1)}),i(2),t(),e(3,"div",2),m("click",function(){return r.toggleCheckbox(!0)}),i(4),t()()),o&2&&(l(),_("checked",!r.checkboxValue()),l(),s(" ",r.negativeLabel()," "),l(),_("checked",r.checkboxValue()),l(),s(" ",r.affirmativeLabel()," "))},styles:[".custom_checkbox[_ngcontent-%COMP%]{border-radius:.3rem;background-color:var(--light);display:flex;height:2.4rem;position:relative;width:fit-content}.custom_checkbox[_ngcontent-%COMP%]   .custom_checkbox_false[_ngcontent-%COMP%], .custom_checkbox[_ngcontent-%COMP%]   .custom_checkbox_true[_ngcontent-%COMP%]{cursor:pointer;color:var(--black);display:flex;justify-content:center;align-items:center;font-size:1rem;padding:0rem .8rem;width:50%}.checked[_ngcontent-%COMP%]{background-color:var(--primary_blue);color:var(--white)!important}"],changeDetection:0})};var ne=(a,n)=>n.id;function re(a,n){a&1&&(e(0,"small",19),i(1," nombre debe tener m\xE1s de 2 caracteres "),t())}function le(a,n){if(a&1&&(e(0,"option",27),i(1),t()),a&2){let o=n.$implicit;p("value",o.id),l(),s(" ",`${o.code} - ${o.name}`," ")}}function ce(a,n){if(a&1&&(e(0,"option",27),i(1),t()),a&2){let o=n.$implicit;p("value",o.code),l(),s(" ",`${o.code} - ${o.label}`," ")}}function me(a,n){if(a&1&&(e(0,"option",27),i(1),t()),a&2){let o=n.$implicit;p("value",o.id),l(),s(" ",`${o.code} - ${o.name}`," ")}}function se(a,n){if(a&1&&(e(0,"option",27),i(1),t()),a&2){let o=n.$implicit;p("value",o.code),l(),s(" ",`${o.code} - ${o.label}`," ")}}var E=class a{platformId=c(N);destroyRef=c(D);fb=c(X);commonAdminService=c(te);router=c(V);itemService=c($);accountService=c(L);formErrorService=c(ee);customToastService=c(Z);descriptionPropagationIsActive=h(!0);accounts=h([]);taxesArray=O;newItemForm=h(this.fb.group({name:["",[g.required,g.minLength(2)]],cabys:[null,[g.required]],costPrice:[null,[]],purchaseAccountId:["",[]],purchaseTaxRate:["",[]],purchaseDescription:["",[]],salePrice:[null,[]],saleAccountId:["",[]],saleTaxRate:["",[]],saleDescription:["",[]]}));get isBrowser(){return R(this.platformId)}ngOnInit(){this.fetchAccounts(),this.setupDescriptionSync()}fetchAccounts(){this.accountService.fetchAll(999,0,{}).pipe(k(this.destroyRef)).subscribe(n=>{n&&n.accounts&&this.accounts.set(n.accounts)})}validField(n){return this.newItemForm().controls[n].touched&&this.newItemForm().controls[n].invalid}onDescriptionPropagationToggle(n){this.descriptionPropagationIsActive.set(n)}onCabysChange(n){this.newItemForm().controls.cabys.patchValue(n)}onSubmit(){if(this.newItemForm().value.cabys||this.customToastService.add({message:"Cabys es necesario para crear Item y est\xE1 faltando.",type:"error",duration:5e3}),this.newItemForm().invalid){this.formErrorService.throwFormErrors(this.newItemForm());return}let n=this.newItemForm().value;n.createdAt=M(new Date),this.itemService.create(n).subscribe(o=>{o&&o.msg?(this.customToastService.add({message:o.msg,type:"success",duration:5e3}),this.router.navigateByUrl("/list-items")):this.customToastService.add({message:o.message,type:"error",duration:5e3})})}setupDescriptionSync(){let n=this.newItemForm().get("purchaseDescription"),o=this.newItemForm().get("saleDescription");n&&o&&n.valueChanges.pipe(k(this.destroyRef),w(100),I(()=>this.descriptionPropagationIsActive())).subscribe(r=>{o.setValue(r,{emitEvent:!1})})}comeBackToList(){this.commonAdminService.comeBackToList("/list-items")}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=x({type:a,selectors:[["new-item"]],decls:105,vars:5,consts:[[1,"main_content"],[1,"box"],[1,"d-flex","justify-content-between","mb-4"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[1,"d-flex","justify-content-between","align-items-center"],["id","pills-tab","role","tablist",1,"nav","nav-pills","mb-4","div_pills"],["role","presentation",1,"nav-item"],["id","pills-fields-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-fields","role","tab","aria-controls","pills-fields","aria-selected","true",1,"nav-link","active"],["id","pills-cabys-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-cabys","role","tab","aria-controls","pills-cabys","aria-selected","false",1,"nav-link"],["id","pills-tabContent",1,"tab-content"],["id","pills-fields","role","tabpanel","aria-labelledby","pills-fields-tab","tabindex","0",1,"tab-pane","fade","active","show"],[1,"form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],[1,"asterisk"],["type","text","formControlName","name"],[1,"text-danger"],[1,"mt-5"],["for","costPrice"],[1,"muted"],["type","number","min","0","formControlName","costPrice"],["for","purchaseAccountId"],["formControlName","purchaseAccountId"],["value",""],[3,"value"],["for","purchaseTaxRate"],["formControlName","purchaseTaxRate"],[1,"col-12"],[1,"d-flex","justify-content-between"],["for","purchaseDescription"],[3,"checkboxEmitter","affirmativeLabel","negativeLabel","checkboxDefaultValue"],["formControlName","purchaseDescription","rows","1"],["for","salePrice"],["type","number","min","0","formControlName","salePrice"],["for","saleAccountId"],["formControlName","saleAccountId"],["for","saleTaxRate"],["formControlName","saleTaxRate"],["for","saleDescription"],["formControlName","saleDescription","rows","1"],[1,"d-flex","flex-column","justify-content-center","align-items-center","mt-5"],["type","submit",1,"btn","btn-success"],["id","pills-cabys","role","tabpanel","aria-labelledby","pills-cabys-tab","tabindex","0",1,"tab-pane","fade"],[3,"cabysChange"]],template:function(o,r){o&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),i(4,"Nuevo item"),t(),e(5,"h4",4),m("click",function(){return r.comeBackToList()}),u(6,"i",5),i(7," Regresar "),t()(),e(8,"div",6)(9,"ul",7)(10,"li",8)(11,"button",9),i(12," Formulario "),t(),e(13,"button",10),i(14," C\xF3digo cabys "),t()()()(),e(15,"div",11)(16,"div",12)(17,"form",13),m("ngSubmit",function(){return r.onSubmit()}),e(18,"div",14)(19,"div",15)(20,"label",16),i(21,"Nombre "),e(22,"span",17),i(23,"*"),t()(),u(24,"input",18),F(25,re,2,0,"small",19),t()(),e(26,"h2",20),i(27,"Compra"),t(),e(28,"div",14)(29,"div",15)(30,"label",21),i(31," Coste "),e(32,"span",22),i(33,"opcional"),t()(),u(34,"input",23),t(),e(35,"div",15)(36,"label",24),i(37," Cuenta de compra "),e(38,"span",22),i(39,"opcional"),t()(),e(40,"select",25)(41,"option",26),i(42,"--Seleccione--"),t(),b(43,le,2,2,"option",27,ne),t()(),e(45,"div",15)(46,"label",28),i(47," Impuesto "),e(48,"span",22),i(49,"opcional"),t()(),e(50,"select",29)(51,"option",26),i(52,"--Seleccione--"),t(),b(53,ce,2,2,"option",27,y),t()()(),e(55,"div",14)(56,"div",30)(57,"div",31)(58,"label",32),i(59," Descripci\xF3n compra "),e(60,"span",22),i(61,"opcional"),t()(),e(62,"custom-checkbox",33),m("checkboxEmitter",function(S){return r.onDescriptionPropagationToggle(S)}),t()(),u(63,"textarea",34),t()(),e(64,"h2",20),i(65,"Venta"),t(),e(66,"div",14)(67,"div",15)(68,"label",35),i(69," Precio venta "),e(70,"span",22),i(71,"opcional"),t()(),u(72,"input",36),t(),e(73,"div",15)(74,"label",37),i(75," Cuenta de venta "),e(76,"span",22),i(77,"opcional"),t()(),e(78,"select",38)(79,"option",26),i(80,"--Seleccione--"),t(),b(81,me,2,2,"option",27,ne),t()(),e(83,"div",15)(84,"label",39),i(85," Impuesto "),e(86,"span",22),i(87,"opcional"),t()(),e(88,"select",40)(89,"option",26),i(90,"--Seleccione--"),t(),b(91,se,2,2,"option",27,y),t()()(),e(93,"div",14)(94,"div",30)(95,"label",41),i(96," Descripci\xF3n venta "),e(97,"span",22),i(98,"opcional"),t()(),u(99,"textarea",42),t()(),e(100,"div",43)(101,"button",44),i(102,"Guardar"),t()()()(),e(103,"div",45)(104,"cabys-select",46),m("cabysChange",function(S){return r.onCabysChange(S)}),t()()()()()),o&2&&(l(17),p("formGroup",r.newItemForm()),l(8),A(r.validField("name")?25:-1),l(18),f(r.accounts()),l(10),f(r.taxesArray),l(9),p("affirmativeLabel","Propagar")("negativeLabel","Detener")("checkboxDefaultValue",!0),l(19),f(r.accounts()),l(10),f(r.taxesArray))},dependencies:[Y,q,K,Q,B,U,J,j,G,W,z,H,ie,C],encapsulation:2,changeDetection:0})};export{E as default};
