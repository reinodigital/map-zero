import{a as J}from"./chunk-XMUSJKSV.js";import{u as O,w as me}from"./chunk-GFXBF4WM.js";import{a as ce}from"./chunk-ERLWE727.js";import{a as pe}from"./chunk-OHOHCLUG.js";import{a as _}from"./chunk-N2AJ3Z2J.js";import{a as P}from"./chunk-J2Y4HOAS.js";import{b as T,c as S,d as I,e as D,h as N,k as M,n as w,o as ae,p as le,q as re,t as k,u as R}from"./chunk-ALH4IQ5M.js";import{a as de}from"./chunk-4TAYINGZ.js";import{a as se}from"./chunk-XO5AROVW.js";import{A,F as ie,G as ne,H as oe,k as Y,p as Z,s as ee,z as te}from"./chunk-MJVO5DD5.js";import{Ba as X,Ib as i,Jb as c,Kb as y,La as r,Mb as q,Va as E,X as W,_a as v,ba as d,eb as p,ia as j,j as Q,ja as G,jb as f,kb as L,mb as h,na as F,nb as x,ob as t,pb as e,qb as m,ub as U,wa as b,yb as C,zb as g}from"./chunk-54LR7GFL.js";var z=(l,n)=>n.id;function be(l,n){if(l&1&&(t(0,"option",7),i(1),e()),l&2){let o=n.$implicit;p("ngValue",o),r(),y(" ",o.name," ")}}function ge(l,n){l&1&&(t(0,"small",8),i(1," seleccione una provincia por favor "),e())}function Se(l,n){if(l&1&&(t(0,"option",7),i(1),e()),l&2){let o=n.$implicit;p("ngValue",o),r(),y(" ",o.name," ")}}function _e(l,n){l&1&&(t(0,"small",8),i(1," seleccione un cant\xF3n por favor "),e())}function he(l,n){if(l&1&&(t(0,"option",7),i(1),e()),l&2){let o=n.$implicit;p("ngValue",o),r(),y(" ",o.name," ")}}function xe(l,n){l&1&&(t(0,"small",8),i(1," seleccione un distrito por favor "),e())}function Ee(l,n){l&1&&(t(0,"small",8),i(1," Longitud de texto debe ser entre 8 a 120 letras. "),e())}function ye(l,n){if(l&1&&(t(0,"div",14)(1,"div",16),i(2),e()()),l&2){let o=g();r(2),y(" ",o.errMsg()," ")}}var V=class l{fb=d(k);destroyRef=d(F);territoryService=d(oe);formErrorService=d(P);dialogRef=d(O);provinces=b([]);cantons=b([]);districts=b([]);errMsg=b("");addressForm=b(this.fb.group({province:[null,[S.required]],canton:[null,[S.required]],district:[null,[S.required]],exactAddress:[null,[S.minLength(8),S.maxLength(120)]]}));ngOnInit(){this.fetchSevenProvinces(),this.addressForm().controls.province.valueChanges.pipe(_(this.destroyRef)).subscribe(n=>{n&&this.fetchCantonsByProvinceId(n.id),this.addressForm().controls.canton.patchValue(null)}),this.addressForm().controls.canton.valueChanges.pipe(_(this.destroyRef)).subscribe(n=>{n&&this.fetchDistrictsByCantonId(n.id),this.addressForm().controls.district.patchValue(null)})}closePopUp(n=null){this.dialogRef.close(n)}validField(n){return this.addressForm().controls[n].touched&&this.addressForm().controls[n].invalid}fetchSevenProvinces(){this.territoryService.fetchProvinces().pipe(_(this.destroyRef)).subscribe(n=>{n&&n.length&&this.provinces.set(n)})}fetchCantonsByProvinceId(n){this.territoryService.fetchCantonsByProvinceId(n).pipe(_(this.destroyRef)).subscribe(o=>{o&&o.length&&this.cantons.set(o)})}fetchDistrictsByCantonId(n){this.territoryService.fetchDistrictsByCantonId(n).pipe(_(this.destroyRef)).subscribe(o=>{o&&o.length&&this.districts.set(o)})}saveAddress(){if(this.addressForm().invalid){this.formErrorService.throwFormErrors(this.addressForm());return}let{province:n,canton:o,district:a,exactAddress:s}=this.addressForm().value,u={createdAt:A(new Date),provinceName:n.name,provinceCode:n.code.toString(),cantonName:o.name,cantonCode:o.code.toString(),districtName:a.name,districtCode:a.code.toString(),exactAddress:s??null};this.closePopUp(JSON.stringify(u))}static \u0275fac=function(o){return new(o||l)};static \u0275cmp=E({type:l,selectors:[["modal-client-address"]],decls:50,vars:10,consts:[["autocomplete","off",1,"form","container",3,"ngSubmit","formGroup"],[1,"header_form"],[1,"fa-solid","fa-xmark","icon_close",3,"click"],[1,"form_content"],[1,"col-12"],[1,"asterisk"],["formControlName","province",1,"w-100"],[3,"ngValue"],[1,"form-text","text-danger"],["formControlName","canton",1,"w-100"],["formControlName","district",1,"w-100"],[1,"d-flex","flex-column"],[1,"muted"],["formControlName","exactAddress","rows","2"],[1,"d-flex","justify-content-center","mt-3"],["type","submit",1,"btn","btn-success","mt-4","mb-4","w-100",3,"disabled"],[1,"alert","alert-danger"]],template:function(o,a){o&1&&(t(0,"form",0),C("ngSubmit",function(){return a.saveAddress()}),t(1,"div",1)(2,"h3"),i(3,"Agregar direcci\xF3n"),e(),t(4,"i",2),C("click",function(){return a.closePopUp()}),e()(),t(5,"div",3)(6,"div",4)(7,"label"),i(8,"Provincia "),t(9,"span",5),i(10,"*"),e()(),t(11,"select",6)(12,"option",7),i(13,"-- Seleccione --"),e(),h(14,be,2,2,"option",7,z),e(),v(16,ge,2,0,"small",8),e(),t(17,"div",4)(18,"label"),i(19,"Cant\xF3n "),t(20,"span",5),i(21,"*"),e()(),t(22,"select",9)(23,"option",7),i(24,"-- Seleccione --"),e(),h(25,Se,2,2,"option",7,z),e(),v(27,_e,2,0,"small",8),e(),t(28,"div",4)(29,"label"),i(30,"Distrito "),t(31,"span",5),i(32,"*"),e()(),t(33,"select",10)(34,"option",7),i(35,"-- Seleccione --"),e(),h(36,he,2,2,"option",7,z),e(),v(38,xe,2,0,"small",8),e(),t(39,"div",4)(40,"div",11)(41,"label"),i(42,"Direcci\xF3n exacta "),t(43,"span",12),i(44,"opcional"),e()(),m(45,"textarea",13),e(),v(46,Ee,2,0,"small",8),e(),v(47,ye,3,1,"div",14),t(48,"button",15),i(49," Agregar "),e()()()),o&2&&(p("formGroup",a.addressForm()),r(12),p("ngValue",null),r(2),x(a.provinces()),r(2),f(a.validField("province")?16:-1),r(7),p("ngValue",null),r(2),x(a.cantons()),r(2),f(a.validField("canton")?27:-1),r(7),p("ngValue",null),r(2),x(a.districts()),r(2),f(a.validField("district")?38:-1),r(8),f(a.validField("exactAddress")?46:-1),r(),f(a.errMsg()?47:-1),r(),p("disabled",a.addressForm().invalid))},dependencies:[R,N,le,re,T,ae,I,D,M,w],styles:[".form[_ngcontent-%COMP%]{padding:2rem}label[_ngcontent-%COMP%]{color:var(--black)}.header_form[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.header_form[_ngcontent-%COMP%]   .icon_close[_ngcontent-%COMP%]{font-size:2.3rem}"],changeDetection:0})};function Fe(l,n){l&1&&(t(0,"small",7),i(1," nombre debe tener al menos 2 caracteres "),e())}var $=class l{fb=d(k);formErrorService=d(P);dialogRef=d(O);errMsg=b("");contactForm=b(this.fb.group({name:["",[S.required,S.minLength(2)]],lastName:["",[]],email:["",[]],mobile:["",[]]}));closePopUp(n=null){this.dialogRef.close(n)}validField(n){return this.contactForm().controls[n].touched&&this.contactForm().controls[n].invalid}onSubmit(){if(this.contactForm().invalid){this.formErrorService.throwFormErrors(this.contactForm());return}let n={createdAt:A(new Date),name:this.contactForm().controls.name.value,lastName:this.contactForm().controls.lastName.value?this.contactForm().controls.lastName.value:null,email:this.contactForm().controls.email.value?this.contactForm().controls.email.value:null,mobile:this.contactForm().controls.mobile.value?this.contactForm().controls.mobile.value:null};this.closePopUp(JSON.stringify(n))}static \u0275fac=function(o){return new(o||l)};static \u0275cmp=E({type:l,selectors:[["modal-client-contact"]],decls:33,vars:3,consts:[["autocomplete","off",1,"form","container",3,"ngSubmit","formGroup"],[1,"header_form"],[1,"fa-solid","fa-xmark","icon_close",3,"click"],[1,"form_content"],[1,"col-12"],[1,"asterisk"],["formControlName","name"],[1,"form-text","text-danger"],[1,"muted"],["formControlName","lastName"],["formControlName","email"],["formControlName","mobile"],["type","submit",1,"btn","btn-success","mt-4","mb-4","w-100",3,"disabled"]],template:function(o,a){o&1&&(t(0,"form",0),C("ngSubmit",function(){return a.onSubmit()}),t(1,"div",1)(2,"h3"),i(3,"Agregar contacto"),e(),t(4,"i",2),C("click",function(){return a.closePopUp()}),e()(),t(5,"div",3)(6,"div",4)(7,"label"),i(8,"Nombre "),t(9,"span",5),i(10,"*"),e()(),m(11,"input",6),v(12,Fe,2,0,"small",7),e(),t(13,"div",4)(14,"label"),i(15,"Apellidos "),t(16,"span",8),i(17,"opcional"),e()(),m(18,"input",9),e(),t(19,"div",4)(20,"label"),i(21,"Correo "),t(22,"span",8),i(23,"opcional"),e()(),m(24,"input",10),e(),t(25,"div",4)(26,"label"),i(27,"Tel\xE9fono "),t(28,"span",8),i(29,"opcional"),e()(),m(30,"input",11),e()(),t(31,"button",12),i(32," Agregar "),e()()),o&2&&(p("formGroup",a.contactForm()),r(12),f(a.validField("name")?12:-1),r(19),p("disabled",a.contactForm().invalid))},dependencies:[R,N,T,I,D,M,w],styles:[".form[_ngcontent-%COMP%]{padding:2rem}label[_ngcontent-%COMP%]{color:var(--black)}.header_form[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.header_form[_ngcontent-%COMP%]   .icon_close[_ngcontent-%COMP%]{font-size:2.3rem}"],changeDetection:0})};var B=class l{clientAddressService=d(ie);clientContactService=d(ne);customToastService=d(se);dialog=d(me);_newAddress$=new Q;newAddress$=this._newAddress$.asObservable();addNewAddress(n){let o=this.dialog.open(V,{width:"35rem",height:"auto",autoFocus:!1,data:null});o.updatePosition({top:"100px"}),o.afterClosed().subscribe(a=>{a&&this.clientAddressService.create(n,JSON.parse(a)).subscribe(s=>{s&&s.msg?(this.customToastService.add({message:s.msg,type:"success",duration:1e4}),this._newAddress$.next()):this.customToastService.add({message:s.message,type:"error",duration:1e4})})})}removeAddress(n){let o=this.dialog.open(J,{width:"60rem",height:"20rem",autoFocus:!1,data:"Est\xE1s seguro/a de que deseas eliminar esta direcci\xF3n de cliente ?"});o.updatePosition({top:"100px"}),o.afterClosed().subscribe(a=>{a&&this.clientAddressService.removeOne(n).subscribe(s=>{s&&s.msg?(this.customToastService.add({message:s.msg,type:"success",duration:1e4}),this._newAddress$.next()):this.customToastService.add({message:s.message,type:"error",duration:1e4})})})}addNewContact(n){let o=this.dialog.open($,{width:"35rem",height:"auto",autoFocus:!1,data:null});o.updatePosition({top:"100px"}),o.afterClosed().subscribe(a=>{a&&this.clientContactService.create(n,JSON.parse(a)).subscribe(s=>{s&&s.msg?(this.customToastService.add({message:s.msg,type:"success",duration:1e4}),this._newAddress$.next()):this.customToastService.add({message:s.message,type:"error",duration:1e4})})})}removeContact(n){let o=this.dialog.open(J,{width:"60rem",height:"20rem",autoFocus:!1,data:"Est\xE1s seguro/a de que deseas eliminar este contacto de cliente ?"});o.updatePosition({top:"100px"}),o.afterClosed().subscribe(a=>{a&&this.clientContactService.removeOne(n).subscribe(s=>{s&&s.msg?(this.customToastService.add({message:s.msg,type:"success",duration:1e4}),this._newAddress$.next()):this.customToastService.add({message:s.message,type:"error",duration:1e4})})})}static \u0275fac=function(o){return new(o||l)};static \u0275prov=W({token:l,factory:l.\u0275fac,providedIn:"root"})};var fe=()=>[];function Ae(l,n){if(l&1&&(t(0,"li",30)(1,"span",28),i(2,"Notas "),e(),t(3,"span",29),i(4),e()()),l&2){let o=g(2);r(4),c(o.client().notes)}}function Te(l,n){if(l&1&&(t(0,"li",30)(1,"span",28),i(2,"Vendedor/a "),e(),t(3,"span",29),i(4),e()()),l&2){let o=g(2);r(4),c(o.client().defaultSeller)}}function Ie(l,n){if(l&1&&(t(0,"ul",21)(1,"li",27)(2,"span",28),i(3,"Nombre "),e(),t(4,"span",29),i(5),e()(),t(6,"li",30)(7,"span",28),i(8,"C\xE9dula "),e(),t(9,"span",29),i(10),e()(),t(11,"li",30)(12,"span",28),i(13,"Tipo c\xE9dula "),e(),t(14,"span",29),i(15),e()(),t(16,"li",30)(17,"span",28),i(18,"Tel\xE9fono "),e(),t(19,"span",29),i(20),e()(),t(21,"li",30)(22,"span",28),i(23,"Correo electr\xF3nico "),e(),t(24,"span",29),i(25),e()(),t(26,"li",30)(27,"span",28),i(28,"Moneda "),e(),t(29,"span",29),i(30),e()(),v(31,Ae,5,1,"li",30)(32,Te,5,1,"li",30),e()),l&2){let o,a=g();r(5),c(a.client().name),r(5),c(a.client().identity),r(5),c(a.listClientsService.getIdentityType(a.client().identityType)),r(5),c(a.client().mobile),r(5),c(a.client().email),r(5),c(a.client().currency),r(),f(a.client().notes?31:-1),r(),f((o=a.client())!=null&&o.defaultSeller?32:-1)}}function De(l,n){if(l&1){let o=U();t(0,"tr")(1,"td"),i(2),e(),t(3,"td"),i(4),e(),t(5,"td"),i(6),e(),t(7,"td"),i(8),e(),t(9,"td"),i(10),e(),t(11,"td")(12,"div",31),C("click",function(){let s=j(o).$implicit,u=g();return G(u.removeAddress(s.id))}),m(13,"i",32),e()()()}if(l&2){let o=n.$implicit,a=n.$index;r(2),c(a+1),r(2),c(o.provinceName),r(2),c(o.cantonName),r(2),c(o.districtName),r(2),c(o.exactAddress?o.exactAddress:"_")}}function Ne(l,n){l&1&&(t(0,"tr")(1,"div",33)(2,"div",34),i(3," Sin direcciones por el momento. "),e()()())}function Me(l,n){if(l&1){let o=U();t(0,"tr")(1,"td"),i(2),e(),t(3,"td"),i(4),e(),t(5,"td"),i(6),e(),t(7,"td"),i(8),e(),t(9,"td"),i(10),e(),t(11,"td")(12,"div",31),C("click",function(){let s=j(o).$implicit,u=g();return G(u.removeContact(s.id))}),m(13,"i",32),e()()()}if(l&2){let o,a,s,u=n.$implicit,ve=n.$index;r(2),c(ve+1),r(2),c(u.name),r(2),c((o=u.lastName)!==null&&o!==void 0?o:"_"),r(2),c((a=u.email)!==null&&a!==void 0?a:"_"),r(2),c((s=u.mobile)!==null&&s!==void 0?s:"_")}}function we(l,n){l&1&&(t(0,"tr")(1,"div",33)(2,"div",34),i(3," Sin contactos por el momento. "),e()()())}function ke(l,n){if(l&1&&m(0,"tracking-entity",26),l&2){let o=g();p("tracking",o.client().tracking)}}var K=class l{platformId=d(X);activatedRoute=d(Z);commonAdminService=d(de);destroyRef=d(F);clientService=d(te);listClientsService=d(ce);detailClientService=d(B);get isBrowser(){return Y(this.platformId)}clientId;client=b(null);constructor(){this.clientId=this.activatedRoute.snapshot.params.id}ngOnInit(){this.fetchClientById(),this.detailClientService.newAddress$.pipe(_(this.destroyRef)).subscribe(()=>{this.fetchClientById()})}fetchClientById(){this.clientService.fetchOne(this.clientId).pipe(_(this.destroyRef)).subscribe(n=>{n&&n.id&&this.client.set(n)})}addNewAddress(){this.detailClientService.addNewAddress(this.clientId)}removeAddress(n){this.detailClientService.removeAddress(n)}addNewContact(){this.detailClientService.addNewContact(this.clientId)}removeContact(n){this.detailClientService.removeContact(n)}comeBackToList(){this.commonAdminService.comeBackToList("/list-clients")}static \u0275fac=function(o){return new(o||l)};static \u0275cmp=E({type:l,selectors:[["detail-client"]],decls:71,vars:7,consts:[[1,"main_content"],[1,"box"],[1,"d-flex","justify-content-between"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[1,"d-flex","justify-content-between","align-items-center","mt-4","mb-3"],["id","pills-tab","role","tablist",1,"nav","nav-pills","mb-4","div_pills"],["role","presentation",1,"nav-item"],["id","pills-info-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-info","role","tab","aria-controls","pills-info","aria-selected","true",1,"nav-link","active"],["id","pills-address-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-address","role","tab","aria-controls","pills-address","aria-selected","false",1,"nav-link"],["id","pills-contact-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-contact","role","tab","aria-controls","pills-contact","aria-selected","false",1,"nav-link"],[1,"hstack","gap-3"],["role","button","title","Agregar contacto","data-bs-toggle","contactModal","data-bs-target","#contactModal",1,"btn","btn-secondary",3,"click"],[1,"fa-solid","fa-address-book"],["role","button","title","Agregar direcci\xF3n","data-bs-toggle","addressModal","data-bs-target","#addressModal",1,"btn","btn-warning",3,"click"],[1,"fa-solid","fa-location-dot"],["role","button","title","Actualizar",1,"btn","btn-success","btn_detail",3,"routerLink"],[1,"fa-solid","fa-pen-to-square","action_icon_edit"],["id","pills-tabContent",1,"tab-content"],["id","pills-info","role","tabpanel","aria-labelledby","pills-info-tab","tabindex","0",1,"tab-pane","fade","active","show"],[1,"list-group"],["id","pills-address","role","tabpanel","aria-labelledby","pills-address-tab","tabindex","0",1,"tab-pane","fade"],[1,"table","table-bordered"],["scope","col"],["id","pills-contact","role","tabpanel","aria-labelledby","pills-contact-tab","tabindex","0",1,"tab-pane","fade"],[3,"tracking"],[1,"list-group-item","list-group-item-secondary"],[1,"fw-bold"],[1,"ms-4"],[1,"list-group-item","list-group-item-light"],[3,"click"],["title","Eliminar",1,"fa-solid","fa-trash","icon_trash"],[1,"d-flex","justify-content-start"],[1,"alert","alert-warning"]],template:function(o,a){if(o&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),i(4,"Detalle cliente"),e(),t(5,"h4",4),C("click",function(){return a.comeBackToList()}),m(6,"i",5),i(7," Regresar "),e()(),t(8,"div",6)(9,"ul",7)(10,"li",8)(11,"button",9),i(12," Informaci\xF3n "),e(),t(13,"button",10),i(14," Direcciones "),e(),t(15,"button",11),i(16," Contactos "),e()()(),t(17,"div",12)(18,"a",13),C("click",function(){return a.addNewContact()}),m(19,"i",14),i(20," Agregar contacto "),e(),t(21,"a",15),C("click",function(){return a.addNewAddress()}),m(22,"i",16),i(23," Agregar direcci\xF3n "),e(),t(24,"a",17),m(25,"i",18),i(26," Editar "),e()()(),t(27,"div",19)(28,"div",20),v(29,Ie,33,8,"ul",21),e(),t(30,"div",22)(31,"table",23)(32,"thead")(33,"tr")(34,"th",24),m(35,"i",16),e(),t(36,"th",24),i(37,"Provincia"),e(),t(38,"th",24),i(39,"Canton"),e(),t(40,"th",24),i(41,"Distrito"),e(),t(42,"th",24),i(43,"Direcci\xF3n exacta"),e(),t(44,"th",24),i(45,"Acci\xF3n"),e()()(),t(46,"tbody"),h(47,De,14,5,"tr",null,L,!1,Ne,4,0,"tr"),e()()(),t(50,"div",25)(51,"table",23)(52,"thead")(53,"tr")(54,"th",24),m(55,"i",16),e(),t(56,"th",24),i(57,"Nombre"),e(),t(58,"th",24),i(59,"Apellidos"),e(),t(60,"th",24),i(61,"Correo"),e(),t(62,"th",24),i(63,"Tel\xE9fono"),e(),t(64,"th",24),i(65,"Acci\xF3n"),e()()(),t(66,"tbody"),h(67,Me,14,5,"tr",null,L,!1,we,4,0,"tr"),e()()()()()(),v(70,ke,1,1,"tracking-entity",26)),o&2){let s,u;r(24),p("routerLink","/edit-client/"+a.clientId),r(5),f(a.client()?29:-1),r(18),x(((s=a.client())==null?null:s.addresses)||q(5,fe)),r(20),x(((u=a.client())==null?null:u.contacts)||q(6,fe)),r(3),f(a.client()?70:-1)}},dependencies:[ee,pe],encapsulation:2,changeDetection:0})};export{K as default};
