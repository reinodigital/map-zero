import{a as B,b as G}from"./chunk-E6B3SAKU.js";import{a as U}from"./chunk-GRP2BXQC.js";import{b as w,c as r,d as N,e as F,h as T,k as _,n as D,o as I,p as A,q as L,t as R,u as M}from"./chunk-TUWVJ4C7.js";import{a as k}from"./chunk-5KXQMM4B.js";import{a as O}from"./chunk-XO5AROVW.js";import{A as y,k as b,r as E,v as g,z as x}from"./chunk-SQGBK3PG.js";import{Ba as C,Ib as t,La as c,Va as h,_a as d,ba as m,eb as f,jb as u,ob as e,pb as i,qb as s,wa as p,yb as S}from"./chunk-54LR7GFL.js";function P(a,n){a&1&&(e(0,"small",12),t(1," nombre debe tener m\xE1s de 2 caracteres "),i())}function V(a,n){a&1&&(e(0,"small",12),t(1," tel\xE9fono debe ser un n\xFAmero de 8 d\xEDgitos "),i())}function j(a,n){a&1&&(e(0,"small",12),t(1," formato incorrecto de correo "),i())}function z(a,n){a&1&&(e(0,"small",12),t(1," c\xE9dula debe tener enter 9 a 12 caracteres "),i())}var v=class a{platformId=m(C);fb=m(R);commonAdminService=m(k);authService=m(g);clientService=m(x);formErrorService=m(U);customToastService=m(O);router=m(E);sellers=p([]);emailPattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$";newClientForm=p(this.fb.group({name:["",[r.required,r.minLength(2)]],email:["",[r.required,r.pattern(this.emailPattern)]],mobile:["",[r.required,r.minLength(8),r.maxLength(8)]],identity:["",[r.required,r.minLength(8),r.maxLength(12)]],identityType:["02",[r.required]],currency:["USD",[r.required]],notes:["",[]],defaultSeller:[null,[]]}));get isBrowser(){return b(this.platformId)}ngOnInit(){this.fetchSellers()}fetchSellers(){this.authService.fetchAllSellers().subscribe(n=>{n&&n.length&&this.sellers.set(n)})}validField(n){return this.newClientForm().controls[n].touched&&this.newClientForm().controls[n].invalid}onSubmit(){if(this.newClientForm().invalid){this.formErrorService.throwFormErrors(this.newClientForm());return}let n={};n.createdAt=y(new Date);for(let l in this.newClientForm().value)if(this.newClientForm().value.hasOwnProperty(l)){let o=this.newClientForm().controls[l].value;o&&l!=="defaultSeller"&&(n[l]=o),o&&l==="defaultSeller"&&(n[l]=o.name)}this.clientService.create(n).subscribe(l=>{l&&l.msg?(this.customToastService.add({message:l.msg,type:"success",duration:5e3}),this.router.navigateByUrl("/list-clients")):this.customToastService.add({message:l.message,type:"error",duration:5e3})})}comeBackToList(){this.commonAdminService.comeBackToList("/list-clients")}static \u0275fac=function(l){return new(l||a)};static \u0275cmp=h({type:a,selectors:[["new-client"]],decls:78,vars:7,consts:[[1,"main_content"],[1,"box"],[1,"d-flex","justify-content-between"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[1,"form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],[1,"asterisk"],["type","text","formControlName","name"],[1,"text-danger"],["for","mobile"],["type","text","formControlName","mobile"],["for","email"],["type","text","formControlName","email"],["for","identity"],["type","text","formControlName","identity"],["for","identityType"],["formControlName","identityType",1,"w-100"],["value","01"],["value","02"],["value","03"],["value","04"],["for","currency"],["formControlName","currency",1,"w-100"],["value","USD"],["value","CRC"],["for","defaultSeller"],[1,"muted"],["bindLabel","name","placeholder","--Seleccione--","formControlName","defaultSeller",3,"items","searchable"],[1,"col-12"],["for","notes"],["formControlName","notes","rows","2"],[1,"d-flex","flex-column","justify-content-center","align-items-center","mt-5"],["type","submit",1,"btn","btn-success"]],template:function(l,o){l&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t(4,"Nuevo cliente"),i(),e(5,"h4",4),S("click",function(){return o.comeBackToList()}),s(6,"i",5),t(7," Regresar "),i()(),e(8,"form",6),S("ngSubmit",function(){return o.onSubmit()}),e(9,"div",7)(10,"div",8)(11,"label",9),t(12,"Nombre "),e(13,"span",10),t(14,"*"),i()(),s(15,"input",11),d(16,P,2,0,"small",12),i(),e(17,"div",8)(18,"label",13),t(19,"Tel\xE9fono "),e(20,"span",10),t(21,"*"),i()(),s(22,"input",14),d(23,V,2,0,"small",12),i(),e(24,"div",8)(25,"label",15),t(26," Correo electr\xF3nico "),e(27,"span",10),t(28,"*"),i()(),s(29,"input",16),d(30,j,2,0,"small",12),i(),e(31,"div",8)(32,"label",17),t(33," C\xE9dula "),e(34,"span",10),t(35,"*"),i()(),s(36,"input",18),d(37,z,2,0,"small",12),i(),e(38,"div",8)(39,"label",19),t(40," Tipo C\xE9dula "),e(41,"span",10),t(42,"*"),i()(),e(43,"select",20)(44,"option",21),t(45,"F\xEDsica"),i(),e(46,"option",22),t(47,"Jur\xEDdica"),i(),e(48,"option",23),t(49,"DIMEX"),i(),e(50,"option",24),t(51,"NITE"),i()()(),e(52,"div",8)(53,"label",25),t(54," Moneda "),e(55,"span",10),t(56,"*"),i()(),e(57,"select",26)(58,"option",27),t(59,"USD"),i(),e(60,"option",28),t(61,"CRC"),i()()(),e(62,"div",8)(63,"label",29),t(64," Vendedor "),e(65,"span",30),t(66,"opcional"),i()(),s(67,"ng-select",31),i()(),e(68,"div",7)(69,"div",32)(70,"label",33),t(71," Notas "),e(72,"span",30),t(73,"opcional"),i()(),s(74,"textarea",34),i()(),e(75,"div",35)(76,"button",36),t(77,"Guardar"),i()()()()()),l&2&&(c(8),f("formGroup",o.newClientForm()),c(8),u(o.validField("name")?16:-1),c(7),u(o.validField("mobile")?23:-1),c(7),u(o.validField("email")?30:-1),c(7),u(o.validField("identity")?37:-1),c(30),f("items",o.sellers())("searchable",!0))},dependencies:[M,T,A,L,w,I,N,F,_,D,G,B],encapsulation:2,changeDetection:0})};export{v as default};
