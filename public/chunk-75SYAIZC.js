import{a as H}from"./chunk-HT52MB4M.js";import{a as $}from"./chunk-VNY5M2TF.js";import{a as z}from"./chunk-W2PMZUXL.js";import{a as j}from"./chunk-WKFQL3IM.js";import{b as L,c as m,d as k,e as B,h as O,k as D,n as V,o as M,p as G,q as P,t as U,u as q}from"./chunk-5KSV7YSN.js";import{k as A,p as N,r as R,v as w}from"./chunk-G6MTQLVM.js";import{$a as d,Ab as v,Ba as _,Jb as n,Lb as I,Ma as a,Wa as C,ba as l,fb as u,ia as S,ja as b,kb as c,lb as x,nb as g,ob as F,pb as t,qb as o,rb as p,vb as T,wa as f,zb as y}from"./chunk-F6XVVQNR.js";function J(r,i){r&1&&(t(0,"small",14),n(1," nombre debe tener m\xE1s de 2 caracteres "),o())}function K(r,i){r&1&&(t(0,"small",14),n(1," tel\xE9fono debe ser un n\xFAmero de 8 d\xEDgitos "),o())}function Q(r,i){r&1&&(t(0,"small",14),n(1," formato incorrecto de correo "),o())}function W(r,i){if(r&1&&(t(0,"option",21),n(1),o()),r&2){let e=i.$implicit;u("value",e),a(),I(" ",e," ")}}function X(r,i){if(r&1){let e=T();t(0,"form",8),y("ngSubmit",function(){S(e);let h=v();return b(h.onSubmit())}),t(1,"div",9)(2,"div",10)(3,"label",11),n(4,"Nombre "),t(5,"span",12),n(6,"*"),o()(),p(7,"input",13),d(8,J,2,0,"small",14),o(),t(9,"div",10)(10,"label",15),n(11,"Tel\xE9fono "),t(12,"span",12),n(13,"*"),o()(),p(14,"input",16),d(15,K,2,0,"small",14),o(),t(16,"div",10)(17,"label",17),n(18," Correo electr\xF3nico "),t(19,"span",12),n(20,"*"),o()(),p(21,"input",18),d(22,Q,2,0,"small",14),o(),t(23,"div",10)(24,"label",19),n(25,"Rol "),t(26,"span",12),n(27,"*"),o()(),t(28,"select",20),g(29,W,2,2,"option",21,x),o()()(),t(31,"div",22)(32,"button",23),n(33,"Editar"),o()()()}if(r&2){let e=v();u("formGroup",e.editEmployeeForm()),a(8),c(e.validField("name")?8:-1),a(7),c(e.validField("mobile")?15:-1),a(7),c(e.validField("email")?22:-1),a(7),F(e.allowedRoles)}}var E=class r{platformId=l(_);fb=l(U);commonAdminService=l($);activatedRoute=l(N);authService=l(w);formErrorService=l(z);customToastService=l(j);router=l(R);allowedRoles=["ADMIN","ADMINISTRATIVE_ASSISTANT","SELLER","ACCOUNTANT"];employeeId;employee=f(null);emailPattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$";editEmployeeForm=f(null);get isBrowser(){return A(this.platformId)}constructor(){this.employeeId=this.activatedRoute.snapshot.params.id}ngOnInit(){this.fetchEmployeeById()}fetchEmployeeById(){this.authService.fetchOne(this.employeeId).subscribe(i=>{i&&i.uid&&(this.employee.set(i),this.fillOutForm())})}fillOutForm(){this.editEmployeeForm.set(this.fb.group({name:[this.employee()?.name??"",[m.required,m.minLength(2)]],email:[this.employee()?.email??"",[m.required,m.pattern(this.emailPattern)]],mobile:[this.employee()?.mobile??"",[m.required,m.minLength(8),m.maxLength(8)]],rol:[this.employee()?.roles[0],[m.required]]}))}validField(i){return this.editEmployeeForm().controls[i].touched&&this.editEmployeeForm().controls[i].invalid}onSubmit(){if(this.editEmployeeForm()?.invalid){this.formErrorService.throwFormErrors(this.editEmployeeForm());return}let i={};for(let e in this.editEmployeeForm()?.value)if(this.editEmployeeForm()?.value.hasOwnProperty(e)){let s=this.editEmployeeForm()?.controls[e].value;s&&(e==="rol"?i.roles=[s]:i[e]=s)}this.authService.update(this.employeeId,i).subscribe(e=>{e&&e.msg?(this.customToastService.add({message:e.msg,type:"success",duration:1e4}),this.router.navigateByUrl("/list-employees")):this.customToastService.add({message:e.message,type:"error",duration:1e4})})}comeBackToList(){this.commonAdminService.comeBackToList("/list-employees")}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=C({type:r,selectors:[["edit-employee"]],decls:10,vars:3,consts:[[1,"main_content"],[3,"primaryText","primaryLink"],[1,"box"],[1,"d-flex","justify-content-between"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[1,"form",3,"formGroup"],[1,"form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],[1,"asterisk"],["type","text","formControlName","name"],[1,"text-danger"],["for","mobile"],["type","text","formControlName","mobile"],["for","email"],["type","text","formControlName","email"],["for","rol"],["formControlName","rol"],[3,"value"],[1,"d-flex","flex-column","justify-content-center","align-items-center","mt-5"],["type","submit",1,"btn","btn-success"]],template:function(e,s){e&1&&(t(0,"div",0),p(1,"breadcrumb",1),t(2,"div",2)(3,"div",3)(4,"h3",4),n(5,"Editar empleado"),o(),t(6,"h4",5),y("click",function(){return s.comeBackToList()}),p(7,"i",6),n(8," Regresar "),o()(),d(9,X,34,4,"form",7),o()()),e&2&&(a(),u("primaryText","Listado de empleados")("primaryLink","/list-employees"),a(8),c(s.editEmployeeForm()?9:-1))},dependencies:[q,O,G,P,L,M,k,B,D,V,H],encapsulation:2})};export{E as default};
