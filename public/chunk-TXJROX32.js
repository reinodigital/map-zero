import{u as N,v as $}from"./chunk-G7SYGITX.js";import{a as I}from"./chunk-IETRKHQE.js";import{b as y,c as g,d as R,e as k,h as T,k as F,n as V,t as j,u as D}from"./chunk-XXXEA7T5.js";import{m as w}from"./chunk-RV3QXS3Q.js";import{$a as S,Ab as l,Jb as r,Lb as M,Ma as _,Ra as C,Wa as b,ba as u,fb as E,ia as m,ja as c,kb as x,lb as P,nb as O,ob as v,pb as i,qb as n,rb as h,vb as f,wa as p,zb as d}from"./chunk-BXSYLYWC.js";function G(a,t){if(a&1){let e=f();i(0,"div",8)(1,"span"),r(2),i(3,"i",17),d("click",function(){let o=m(e).$index,A=l(2);return c(A.removeEmail(o))}),n()()()}if(a&2){let e=t.$implicit;_(2),M(" ",e," ")}}function U(a,t){if(a&1){let e=f();i(0,"div",0)(1,"div",1)(2,"h3"),r(3,"Enviar orden de compra"),n(),i(4,"i",2),d("click",function(){m(e);let o=l();return c(o.closePopUp("cancel"))}),n()(),i(5,"form",3)(6,"label",4),r(7,"Bandeja "),i(8,"span",5),r(9,"*"),n()(),h(10,"input",6),i(11,"div",7),O(12,G,4,1,"div",8,P),n(),i(14,"button",9),d("click",function(){m(e);let o=l();return c(o.addEmail())}),r(15," + Agregar email "),n(),i(16,"label",10),r(17,"Encabezado"),n(),h(18,"input",11),i(19,"label",12),r(20,"Mensaje"),n(),h(21,"textarea",13),i(22,"div",14)(23,"button",15),d("click",function(){m(e);let o=l();return c(o.closePopUp("cancel"))}),r(24," Cancelar "),n(),i(25,"button",16),d("click",function(){m(e);let o=l();return c(o.closePopUp("send"))}),r(26," Enviar "),n()()()()}if(a&2){let e=l();_(5),E("formGroup",e.newSendPurchaseOrderEmailForm()),_(7),v(e.emails())}}var z=class a{constructor(t){this.dataMessage=t;this.data.set(t),this.buildEmail()}fb=u(j);dialogRef=u(N);customToastService=u(I);data=p(null);emailPattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$";emails=p([]);newSendPurchaseOrderEmailForm=p(this.fb.group({email:["",[g.required,g.pattern(this.emailPattern)]],subject:["",[]],message:["",[]]}));buildEmail(){let t=`Hola ${this.data()?.clientName},

Orden de compra correspondiente por ${this.data()?.currency} ${this.data()?.total.toFixed(2)}

Si\xE9ntese libre de comunicarse con nosotros si existe alguna duda.

Ver pdf de orden de compra adjunto a este correo.

Instrucciones de entrega: ${this.data()?.deliveryInstructions}

Saludos.`,e="Orden de compra de parte de Map Soluciones";this.newSendPurchaseOrderEmailForm().controls.message.patchValue(t),this.newSendPurchaseOrderEmailForm().controls.subject.patchValue(e)}addEmail(){let t=this.newSendPurchaseOrderEmailForm().controls.email,e=t.value;if(e&&this.emails().includes(e)){this.newSendPurchaseOrderEmailForm().controls.email.patchValue("");return}t.valid&&e?(this.emails().push(e),this.newSendPurchaseOrderEmailForm().controls.email.patchValue("")):this.customToastService.add({message:"Formato de correo electr\xF3nico inv\xE1lido.",type:"error",duration:8e3})}removeEmail(t){this.emails().splice(t,1)}closePopUp(t){if(t!=="send"){this.dialogRef.close(null);return}this.onSend()}onSend(){if(!this.emails().length){this.customToastService.add({message:"Se ocupa al menos un correo electr\xF3nico de bandeja.",type:"error",duration:6e3});return}let t={sentAt:w(new Date),emails:this.emails(),message:this.newSendPurchaseOrderEmailForm().controls.message.value??"",subject:this.newSendPurchaseOrderEmailForm().controls.subject.value??""};this.dialogRef.close(JSON.stringify(t))}static \u0275fac=function(e){return new(e||a)(C($))};static \u0275cmp=b({type:a,selectors:[["custom-modal-send-purchase-order-email-recipient"]],decls:1,vars:1,consts:[[1,"square"],[1,"d-flex","justify-content-between","align-items-start"],[1,"fa-solid","fa-circle-xmark","btn_close",3,"click"],[1,"form",3,"formGroup"],["for","email"],[1,"asterisk"],["type","email","formControlName","email","placeholder","agregar correo bandeja"],[1,"form_email_list"],[1,"form_email_list_badge"],[1,"btn","btn-outline-primary","mt-2",3,"click"],["for","subject",1,"mt-4"],["type","text","formControlName","subject","placeholder","encabezado"],["for","message",1,"mt-4"],["formControlName","message","rows","12","placeholder","mensaje"],[1,"hstack","gap-3","buttons"],["type","button",1,"btn","btn-light",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[1,"fa-solid","fa-xmark",3,"click"]],template:function(e,s){e&1&&S(0,U,27,1,"div",0),e&2&&x(s.data()?0:-1)},dependencies:[D,T,y,R,k,F,V],styles:[".square[_ngcontent-%COMP%]{border-radius:.5rem;padding:2rem;position:relative;height:100%;width:100%}.btn_close[_ngcontent-%COMP%]{cursor:pointer;color:var(--primary);font-size:2.2rem}.info[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.form[_ngcontent-%COMP%]{margin-bottom:3rem}.form[_ngcontent-%COMP%]   .form_email_list[_ngcontent-%COMP%]{display:flex;align-items:center;flex-wrap:wrap}.form[_ngcontent-%COMP%]   .form_email_list[_ngcontent-%COMP%]   .form_email_list_badge[_ngcontent-%COMP%]{border-radius:2rem;background-color:var(--primary_orange);color:var(--white);font-size:1rem;padding:.3rem .6rem;margin-top:.2rem;margin-right:.1rem}.form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{position:absolute;right:2rem;bottom:1rem}"],changeDetection:0})};export{z as a};
