import{a as I}from"./chunk-GZHOXXQG.js";import{a as B,b as z,d as W,g as $,j as q,u as U}from"./chunk-UP3F5373.js";import{J as R}from"./chunk-4ZQGKSBB.js";import{$a as h,Ab as m,C as T,G as E,Jb as a,Kb as y,Lb as p,Ma as s,Mb as L,S as k,U as S,W as M,Wa as g,ba as v,eb as P,fb as b,ia as O,ib as F,ja as w,kb as f,na as D,nb as N,ob as V,p as x,pb as o,qb as l,rb as C,sa as d,ta as r,vb as A,wa as u,zb as _}from"./chunk-F6XVVQNR.js";var K=(i,t)=>t.name;function X(i,t){if(i&1){let e=A();o(0,"li",4),_("click",function(){let c=O(e).$implicit,Q=m(2);return w(Q.selectItem(c))}),o(1,"div",5)(2,"span",6),a(3),l(),o(4,"span",7),a(5),l(),o(6,"span",8),a(7),l()()()}if(i&2){let e=t.$implicit;s(3),y(e.cabys),s(2),y(e.shortName),s(2),p(" ",e.shortName," ")}}function Y(i,t){if(i&1&&(o(0,"ul",2),N(1,X,8,3,"li",3,K),l()),i&2){let e=m();s(),V(e.items())}}var j=class i{destroyRef=v(D);itemService=v(R);searchControl=new $("");items=u([]);selectedItem=u("");notResultsString="sin resultados encontrados";_isSelectingItem=u(!1);_isInitialLoad=u(!0);itemSelectedEmitter=d();onChange=()=>{};onTouched=()=>{};isDisabled=!1;ngOnInit(){this.setupSearchControlListener()}writeValue(t){if(t==null){this.searchControl.setValue("",{emitEvent:!1}),this._isInitialLoad.set(!1);return}this._isSelectingItem.set(!0),typeof t=="number"?this.itemService.findOneAsSuggestion(t).pipe(I(this.destroyRef),S(()=>this._isSelectingItem.set(!0))).subscribe({next:e=>{e&&e.id?(this.searchControl.setValue(e.shortName,{emitEvent:!1}),this.selectedItem.set(e.name),this._isInitialLoad()&&(e.isLoadingExistingItem=!0,this.itemSelectedEmitter.emit(e),this.onChange(e.id))):(this.searchControl.setValue("",{emitEvent:!1}),this.selectedItem.set(""),this.onChange(null))},error:e=>{this.searchControl.setValue("",{emitEvent:!1}),this.selectedItem.set(""),this.onChange(null)},complete:()=>{this._isInitialLoad.set(!1),this._isSelectingItem.set(!1)}}):typeof t=="string"?(this.searchControl.setValue(t,{emitEvent:!1}),this.selectedItem.set(t),this._isInitialLoad.set(!1),this._isSelectingItem.set(!1)):(this.searchControl.setValue("",{emitEvent:!1}),this.selectedItem.set(""),this._isInitialLoad.set(!1),this._isSelectingItem.set(!1))}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.isDisabled=t,t?this.searchControl.disable():this.searchControl.enable()}setupSearchControlListener(){this.searchControl.valueChanges.pipe(I(this.destroyRef),T(t=>typeof t=="string"&&!this._isSelectingItem()),E(500),S(t=>this.onTouched()),k(t=>{let e=t?t.trim():"";return!e||e.length<3?(this.items.set([]),this.selectedItem()!==""&&(this.onChange(null),this.itemSelectedEmitter.emit(null)),this.selectedItem.set(""),x([])):this.itemService.getSuggestions(e)})).subscribe(t=>{t.length===1&&t[0].name===this.notResultsString?(this.items.set(t),setTimeout(()=>{this.items.set([])},2e3)):this.items.set(t)})}selectItem(t){t.id&&(this._isSelectingItem.set(!0),this.searchControl.setValue(t.shortName,{emitEvent:!1}),this.selectedItem.set(t.shortName),this.items.set([]),this.onChange(t.id),this.onTouched(),this.itemSelectedEmitter.emit(t),setTimeout(()=>{this._isSelectingItem.set(!1)},50))}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=g({type:i,selectors:[["custom-select"]],outputs:{itemSelectedEmitter:"itemSelectedEmitter"},features:[L([{provide:B,useExisting:M(()=>i),multi:!0}])],decls:3,vars:2,consts:[[1,"custom_select"],["type","text",3,"formControl"],[1,"suggestions"],[1,"suggestion_item"],[1,"suggestion_item",3,"click"],[1,"d-flex","flex-column"],[1,"suggestion_item_cabys"],[1,"suggestion_item_name"],[1,"suggestion_item_name_little"]],template:function(e,n){e&1&&(o(0,"div",0),C(1,"input",1),h(2,Y,3,0,"ul",2),l()),e&2&&(s(),b("formControl",n.searchControl),s(),f(n.items().length?2:-1))},dependencies:[U,z,W,q],styles:[".custom_select[_ngcontent-%COMP%]{position:relative}ul.suggestions[_ngcontent-%COMP%]{list-style-type:none;padding:0;margin:0;position:absolute;top:3.2rem;left:0;width:40rem;box-shadow:0 2px 5px #0000001a;background-color:var(--background);border:2px solid var(--black);z-index:980}li[_ngcontent-%COMP%]{cursor:pointer;color:var(--black);font-size:1.3rem;padding:10px}li[_ngcontent-%COMP%]:hover{background-color:var(--light)}li[_ngcontent-%COMP%]:last-child{border-bottom:none}li[_ngcontent-%COMP%]   .suggestion_item_cabys[_ngcontent-%COMP%]{font-size:1.1rem;color:var(--text);background-color:var(--white);border-radius:.4rem;border:1px solid var(--black);padding:0rem .2rem;width:fit-content}li[_ngcontent-%COMP%]   .suggestion_item_name[_ngcontent-%COMP%]{color:var(--black);font-size:1.6rem;font-weight:500;margin-top:.5rem}li[_ngcontent-%COMP%]   .suggestion_item_name_little[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:400;color:var(--text)}"],changeDetection:0})};function Z(i,t){if(i&1&&(o(0,"div",1),a(1),C(2,"div",2),l()),i&2){let e=m();s(),p(" ",e.secondaryText()," ")}}function tt(i,t){if(i&1&&a(0),i&2){let e=m();p(" ",e.primaryText()," ")}}var G=class i{isFormSubmitting=r.required();primaryText=r.required();secondaryText=r.required();attributeName=r(null);attributeClass=r(null);attributeType=r("button");buttonAction=r(null);actionToApply=r(null);btnWasClicked=d();onClick(){this.attributeType()==="submit"||!this.buttonAction()||this.btnWasClicked.emit(this.buttonAction())}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=g({type:i,selectors:[["submit-button"]],inputs:{isFormSubmitting:[1,"isFormSubmitting"],primaryText:[1,"primaryText"],secondaryText:[1,"secondaryText"],attributeName:[1,"attributeName"],attributeClass:[1,"attributeClass"],attributeType:[1,"attributeType"],buttonAction:[1,"buttonAction"],actionToApply:[1,"actionToApply"]},outputs:{btnWasClicked:"btnWasClicked"},decls:3,vars:6,consts:[[3,"click","disabled"],[1,"d-flex","align-items-center"],[1,"spinner","ms-2"]],template:function(e,n){if(e&1&&(o(0,"button",0),_("click",function(){return n.attributeType()==="button"&&n.onClick()}),h(1,Z,3,1,"div",1)(2,tt,1,1),l()),e&2){let c;F((c=n.attributeClass())!==null&&c!==void 0?c:"btn btn-success"),b("disabled",n.isFormSubmitting()),P("type",n.attributeType())("name",n.attributeName()),s(),f(n.isFormSubmitting()?1:2)}},styles:[".responsive_btn[_ngcontent-%COMP%]{margin-top:.6rem}@media (min-width: 768px){.responsive_btn[_ngcontent-%COMP%]{margin-top:1.2rem}}"],changeDetection:0})};var bt=i=>parseFloat(i.toFixed(2));export{bt as a,j as b,G as c};
