import{a as M}from"./chunk-7TNZFABJ.js";import{a as R}from"./chunk-QVQJSET7.js";import{a as V}from"./chunk-2JQHP4ZC.js";import{b as T,d as k,e as A,h as N,k as D,n as j,t as G,u as P}from"./chunk-XXXEA7T5.js";import{f as w,v as O}from"./chunk-RV3QXS3Q.js";import"./chunk-SF27WFEL.js";import{$a as b,Ab as u,Jb as s,Kb as v,Lb as h,Ma as a,Wa as g,ba as c,fb as _,gc as E,ia as I,ja as C,kb as d,na as S,nb as L,ob as F,pb as i,qb as e,rb as f,vb as y,wa as m,zb as p}from"./chunk-BXSYLYWC.js";var $=(t,o)=>o.id;function q(t,o){t&1&&f(0,"i",5)}function B(t,o){t&1&&f(0,"i",6)}function U(t,o){t&1&&(i(0,"div",17)(1,"div",20)(2,"div",21)(3,"h4",22),s(4,"Loading"),e(),f(5,"i",23),i(6,"p",24),s(7,"Cargando..."),e()()()())}function H(t,o){if(t&1&&(i(0,"tr",30)(1,"td"),s(2),e(),i(3,"td"),s(4),e(),i(5,"td"),s(6),e()()),t&2){let n,l,r=o.$implicit;_("routerLink","/detail-item/"+r.id),a(2),v(r.name),a(2),v((n=r.costPrice)!==null&&n!==void 0?n:"_"),a(2),v((l=r.salePrice)!==null&&l!==void 0?l:"_")}}function J(t,o){if(t&1&&(i(0,"tr")(1,"div",31)(2,"div",32),s(3),e()()()),t&2){let n=u(2);a(3),h(" ",n.isActiveFilters()?"Sin resultados para esa b\xFAsqueda":"No existen items por el momento en el sistema"," ")}}function K(t,o){if(t&1&&(i(0,"div",18)(1,"div",2)(2,"div",10)(3,"div",25)(4,"h3"),s(5),e(),i(6,"button",26),s(7," + Nuevo item "),e()(),i(8,"div",27)(9,"table",28)(10,"thead")(11,"tr")(12,"th"),s(13,"Nombre"),e(),i(14,"th"),s(15,"Precio coste"),e(),i(16,"th"),s(17,"Precio venta"),e()()(),i(18,"tbody",29),L(19,H,7,4,"tr",30,$,!1,J,4,1,"tr"),e()()()()()()),t&2){let n=u();a(5),h("Listado items (",n.total(),")"),a(14),F(n.items())}}function Q(t,o){if(t&1){let n=y();i(0,"div",19)(1,"app-pagination",33),p("offsetEmitter",function(r){I(n);let z=u();return C(z.detectChangeOffset(r))}),e()()}if(t&2){let n=u();a(),_("total",n.total())("factor",n.limit)("initialOffset",n.offset())}}var x=class t{fb=c(G);destroyRef=c(S);itemService=c(O);listItemsService=c(M);items=m([]);limit=5;offset=E(()=>this.listItemsService.lastOffsetItemsList());total=m(0);isLoading=m(!0);filtersOpen=m(!1);filters=m({});isActiveFilters=m(!1);searchForm=m(this.fb.group({name:["",[]]}));ngOnInit(){this.fetchAllItems()}fetchAllItems(){this.itemService.fetchAll(this.limit,this.offset(),this.filters()).pipe(R(this.destroyRef)).subscribe(o=>{o&&o.count>=0&&(this.total.set(o.count),this.items.set(o.items)),this.isLoading.set(!1)})}openCloseFilters(){this.filtersOpen.set(!this.filtersOpen())}searchFormSubmit(){this.filters.set(this.searchForm().value),this.listItemsService.lastOffsetItemsList.set(0),this.isActiveFilters.set(!0),this.fetchAllItems()}restartFilters(){this.listItemsService.lastOffsetItemsList.set(0),this.isActiveFilters.set(!1),this.filters.set({}),this.searchForm().reset(),this.fetchAllItems()}detectChangeOffset(o){this.isLoading.set(!0),this.listItemsService.lastOffsetItemsList.set(o),this.fetchAllItems()}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=g({type:t,selectors:[["list-items"]],decls:24,vars:5,consts:[[1,"main_content"],[1,"filters","mb-4"],[1,"box"],["data-bs-toggle","collapse","data-bs-target","#collapseFilters","aria-expanded","false","aria-controls","collapseFilters",1,"d-flex","justify-content-between","align-items-center","cp","mb-2",3,"click"],[1,"mb-0"],[1,"fa-solid","fa-window-minimize"],[1,"fa-solid","fa-window-maximize"],["id","collapseFilters",1,"collapse"],[1,"card","card-body"],["autocomplete","off",1,"search_form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],["type","text","formControlName","name"],[1,"d-flex","justify-content-start","mt-4"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-light","ms-2",3,"click"],[1,"row","animate__animated","animate__fadeIn"],[1,"table_clients"],[1,"d-flex","justify-content-center","w_100","mt-4"],[1,"col-12"],["role","alert",1,"alert","alert-info","text-center"],[1,"alert-heading"],[1,"fa","fa-spin","fa-refresh","fa-2x"],[1,"mb-o"],[1,"d-flex","justify-content-between","mb-3"],["routerLink","/new-item",1,"btn","btn-primary","mb-2"],[1,"table-responsive"],[1,"table"],[1,"animate__animated","animate__fadeIn"],[1,"admin_tr",3,"routerLink"],[1,"w-100","d-flex","justify-content-start"],[1,"alert","alert-warning"],[3,"offsetEmitter","total","factor","initialOffset"]],template:function(n,l){n&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),p("click",function(){return l.openCloseFilters()}),i(4,"h3",4),s(5,"Filtrar items"),e(),b(6,q,1,0,"i",5)(7,B,1,0,"i",6),e(),i(8,"div",7)(9,"div",8)(10,"form",9),p("ngSubmit",function(){return l.searchFormSubmit()}),i(11,"div",10)(12,"div",11)(13,"label",12),s(14,"Nombre"),e(),f(15,"input",13),e()(),i(16,"div",14)(17,"button",15),s(18,"Filtrar"),e(),i(19,"button",16),p("click",function(){return l.restartFilters()}),s(20," Restablecer filtros "),e()()()()()()(),b(21,U,8,0,"div",17)(22,K,22,2,"div",18)(23,Q,2,3,"div",19),e()),n&2&&(a(6),d(l.filtersOpen()?6:7),a(4),_("formGroup",l.searchForm()),a(11),d(l.isLoading()?21:-1),a(),d(l.isLoading()?-1:22),a(),d(l.total()?23:-1))},dependencies:[P,N,T,k,A,D,j,w,V],encapsulation:2,changeDetection:0})};export{x as default};
