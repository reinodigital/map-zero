import{a as G,b as H}from"./chunk-OTCPJ7SF.js";import"./chunk-O56ZJ2SI.js";import"./chunk-XMUSJKSV.js";import"./chunk-GFXBF4WM.js";import{a as $}from"./chunk-OHOHCLUG.js";import{a as I}from"./chunk-N2AJ3Z2J.js";import"./chunk-ALH4IQ5M.js";import{a as j}from"./chunk-4TAYINGZ.js";import"./chunk-XO5AROVW.js";import{J as U,i as N,j as P,k as L,p as O,s as z}from"./chunk-MJVO5DD5.js";import{Ba as M,Ib as i,Jb as _,Kb as v,La as a,Rb as D,Sb as Q,Tb as g,Va as B,_a as w,ba as E,eb as q,hb as k,ia as f,ja as S,jb as m,mb as F,na as V,nb as R,ob as t,pb as e,qb as u,ub as C,wa as T,yb as x,zb as s}from"./chunk-54LR7GFL.js";var J=(n,d)=>d.id;function K(n,d){if(n&1&&(t(0,"button",12),u(1,"i",37),i(2," Editar "),e()),n&2){let l=s(2);q("routerLink","/edit-quote/"+l.quoteId)}}function W(n,d){if(n&1){let l=C();t(0,"button",38),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.markAsAccepted(r.quoteId))}),i(1," Marcar como aceptada "),e()}}function X(n,d){n&1&&(t(0,"button",14),i(1,"Crear factura"),e())}function Y(n,d){n&1&&u(0,"div",16)}function Z(n,d){n&1&&u(0,"i",17)}function tt(n,d){if(n&1){let l=C();t(0,"li")(1,"button",39),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.markAsAccepted(r.quoteId))}),u(2,"i",40),i(3," Marcar como aceptada "),e()()}}function et(n,d){if(n&1){let l=C();t(0,"li")(1,"button",39),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.displayModalQuoteEmail(r.quote()))}),u(2,"i",41),i(3," Enviar "),e()()}}function it(n,d){if(n&1){let l=C();t(0,"li")(1,"button",39),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.markAsSent(r.quoteId))}),u(2,"i",42),i(3," Marcar como enviada "),e()()}}function nt(n,d){if(n&1){let l=C();t(0,"li")(1,"button",39),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.undoMarkAsAccepted(r.quoteId))}),u(2,"i",43),i(3," Desmarcar como aceptada "),e()()}}function ot(n,d){if(n&1){let l=C();t(0,"li")(1,"button",39),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.undoMarkAsDeclined(r.quoteId))}),u(2,"i",43),i(3," Desmarcar como rechazada "),e()()}}function at(n,d){if(n&1){let l=C();t(0,"li")(1,"button",39),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.undoMarkAsInvoiced(r.quoteId))}),u(2,"i",43),i(3," Desmarcar como facturada "),e()()}}function lt(n,d){if(n&1){let l=C();t(0,"li")(1,"button",39),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.markAsDeclined(r.quoteId))}),u(2,"i",44),i(3," Marcar como rechazada "),e()()}}function rt(n,d){if(n&1){let l=C();t(0,"li")(1,"button",39),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.markAsInvoiced(r.quoteId))}),u(2,"i",45),i(3," Marcar como facturada "),e()()}}function dt(n,d){if(n&1&&(t(0,"li")(1,"button",46),u(2,"i",47),i(3," Editar "),e()()),n&2){let l=s(2);a(),q("routerLink","/edit-quote/"+l.quoteId)}}function ct(n,d){if(n&1){let l=C();t(0,"li")(1,"button",39),x("click",function(){f(l);let r=s(2);return S(r.detailQuoteService.removeQuote(r.quote()))}),u(2,"i",48),i(3," Remover "),e()()}}function ut(n,d){if(n&1&&(t(0,"tr")(1,"td")(2,"span"),i(3),e()(),t(4,"td")(5,"span"),i(6),e()(),t(7,"td")(8,"span"),i(9),e()(),t(10,"td")(11,"span"),i(12),e()(),t(13,"td")(14,"span"),i(15),e()(),t(16,"td")(17,"span"),i(18),e()(),t(19,"td")(20,"span"),i(21),e()(),t(22,"td")(23,"span"),i(24),e()(),t(25,"td",49)(26,"span"),i(27),e()()()),n&2){let l,c,r,p=d.$implicit,b=s(2);a(3),_(p.item.name),a(3),_(p.description),a(3),_(p.quantity),a(3),_(p.price),a(3),_(p.discount),a(3),_((l=p.account==null?null:p.account.name)!==null&&l!==void 0?l:"_"),a(3),v(" ",b.detailQuoteService.getTaxRateLabel((c=p.taxRate)!==null&&c!==void 0?c:"")," "),a(3),_((r=p.seller==null?null:p.seller.name)!==null&&r!==void 0?r:"_"),a(3),_(p.amount)}}function mt(n,d){n&1&&(t(0,"tr",29)(1,"td",50),i(2," No existen Art\xEDculos ni servicios en esta cotizaci\xF3n. "),e()())}function st(n,d){if(n&1&&(t(0,"div",7)(1,"div",8)(2,"span",9),i(3),e(),t(4,"span"),i(5),e()(),t(6,"div",10)(7,"button",11),i(8,"Imprimir PDF"),e(),w(9,K,3,1,"button",12)(10,W,2,0,"button",13)(11,X,2,0,"button",14),t(12,"div",15),w(13,Y,1,0,"div",16)(14,Z,1,0,"i",17),t(15,"ul",18),w(16,tt,4,0,"li")(17,et,4,0,"li")(18,it,4,0,"li")(19,nt,4,0,"li")(20,ot,4,0,"li")(21,at,4,0,"li")(22,lt,4,0,"li")(23,rt,4,0,"li")(24,dt,4,1,"li")(25,ct,4,0,"li"),t(26,"li"),u(27,"div",19),t(28,"small",20),i(29,"Acciones"),e()()()()()(),t(30,"div",21)(31,"div",22)(32,"label"),i(33,"Cliente"),e(),t(34,"span"),i(35),e()(),t(36,"div",22)(37,"label"),i(38,"Fecha inicio"),e(),t(39,"span"),i(40),D(41,"readableDate"),e()(),t(42,"div",22)(43,"label"),i(44,"Fecha expira"),e(),t(45,"span"),i(46),D(47,"readableDate"),e()(),t(48,"div",22)(49,"label"),i(50,"N\xFAmero cotizaci\xF3n"),e(),t(51,"span"),i(52),e()(),t(53,"div",22)(54,"label"),i(55,"Moneda"),e(),t(56,"span"),i(57),e()(),t(58,"div",22)(59,"label"),i(60,"Estado"),e(),t(61,"span"),i(62),e()()(),t(63,"div",23)(64,"table",24)(65,"thead")(66,"tr")(67,"th",25)(68,"span"),i(69,"Item"),e()(),t(70,"th",26)(71,"span"),i(72,"Descripci\xF3n"),e()(),t(73,"th",27)(74,"span"),i(75," Cantidad "),e()(),t(76,"th",27)(77,"span"),i(78,"Precio"),e()(),t(79,"th",27)(80,"span"),i(81,"Descuento"),e()(),t(82,"th",27)(83,"span"),i(84,"Cuenta"),e()(),t(85,"th",27)(86,"span"),i(87,"Impuesto"),e()(),t(88,"th",27)(89,"span"),i(90,"Vendedor"),e()(),t(91,"th",28)(92,"span"),i(93,"Monto"),e()()()(),t(94,"tbody"),F(95,ut,28,9,"tr",null,J,!1,mt,3,0,"tr",29),e()()(),t(98,"div",30)(99,"div",31)(100,"ul",32)(101,"li",33)(102,"span"),i(103,"Subtotal"),e(),t(104,"span"),i(105),D(106,"number"),e()(),t(107,"li",33)(108,"span"),i(109,"Descuento total"),e(),t(110,"span",34),i(111),D(112,"number"),e()(),t(113,"li",33)(114,"span"),i(115,"Impuesto total"),e(),t(116,"span"),i(117),D(118,"number"),e()(),u(119,"div",35),t(120,"li",36)(121,"span"),i(122,"Total"),e(),t(123,"strong"),i(124),D(125,"number"),e()()()()()),n&2){let l,c,r,p,b,A,y,o=s();a(3),_((l=o.quote())==null?null:l.quoteNumber),a(),k(o.detailQuoteService.getStatusBadgeFromQuote((c=(c=o.quote())==null?null:c.status)!==null&&c!==void 0?c:"")),a(),v(" ",(r=o.quote())==null?null:r.status," "),a(4),m(o.allowedStatusToBeEditedFromDraft.includes(o.quote().status)?9:-1),a(),m(o.allowedStatusToBeAccepted.includes(o.quote().status)?10:-1),a(),m(o.allowedStatusToBeInvoiced.includes(o.quote().status)?11:-1),a(2),m(o.detailQuoteService.isSendEmailFromDetailComponentSubmitting()?13:14),a(3),m(o.allowedStatusToBeAccepted.includes(o.quote().status)?16:-1),a(),m(o.allowedStatusToBeSent.includes(o.quote().status)?17:-1),a(),m(o.allowedStatusToMarkAsSent.includes(o.quote().status)?18:-1),a(),m(o.allowedStatusToUnMarkAsAccepted.includes(o.quote().status)?19:-1),a(),m(o.allowedStatusToUnMarkAsDeclined.includes(o.quote().status)?20:-1),a(),m(o.allowedStatusToUnMarkAsInvoiced.includes(o.quote().status)?21:-1),a(),m(o.allowedStatusToBeDeclined.includes(o.quote().status)?22:-1),a(),m(o.allowedStatusToBeInvoiced.includes(o.quote().status)?23:-1),a(),m(o.allowedStatusToBeEdited.includes(o.quote().status)?24:-1),a(),m(o.quote().status!=="removida"?25:-1),a(10),_((p=o.quote())==null||p.client==null?null:p.client.name),a(5),_(Q(41,31,o.quote().initDate)),a(6),v(" ",o.quote().expireDate?Q(47,33,o.quote().expireDate):"_"," "),a(6),v(" ",o.quote().quoteNumber," "),a(5),v(" ",o.quote().currency," "),a(4),k(o.detailQuoteService.getStatusBadgeFromQuote((b=(b=o.quote())==null?null:b.status)!==null&&b!==void 0?b:"")),a(),v(" ",(A=o.quote())==null?null:A.status," "),a(33),R((y=o.quote())==null?null:y.quoteItems),a(10),_(g(106,35,o.subtotal(),"1.2-2")),a(6),v(" - ",g(112,38,o.totalDiscount(),"1.2-2")," "),a(6),_(g(118,41,o.totalTax(),"1.2-2")),a(7),v(" ",g(125,44,o.totalAmount(),"1.2-2")," ")}}function pt(n,d){if(n&1&&u(0,"tracking-entity",6),n&2){let l=s();q("tracking",l.quote().tracking)}}var h=class n{platformId=E(M);activatedRoute=E(O);commonAdminService=E(j);destroyRef=E(V);quoteService=E(U);detailQuoteService=E(G);allowedStatusToBeEditedFromDraft=["borrador"];allowedStatusToBeSent=["borrador","enviada"];allowedStatusToMarkAsSent=["borrador"];allowedStatusToBeAccepted=["enviada"];allowedStatusToBeInvoiced=["aceptada"];allowedStatusToBeDeclined=["enviada"];allowedStatusToBeEdited=["borrador","enviada"];allowedStatusToUnMarkAsAccepted=["aceptada"];allowedStatusToUnMarkAsDeclined=["rechazada"];allowedStatusToUnMarkAsInvoiced=["facturada"];get isBrowser(){return L(this.platformId)}quoteId;quote=T(null);subtotal=T(0);totalDiscount=T(0);totalTax=T(0);totalAmount=T(0);constructor(){this.quoteId=this.activatedRoute.snapshot.params.id}ngOnInit(){this.fetchQuote(),this.detailQuoteService.statusChange$.pipe(I(this.destroyRef)).subscribe(()=>{this.fetchQuote()})}fetchQuote(){this.quoteService.fetchOne(this.quoteId).pipe(I(this.destroyRef)).subscribe(d=>{d&&d.id&&(this.quote.set(d),this.updateTotals())})}updateTotals(){let d=this.detailQuoteService.calculateTotalsOnDetail(this.quote()?.quoteItems??[]);this.subtotal.set(d.subtotal),this.totalDiscount.set(d.discounts),this.totalTax.set(d.iva),this.totalAmount.set(d.total)}comeBackToList(){this.commonAdminService.comeBackToList("/list-quotes")}static \u0275fac=function(l){return new(l||n)};static \u0275cmp=B({type:n,selectors:[["detail-quote"]],decls:10,vars:2,consts:[[1,"main_content"],[1,"box"],[1,"d-flex","justify-content-between","mb-3"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[3,"tracking"],[1,"d-flex","justify-content-between","mb-4"],[1,"d-flex","align-items-center"],[1,"me-3"],[1,"hstack","gap-3"],[1,"btn","btn-outline-secondary"],["type","button",1,"btn","btn-primary",3,"routerLink"],["type","button",1,"btn","btn-primary"],[1,"btn","btn-primary"],[1,"dropdown"],[1,"spinner","ms-1"],["data-bs-toggle","dropdown","aria-expanded","false",1,"fa-solid","fa-ellipsis-vertical","three_points_dropdown"],[1,"dropdown-menu"],[1,"line_divider","mt-3","mb-2"],[1,"ms-3","fs-4"],[1,"row","mb-5"],[1,"col-12","col-md-3","col-lg-2"],[1,"row","table_items"],[1,"table","table-sm","mb-3"],[1,"col-2"],[1,"col-3"],[1,"col-1"],[1,"col-1","text-end"],[1,"no-elements"],[1,"row","mt-4"],[1,"col-md-6","col-lg-4","offset-md-6","offset-lg-8"],[1,"list-group","list-group-flush"],[1,"total_price","d-flex","justify-content-between"],[1,"text-danger"],[1,"line_divider"],[1,"total_price","d-flex","justify-content-between","mt-3"],[1,"fa-solid","fa-pen-to-square","me-2"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"dropdown-item",3,"click"],[1,"fa-solid","fa-check","icon_accepted","me-2"],[1,"fa-solid","fa-paper-plane","icon_sent","me-2"],[1,"fa-solid","fa-marker","icon_mark_as_sent","me-2"],[1,"fa-solid","fa-repeat","icon_trash","me-2"],[1,"fa-solid","fa-xmark","icon_declined","me-2"],[1,"fa-solid","fa-file-invoice-dollar","icon_accepted","me-2"],["type","button",1,"dropdown-item",3,"routerLink"],[1,"fa-solid","fa-pen-to-square","icon_pencil","me-2"],[1,"fa-solid","fa-trash","icon_trash","me-2"],[1,"text-end"],["colspan","12"]],template:function(l,c){l&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),i(4,"Detalle cotizaci\xF3n"),e(),t(5,"h4",4),x("click",function(){return c.comeBackToList()}),u(6,"i",5),i(7," Regresar "),e()(),w(8,st,126,47),e()(),w(9,pt,1,1,"tracking-entity",6)),l&2&&(a(8),m(c.quote()?8:-1),a(),m(c.quote()?9:-1))},dependencies:[P,N,z,H,$],styles:[".table_items[_ngcontent-%COMP%]{padding-top:4rem}th[_ngcontent-%COMP%]{color:var(--text);font-size:medium;font-weight:400}.total_price[_ngcontent-%COMP%]{font-size:1.3rem;margin-bottom:.4rem}"],changeDetection:0})};export{h as default};
