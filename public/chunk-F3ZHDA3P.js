import{a as H}from"./chunk-Y5YTRTSY.js";import{b as V,d as D,e as M,h as U,k as j,n as G,o as z,p as B,q as P,t as $,u as q}from"./chunk-TUWVJ4C7.js";import{j as k,s as O,v as R}from"./chunk-SQGBK3PG.js";import{Cb as F,Ib as l,Jb as g,Kb as b,La as a,Va as w,X as A,_a as S,ba as _,eb as d,ec as T,hb as I,ia as v,ja as E,jb as f,kb as N,mb as y,nb as h,ob as i,pb as e,qb as u,ub as x,wa as s,yb as p,zb as c}from"./chunk-54LR7GFL.js";var C=class n{lastOffsetEmployeesList=s(0);getClassForUserRole(o){let t="";switch(o){case"ADMIN":t="badge bg-label-primary";break;case"SELLER":t="badge bg-label-success";break;case"ACCOUNTANT":t="badge bg-label-light";break;case"ADMINISTRATIVE_ASSISTANT":t="badge bg-label-warning";break;case"SUPER_ADMIN":t="badge bg-label-danger";break;default:break}return t}static \u0275fac=function(t){return new(t||n)};static \u0275prov=A({token:n,factory:n.\u0275fac,providedIn:"root"})};var W=(n,o)=>o.uid;function X(n,o){if(n&1){let t=x();i(0,"i",31),p("click",function(){v(t);let m=c();return E(m.openCloseFilters())}),e()}}function Y(n,o){if(n&1){let t=x();i(0,"i",32),p("click",function(){v(t);let m=c();return E(m.openCloseFilters())}),e()}}function Z(n,o){if(n&1&&(i(0,"option",21),l(1),e()),n&2){let t=o.$implicit;d("value",t),a(),b(" ",t," ")}}function ee(n,o){n&1&&(i(0,"div",28)(1,"div",33)(2,"div",34)(3,"h4",35),l(4,"Loading"),e(),u(5,"i",36),i(6,"p",37),l(7,"Cargando..."),e()()()())}function te(n,o){if(n&1&&(i(0,"tr",43)(1,"td"),l(2),e(),i(3,"td"),l(4),e(),i(5,"td"),l(6),e(),i(7,"td")(8,"span"),l(9),e()()()),n&2){let t,r=o.$implicit,m=c(2);d("routerLink","/detail-employee/"+r.uid),a(2),g(r.name),a(2),g(r.mobile),a(2),g((t=r.email)!==null&&t!==void 0?t:"_"),a(2),I(m.listEmployeesService.getClassForUserRole(r.roles[0])),a(),b(" ",r.roles[0]," ")}}function ie(n,o){if(n&1&&(i(0,"tr")(1,"div",44)(2,"div",45),l(3),e()()()),n&2){let t=c(2);a(3),b(" ",t.isActiveFilters()?"Sin resultados para esa b\xFAsqueda":"No existen empleados por el momento en el sistema"," ")}}function ne(n,o){if(n&1&&(i(0,"div",29)(1,"div",2)(2,"div",10)(3,"div",38)(4,"h3"),l(5),e(),i(6,"button",39),l(7," + Nuevo empleado "),e()(),i(8,"div",40)(9,"table",41)(10,"thead")(11,"tr")(12,"th"),l(13,"Nombre"),e(),i(14,"th"),l(15,"Tel\xE9fono"),e(),i(16,"th"),l(17,"Correo"),e(),i(18,"th"),l(19,"Rol"),e()()(),i(20,"tbody",42),y(21,te,10,7,"tr",43,W,!1,ie,4,1,"tr"),e()()()()()()),n&2){let t=c();a(5),b("Listado empleados (",t.total(),")"),a(16),h(t.users())}}function le(n,o){if(n&1){let t=x();i(0,"div",30)(1,"app-pagination",46),p("offsetEmitter",function(m){v(t);let J=c();return E(J.detectChangeOffset(m))}),e()()}if(n&2){let t=c();a(),d("total",t.total())("factor",t.limit)("initialOffset",t.offset())}}var L=class n{fb=_($);authService=_(R);listEmployeesService=_(C);users=s([]);limit=5;offset=T(()=>this.listEmployeesService.lastOffsetEmployeesList());total=s(0);isLoading=s(!0);filtersOpen=s(!1);filters=s({});isActiveFilters=s(!1);searchForm=s(this.fb.group({name:["",[]],mobile:["",[]],email:["",[]],role:["",[]],status:["",[]]}));allowedFilteredRoles=["ADMINISTRATIVE_ASSISTANT","ADMIN","SELLER","ACCOUNTANT"];ngOnInit(){this.fetchAllUsers()}fetchAllUsers(){this.authService.fetchAllByAdmin(this.limit,this.offset(),this.filters()).subscribe(o=>{o&&o.count>=0&&(this.total.set(o.count),this.users.set(o.users)),this.isLoading.set(!1)})}openCloseFilters(){this.filtersOpen.set(!this.filtersOpen())}searchFormSubmit(){this.filters.set(this.searchForm().value),this.listEmployeesService.lastOffsetEmployeesList.set(0),this.isActiveFilters.set(!0),this.fetchAllUsers()}restartFilters(){this.listEmployeesService.lastOffsetEmployeesList.set(0),this.isActiveFilters.set(!1),this.filters.set({}),this.searchForm().reset(),this.fetchAllUsers()}detectChangeOffset(o){this.isLoading.set(!0),this.listEmployeesService.lastOffsetEmployeesList.set(o),this.fetchAllUsers()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=w({type:n,selectors:[["list-employees"]],decls:52,vars:7,consts:[[1,"main_content"],[1,"filters","mb-4"],[1,"box"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"mb-0"],["data-bs-toggle","collapse","data-bs-target","#collapseFilters","aria-expanded","false","aria-controls","collapseFilters",1,"fa-solid","fa-window-minimize"],["data-bs-toggle","collapse","data-bs-target","#collapseFilters","aria-expanded","false","aria-controls","collapseFilters",1,"fa-solid","fa-window-maximize"],["id","collapseFilters",1,"collapse"],[1,"card","card-body"],["autocomplete","off",1,"search_form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],["type","text","formControlName","name"],["for","mobile"],["type","text","formControlName","mobile"],["for","email"],["type","text","formControlName","email"],[1,"d-flex","flex-column"],["for","rol"],["formControlName","role"],[3,"value"],["formControlName","status"],["value","active"],["value","inactive"],[1,"d-flex","justify-content-start","mt-4"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-light","ms-2",3,"click"],[1,"row","animate__animated","animate__fadeIn"],[1,"table_clients"],[1,"d-flex","justify-content-center","w_100","mt-4"],["data-bs-toggle","collapse","data-bs-target","#collapseFilters","aria-expanded","false","aria-controls","collapseFilters",1,"fa-solid","fa-window-minimize",3,"click"],["data-bs-toggle","collapse","data-bs-target","#collapseFilters","aria-expanded","false","aria-controls","collapseFilters",1,"fa-solid","fa-window-maximize",3,"click"],[1,"col-12"],["role","alert",1,"alert","alert-info","text-center"],[1,"alert-heading"],[1,"fa","fa-spin","fa-refresh","fa-2x"],[1,"mb-o"],[1,"d-flex","justify-content-between","mb-3"],["routerLink","/new-employee",1,"btn","btn-primary","mb-2"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"animate__animated","animate__fadeIn"],[1,"admin_tr",3,"routerLink"],[1,"w-100","d-flex","justify-content-start"],[1,"alert","alert-warning"],[3,"offsetEmitter","total","factor","initialOffset"]],template:function(t,r){t&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),l(5,"Filtrar empleados"),e(),S(6,X,1,0,"i",5)(7,Y,1,0,"i",6),e(),i(8,"div",7)(9,"div",8)(10,"form",9),p("ngSubmit",function(){return r.searchFormSubmit()}),i(11,"div",10)(12,"div",11)(13,"label",12),l(14,"Nombre"),e(),u(15,"input",13),e(),i(16,"div",11)(17,"label",14),l(18,"Tel\xE9fono"),e(),u(19,"input",15),e(),i(20,"div",11)(21,"label",16),l(22,"Correo electr\xF3nico"),e(),u(23,"input",17),e(),i(24,"div",11)(25,"div",18)(26,"label",19),l(27,"Rol"),e(),i(28,"select",20)(29,"option",21),l(30,"--Seleccione--"),e(),y(31,Z,2,2,"option",21,N),e()()(),i(33,"div",11)(34,"div",18)(35,"label",19),l(36,"Estado"),e(),i(37,"select",22)(38,"option",21),l(39,"--Seleccione--"),e(),i(40,"option",23),l(41,"Activo"),e(),i(42,"option",24),l(43,"No activo"),e()()()()(),i(44,"div",25)(45,"button",26),l(46,"Filtrar"),e(),i(47,"button",27),p("click",function(){return r.restartFilters()}),l(48," Restablecer filtros "),e()()()()()()(),S(49,ee,8,0,"div",28)(50,ne,24,2,"div",29)(51,le,2,3,"div",30),e()),t&2&&(a(6),f(r.filtersOpen()?6:7),a(4),d("formGroup",r.searchForm()),a(19),F("value",null),a(2),h(r.allowedFilteredRoles),a(7),F("value",null),a(11),f(r.isLoading()?49:-1),a(),f(r.isLoading()?-1:50),a(),f(r.total()?51:-1))},dependencies:[k,O,H,q,U,B,P,V,z,D,M,j,G],encapsulation:2,changeDetection:0})};export{L as default};
