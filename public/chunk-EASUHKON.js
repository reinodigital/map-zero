import{a as X}from"./chunk-MYYOEW7H.js";import{a as W}from"./chunk-PII6ES2F.js";import"./chunk-QQKCDCZP.js";import{a as Q}from"./chunk-SX7XPOJI.js";import"./chunk-HZJ2PVQJ.js";import{a as w}from"./chunk-GZHOXXQG.js";import{a as K}from"./chunk-HT52MB4M.js";import{a as J}from"./chunk-VNY5M2TF.js";import"./chunk-WKFQL3IM.js";import"./chunk-5KSV7YSN.js";import{K as H,i as $,j as q,k as z,p as U,s as G}from"./chunk-G6MTQLVM.js";import{$a as S,Ab as _,Ba as N,Jb as i,Kb as d,Lb as p,Ma as n,Nb as V,Sb as f,Tb as k,Ub as D,Wa as P,ba as v,fb as C,ia as R,ib as h,ja as L,kb as x,lb as O,na as M,nb as y,ob as g,pb as e,qb as t,rb as s,vb as j,wa as u,zb as T}from"./chunk-F6XVVQNR.js";var Y=()=>[],Z=(a,l)=>l.id;function ee(a,l){if(a&1&&(e(0,"button",13),s(1,"i",37),i(2," Editar "),t()),a&2){let c=_(2);C("routerLink","/edit-invoice/"+c.invoiceId)}}function te(a,l){a&1&&s(0,"div",15)}function ie(a,l){a&1&&s(0,"i",16)}function ne(a,l){if(a&1&&(e(0,"li")(1,"button",38),s(2,"i",39),i(3," Editar "),t()()),a&2){let c=_(2);n(),C("routerLink","/edit-invoice/"+c.invoiceId)}}function ae(a,l){if(a&1){let c=j();e(0,"li")(1,"button",40),T("click",function(){R(c);let r=_(2);return L(r.detailInvoiceService.removeInvoice(r.invoice()))}),s(2,"i",41),i(3," Remover "),t()()}}function oe(a,l){if(a&1&&(e(0,"span"),s(1,"i",42),i(2),t()),a&2){let c=l.$implicit;n(2),p(" ",c," ")}}function le(a,l){a&1&&(e(0,"span"),i(1,"_"),t())}function ce(a,l){if(a&1&&(e(0,"tr")(1,"td")(2,"span"),i(3),t()(),e(4,"td")(5,"span"),i(6),t()(),e(7,"td")(8,"span"),i(9),t()(),e(10,"td")(11,"span"),i(12),t()(),e(13,"td")(14,"span"),i(15),t()(),e(16,"td")(17,"span"),i(18),t()(),e(19,"td")(20,"span"),i(21),t()(),e(22,"td",43)(23,"span"),i(24),t()()()),a&2){let c,m,r=l.$implicit,b=_(2);n(3),d(r.item.name),n(3),d(r.description),n(3),d(r.quantity),n(3),d(r.price),n(3),d(r.discount),n(3),d((c=r.account==null?null:r.account.name)!==null&&c!==void 0?c:"_"),n(3),p(" ",b.detailInvoiceService.getTaxRateLabel((m=r.taxRate)!==null&&m!==void 0?m:"")," "),n(3),d(r.amount)}}function re(a,l){a&1&&(e(0,"tr",29)(1,"td",44),i(2," No existen Art\xEDculos ni servicios en esta factura. "),t()())}function me(a,l){if(a&1&&(e(0,"div",8)(1,"div",9)(2,"span",10),i(3),t(),e(4,"span"),i(5),t()(),e(6,"div",11)(7,"button",12),i(8,"Imprimir PDF"),t(),S(9,ee,3,1,"button",13),e(10,"div",14),S(11,te,1,0,"div",15)(12,ie,1,0,"i",16),e(13,"ul",17),S(14,ne,4,1,"li")(15,ae,4,0,"li"),e(16,"li"),s(17,"div",18),e(18,"small",19),i(19,"Acciones"),t()()()()()(),e(20,"div",20)(21,"div",21)(22,"label"),i(23,"Cliente"),t(),e(24,"span"),i(25),t()(),e(26,"div",21)(27,"label"),i(28,"Fecha inicio"),t(),e(29,"span"),i(30),f(31,"readableDate"),t()(),e(32,"div",21)(33,"label"),i(34,"Fecha expira"),t(),e(35,"span"),i(36),f(37,"readableDate"),t()(),e(38,"div",21)(39,"label"),i(40,"N\xFAmero factura"),t(),e(41,"span"),i(42),t()(),e(43,"div",21)(44,"label"),i(45,"Moneda"),t(),e(46,"span"),i(47),t()(),e(48,"div",21)(49,"label"),i(50,"Estado"),t(),e(51,"span"),i(52),t()(),e(53,"div",21)(54,"label"),i(55,"Actividades econ\xF3micas"),t(),e(56,"div",22),y(57,oe,3,1,"span",null,O,!1,le,2,0,"span"),t()(),e(60,"div",21)(61,"label"),i(62,"Referencia"),t(),e(63,"span"),i(64),t()()(),e(65,"div",23)(66,"table",24)(67,"thead")(68,"tr")(69,"th",25)(70,"span"),i(71,"Item"),t()(),e(72,"th",26)(73,"span"),i(74,"Descripci\xF3n"),t()(),e(75,"th",27)(76,"span"),i(77," Cantidad "),t()(),e(78,"th",27)(79,"span"),i(80,"Precio"),t()(),e(81,"th",27)(82,"span"),i(83,"Descuento"),t()(),e(84,"th",27)(85,"span"),i(86,"Cuenta"),t()(),e(87,"th",27)(88,"span"),i(89,"Impuesto"),t()(),e(90,"th",28)(91,"span"),i(92,"Monto"),t()()()(),e(93,"tbody"),y(94,ce,25,8,"tr",null,Z,!1,re,3,0,"tr",29),t()()(),e(97,"div",30)(98,"div",31)(99,"ul",32)(100,"li",33)(101,"span"),i(102,"Subtotal"),t(),e(103,"span"),i(104),f(105,"number"),t()(),e(106,"li",33)(107,"span"),i(108,"Descuento total"),t(),e(109,"span",34),i(110),f(111,"number"),t()(),e(112,"li",33)(113,"span"),i(114,"Impuesto total"),t(),e(115,"span"),i(116),f(117,"number"),t()(),s(118,"div",35),e(119,"li",36)(120,"span"),i(121,"Total"),t(),e(122,"strong"),i(123),f(124,"number"),t()()()()()),a&2){let c,m,r,b,I,B,E,A,o=_();n(3),d((c=o.invoice())==null?null:c.invoiceNumber),n(),h(o.detailInvoiceService.getStatusBadgeFromInvoice((m=(m=o.invoice())==null?null:m.status)!==null&&m!==void 0?m:"")),n(),p(" ",(r=o.invoice())==null?null:r.status," "),n(4),x(o.allowedStatusToBeEditedFromDraft.includes(o.invoice().status)?9:-1),n(2),x(o.detailInvoiceService.isSendEmailFromDetailComponentSubmitting()?11:12),n(3),x(o.allowedStatusToBeEdited.includes(o.invoice().status)?14:-1),n(),x(o.invoice().status!=="removida"?15:-1),n(10),d((b=o.invoice())==null||b.client==null?null:b.client.name),n(5),d(k(31,23,o.invoice().initDate)),n(6),p(" ",o.invoice().expireDate?k(37,25,o.invoice().expireDate):"_"," "),n(6),p(" ",o.invoice().invoiceNumber," "),n(5),p(" ",o.invoice().currency," "),n(4),h(o.detailInvoiceService.getStatusBadgeFromInvoice((I=(I=o.invoice())==null?null:I.status)!==null&&I!==void 0?I:"")),n(),p(" ",(B=o.invoice())==null?null:B.status," "),n(5),g((E=(E=o.invoice())==null?null:E.receptorActivities)!==null&&E!==void 0?E:V(39,Y)),n(7),p(" ",o.invoice().reference?o.invoice().reference:"_"," "),n(30),g((A=o.invoice())==null?null:A.invoiceItems),n(10),d(D(105,27,o.subtotal(),"1.2-2")),n(6),p(" - ",D(111,30,o.totalDiscount(),"1.2-2")," "),n(6),d(D(117,33,o.totalTax(),"1.2-2")),n(7),p(" ",D(124,36,o.totalAmount(),"1.2-2")," ")}}function de(a,l){if(a&1&&s(0,"tracking-entity",7),a&2){let c=_();C("tracking",c.invoice().tracking)("entity",c.entityData())}}var F=class a{platformId=v(N);activatedRoute=v(U);commonAdminService=v(J);destroyRef=v(M);invoiceService=v(H);detailInvoiceService=v(X);entityData=u(null);allowedStatusToBeEditedFromDraft=["borrador"];allowedStatusToBeSent=["borrador","enviada"];allowedStatusToMarkAsSent=["borrador"];allowedStatusToBeAccepted=["enviada"];allowedStatusToBeEdited=["borrador","enviada"];get isBrowser(){return z(this.platformId)}invoiceId;invoice=u(null);subtotal=u(0);totalDiscount=u(0);totalTax=u(0);totalAmount=u(0);constructor(){this.invoiceId=this.activatedRoute.snapshot.params.id,this.entityData.set({refEntity:"Invoice",refEntityId:this.invoiceId})}ngOnInit(){this.fetchInvoice(),this.detailInvoiceService.statusChange$.pipe(w(this.destroyRef)).subscribe(()=>{this.fetchInvoice()})}fetchInvoice(){this.invoiceService.fetchOne(this.invoiceId).pipe(w(this.destroyRef)).subscribe(l=>{l&&l.id&&(this.invoice.set(l),this.updateTotals())})}updateTotals(){let l=this.detailInvoiceService.calculateTotalsOnDetail(this.invoice()?.invoiceItems??[]);this.subtotal.set(l.subtotal),this.totalDiscount.set(l.discounts),this.totalTax.set(l.iva),this.totalAmount.set(l.total)}comeBackToList(){this.commonAdminService.comeBackToList("/list-invoices")}static \u0275fac=function(c){return new(c||a)};static \u0275cmp=P({type:a,selectors:[["detail-invoice"]],decls:11,vars:6,consts:[[1,"main_content"],[3,"primaryText","primaryLink","secondaryText","secondaryLink"],[1,"box"],[1,"d-flex","justify-content-between","mb-3"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[3,"tracking","entity"],[1,"d-flex","justify-content-between","mb-4"],[1,"d-flex","align-items-center"],[1,"me-3"],[1,"hstack","gap-3"],[1,"btn","btn-outline-secondary"],["type","button",1,"btn","btn-primary",3,"routerLink"],[1,"dropdown"],[1,"spinner","ms-1"],["data-bs-toggle","dropdown","aria-expanded","false",1,"fa-solid","fa-ellipsis-vertical","three_points_dropdown"],[1,"dropdown-menu"],[1,"line_divider","mt-3","mb-2"],[1,"ms-3","fs-4"],[1,"row","mb-5"],[1,"col-12","col-md-3","col-lg-2"],[1,"d-flex","flex-column","mt-1"],[1,"row","table_items"],[1,"table","table-sm","mb-3"],[1,"col-2"],[1,"col-3"],[1,"col-1"],[1,"col-1","text-end"],[1,"no-elements"],[1,"row","mt-4"],[1,"col-md-6","col-lg-4","offset-md-6","offset-lg-8"],[1,"list-group","list-group-flush"],[1,"total_price","d-flex","justify-content-between"],[1,"text-danger"],[1,"line_divider"],[1,"total_price","d-flex","justify-content-between","mt-3"],[1,"fa-solid","fa-pen-to-square","me-2"],["type","button",1,"dropdown-item",3,"routerLink"],[1,"fa-solid","fa-pen-to-square","icon_pencil","me-2"],["type","button",1,"dropdown-item",3,"click"],[1,"fa-solid","fa-trash","icon_trash","me-2"],[1,"fa-solid","fa-check"],[1,"text-end"],["colspan","12"]],template:function(c,m){c&1&&(e(0,"div",0),s(1,"breadcrumb",1),e(2,"div",2)(3,"div",3)(4,"h3",4),i(5,"Detalle factura"),t(),e(6,"h4",5),T("click",function(){return m.comeBackToList()}),s(7,"i",6),i(8," Regresar "),t()(),S(9,me,125,40),t()(),S(10,de,1,2,"tracking-entity",7)),c&2&&(n(),C("primaryText","Vista de ventas")("primaryLink","/sales-overview")("secondaryText","Listado facturas")("secondaryLink","/list-invoices"),n(8),x(m.invoice()?9:-1),n(),x(m.invoice()?10:-1))},dependencies:[q,$,G,W,Q,K],styles:[".table_items[_ngcontent-%COMP%]{padding-top:4rem}th[_ngcontent-%COMP%]{color:var(--text);font-size:medium;font-weight:400}.total_price[_ngcontent-%COMP%]{font-size:1.3rem;margin-bottom:.4rem}"],changeDetection:0})};export{F as default};
