import{a as R}from"./chunk-LQYKURGZ.js";import{a as M}from"./chunk-YRVU5RW6.js";import{b as I,d as O,e as A,h as k,k as D,n as j,t as G,u as V}from"./chunk-UQEQGUXM.js";import{s as w,z as N}from"./chunk-K4252JJD.js";import{Ib as n,Jb as p,Kb as b,La as a,Va as g,_a as _,ba as C,eb as v,ec as T,hb as E,ia as h,ja as S,jb as d,mb as y,nb as F,ob as e,pb as t,qb as m,ub as L,wa as r,yb as f,zb as c}from"./chunk-QAVPLLNK.js";var B=(l,o)=>o.id;function P(l,o){l&1&&m(0,"i",5)}function $(l,o){l&1&&m(0,"i",6)}function q(l,o){l&1&&(e(0,"div",23)(1,"div",26)(2,"div",27)(3,"h4",28),n(4,"Loading"),t(),m(5,"i",29),e(6,"p",30),n(7,"Cargando..."),t()()()())}function H(l,o){if(l&1&&(e(0,"tr",36)(1,"td"),n(2),t(),e(3,"td")(4,"span"),n(5),t()(),e(6,"td"),n(7),t(),e(8,"td"),n(9),t(),e(10,"td"),n(11),t()()),l&2){let i=o.$implicit,s=c(2);v("routerLink","/detail-client/"+i.id),a(2),p(i.name),a(2),E(s.listClientsService.getClientContactTypeBadge(i.type)),a(),b(" ",i.type," "),a(2),p(i.identity),a(2),p(i.email),a(2),p(i.mobile)}}function J(l,o){if(l&1&&(e(0,"tr")(1,"div",37)(2,"div",38),n(3),t()()()),l&2){let i=c(2);a(3),b(" ",i.isActiveFilters()?"Sin resultados para esa b\xFAsqueda":"No existen clientes por el momento en el sistema"," ")}}function K(l,o){if(l&1&&(e(0,"div",24)(1,"div",2)(2,"div",10)(3,"div",31)(4,"h3"),n(5),t(),e(6,"button",32),n(7," + Nuevo contacto "),t()(),e(8,"div",33)(9,"table",34)(10,"thead")(11,"tr")(12,"th"),n(13,"Nombre"),t(),e(14,"th"),n(15,"Tipo"),t(),e(16,"th"),n(17,"C\xE9dula"),t(),e(18,"th"),n(19,"Correo"),t(),e(20,"th"),n(21,"Tel\xE9fono"),t()()(),e(22,"tbody",35),y(23,H,12,8,"tr",36,B,!1,J,4,1,"tr"),t()()()()()()),l&2){let i=c();a(5),b("Listado contactos (",i.total(),")"),a(18),F(i.clients())}}function Q(l,o){if(l&1){let i=L();e(0,"div",25)(1,"app-pagination",39),f("offsetEmitter",function(u){h(i);let z=c();return S(z.detectChangeOffset(u))}),t()()}if(l&2){let i=c();a(),v("total",i.total())("factor",i.limit)("initialOffset",i.offset())}}var x=class l{fb=C(G);clientService=C(N);listClientsService=C(R);clients=r([]);limit=5;offset=T(()=>this.listClientsService.lastOffsetListClients());total=r(0);isLoading=r(!0);filtersOpen=r(!1);filters=r({});isActiveFilters=r(!1);searchForm=r(this.fb.group({name:["",[]],identity:["",[]],email:["",[]],mobile:["",[]]}));ngOnInit(){this.fetchAllClients()}fetchAllClients(){this.clientService.fetchAll(this.limit,this.offset(),this.filters()).subscribe(o=>{o&&o.count>=0&&(this.total.set(o.count),this.clients.set(o.clients)),this.isLoading.set(!1)})}openCloseFilters(){this.filtersOpen.set(!this.filtersOpen())}searchFormSubmit(){this.filters.set(this.searchForm().value),this.listClientsService.lastOffsetListClients.set(0),this.isActiveFilters.set(!0),this.fetchAllClients()}restartFilters(){this.listClientsService.lastOffsetListClients.set(0),this.isActiveFilters.set(!1),this.filters.set({}),this.searchForm().reset(),this.fetchAllClients()}detectChangeOffset(o){this.isLoading.set(!0),this.listClientsService.lastOffsetListClients.set(o),this.fetchAllClients()}static \u0275fac=function(i){return new(i||l)};static \u0275cmp=g({type:l,selectors:[["list-clients"]],decls:36,vars:5,consts:[[1,"main_content"],[1,"filters","mb-4"],[1,"box"],["data-bs-toggle","collapse","data-bs-target","#collapseFilters","aria-expanded","false","aria-controls","collapseFilters",1,"d-flex","justify-content-between","align-items-center","cp","mb-2",3,"click"],[1,"mb-0"],[1,"fa-solid","fa-window-minimize"],[1,"fa-solid","fa-window-maximize"],["id","collapseFilters",1,"collapse"],[1,"card","card-body"],["autocomplete","off",1,"search_form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],["type","text","formControlName","name"],["for","identity"],["type","text","formControlName","identity"],["for","email"],["type","text","formControlName","email"],["for","mobile"],["type","text","formControlName","mobile"],[1,"d-flex","justify-content-start","mt-4"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-light","ms-2",3,"click"],[1,"row","animate__animated","animate__fadeIn"],[1,"table_clients"],[1,"d-flex","justify-content-center","w_100","mt-4"],[1,"col-12"],["role","alert",1,"alert","alert-info","text-center"],[1,"alert-heading"],[1,"fa","fa-spin","fa-refresh","fa-2x"],[1,"mb-o"],[1,"d-flex","justify-content-between","mb-3"],["routerLink","/new-client",1,"btn","btn-primary","mb-2"],[1,"table-responsive"],[1,"table"],[1,"animate__animated","animate__fadeIn"],[1,"admin_tr",3,"routerLink"],[1,"w-100","d-flex","justify-content-start"],[1,"alert","alert-warning"],[3,"offsetEmitter","total","factor","initialOffset"]],template:function(i,s){i&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),f("click",function(){return s.openCloseFilters()}),e(4,"h3",4),n(5,"Filtrar contactos"),t(),_(6,P,1,0,"i",5)(7,$,1,0,"i",6),t(),e(8,"div",7)(9,"div",8)(10,"form",9),f("ngSubmit",function(){return s.searchFormSubmit()}),e(11,"div",10)(12,"div",11)(13,"label",12),n(14,"Nombre"),t(),m(15,"input",13),t(),e(16,"div",11)(17,"label",14),n(18,"C\xE9dula"),t(),m(19,"input",15),t(),e(20,"div",11)(21,"label",16),n(22,"Correo electr\xF3nico"),t(),m(23,"input",17),t(),e(24,"div",11)(25,"label",18),n(26,"Tel\xE9fono"),t(),m(27,"input",19),t()(),e(28,"div",20)(29,"button",21),n(30,"Filtrar"),t(),e(31,"button",22),f("click",function(){return s.restartFilters()}),n(32," Restablecer filtros "),t()()()()()()(),_(33,q,8,0,"div",23)(34,K,26,2,"div",24)(35,Q,2,3,"div",25),t()),i&2&&(a(6),d(s.filtersOpen()?6:7),a(4),v("formGroup",s.searchForm()),a(23),d(s.isLoading()?33:-1),a(),d(s.isLoading()?-1:34),a(),d(s.total()?35:-1))},dependencies:[V,k,I,O,A,D,j,w,M],encapsulation:2,changeDetection:0})};export{x as default};
