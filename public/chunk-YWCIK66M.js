import{a as X,b as Y}from"./chunk-L36SVIOU.js";import{a as C}from"./chunk-GZHOXXQG.js";import"./chunk-MXFBXJ6G.js";import{a as W}from"./chunk-FUDPSQJN.js";import{a as Q}from"./chunk-5TLBDS6K.js";import{a as K}from"./chunk-WKFQL3IM.js";import{b as V,c as v,d as L,e as $,h as O,i as B,k as G,n as M,o as j,p as U,q,r as z,t as H,u as J}from"./chunk-UP3F5373.js";import{A,C as R,J as P,k as N,r as F,w as k}from"./chunk-4ZQGKSBB.js";import{$a as T,Ba as _,C as y,G as I,Jb as i,Lb as b,Ma as l,Wa as w,ba as m,fb as c,kb as D,lb as x,na as E,nb as u,ob as f,pb as e,qb as t,rb as s,wa as S,zb as p}from"./chunk-F6XVVQNR.js";var Z=(a,n)=>n.id;function ee(a,n){a&1&&(e(0,"small",19),i(1," nombre debe tener m\xE1s de 2 caracteres "),t())}function te(a,n){if(a&1&&(e(0,"option",29),i(1),t()),a&2){let o=n.$implicit;c("value",o.id),l(),b(" ",`${o.code} - ${o.name}`," ")}}function ie(a,n){if(a&1&&(e(0,"option",29),i(1),t()),a&2){let o=n.$implicit;c("value",o.code),l(),b(" ",`${o.code} - ${o.label}`," ")}}function ne(a,n){if(a&1&&(e(0,"option",29),i(1),t()),a&2){let o=n.$implicit;c("value",o.id),l(),b(" ",`${o.code} - ${o.name}`," ")}}function oe(a,n){if(a&1&&(e(0,"option",29),i(1),t()),a&2){let o=n.$implicit;c("value",o.code),l(),b(" ",`${o.code} - ${o.label}`," ")}}var g=class a{platformId=m(_);destroyRef=m(E);fb=m(H);commonAdminService=m(W);router=m(F);itemService=m(P);accountService=m(k);formErrorService=m(Q);customToastService=m(K);descriptionPropagationIsActive=S(!0);accounts=S([]);taxesArray=R;newItemForm=S(this.fb.group({name:["",[v.required,v.minLength(2)]],type:["Producto",[v.required]],cabys:[null,[v.required]],costPrice:[null,[]],purchaseAccountId:["",[]],purchaseTaxRate:["",[]],purchaseDescription:["",[]],salePrice:[null,[]],saleAccountId:["",[]],saleTaxRate:["",[]],saleDescription:["",[]]}));get isBrowser(){return N(this.platformId)}ngOnInit(){this.fetchAccounts(),this.setupDescriptionSync()}fetchAccounts(){this.accountService.fetchAll(999,0,{}).pipe(C(this.destroyRef)).subscribe(n=>{n&&n.accounts&&this.accounts.set(n.accounts)})}onTypeItemChange(n){n?this.newItemForm().controls.type.patchValue("Producto"):this.newItemForm().controls.type.patchValue("Servicio")}validField(n){return this.newItemForm().controls[n].touched&&this.newItemForm().controls[n].invalid}onDescriptionPropagationToggle(n){this.descriptionPropagationIsActive.set(n)}onCabysChange(n){this.newItemForm().controls.cabys.patchValue(n)}onSubmit(){if(this.newItemForm().value.cabys||this.customToastService.add({message:"Cabys es necesario para crear Item y est\xE1 faltando.",type:"error",duration:5e3}),this.newItemForm().invalid){this.formErrorService.throwFormErrors(this.newItemForm());return}let n=this.newItemForm().value;n.createdAt=A(new Date),this.itemService.create(n).subscribe(o=>{o&&o.msg?(this.customToastService.add({message:o.msg,type:"success",duration:5e3}),this.router.navigateByUrl("/list-items")):this.customToastService.add({message:o.message,type:"error",duration:5e3})})}setupDescriptionSync(){let n=this.newItemForm().get("purchaseDescription"),o=this.newItemForm().get("saleDescription");n&&o&&n.valueChanges.pipe(C(this.destroyRef),I(100),y(()=>this.descriptionPropagationIsActive())).subscribe(r=>{o.setValue(r,{emitEvent:!1})})}comeBackToList(){this.commonAdminService.comeBackToList("/list-items")}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=w({type:a,selectors:[["new-item"]],decls:111,vars:9,consts:[[1,"main_content"],[1,"box"],[1,"d-flex","justify-content-between","mb-4"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[1,"d-flex","justify-content-between","align-items-center"],["id","pills-tab","role","tablist",1,"nav","nav-pills","mb-4","div_pills"],["role","presentation",1,"nav-item"],["id","pills-fields-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-fields","role","tab","aria-controls","pills-fields","aria-selected","true",1,"nav-link","active"],["id","pills-cabys-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-cabys","role","tab","aria-controls","pills-cabys","aria-selected","false",1,"nav-link"],["id","pills-tabContent",1,"tab-content"],["id","pills-fields","role","tabpanel","aria-labelledby","pills-fields-tab","tabindex","0",1,"tab-pane","fade","active","show"],[1,"form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],[1,"asterisk"],["type","text","formControlName","name"],[1,"text-danger"],["for","type"],[3,"checkboxEmitter","affirmativeLabel","negativeLabel","checkboxDefaultValue","hostCheckboxDefaultClass"],[1,"mt-5"],["for","costPrice"],[1,"muted"],["type","number","min","0","formControlName","costPrice"],["for","purchaseAccountId"],["formControlName","purchaseAccountId"],["value",""],[3,"value"],["for","purchaseTaxRate"],["formControlName","purchaseTaxRate"],[1,"col-12"],[1,"d-flex","justify-content-between"],["for","purchaseDescription"],[3,"checkboxEmitter","affirmativeLabel","negativeLabel","checkboxDefaultValue"],["formControlName","purchaseDescription","rows","1"],["for","salePrice"],["type","number","min","0","formControlName","salePrice"],["for","saleAccountId"],["formControlName","saleAccountId"],["for","saleTaxRate"],["formControlName","saleTaxRate"],["for","saleDescription"],["formControlName","saleDescription","rows","1"],[1,"d-flex","flex-column","justify-content-center","align-items-center","mt-5"],["type","submit",1,"btn","btn-success"],["id","pills-cabys","role","tabpanel","aria-labelledby","pills-cabys-tab","tabindex","0",1,"tab-pane","fade"],[3,"cabysChange"]],template:function(o,r){o&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),i(4,"Nuevo item"),t(),e(5,"h4",4),p("click",function(){return r.comeBackToList()}),s(6,"i",5),i(7," Regresar "),t()(),e(8,"div",6)(9,"ul",7)(10,"li",8)(11,"button",9),i(12," Formulario "),t(),e(13,"button",10),i(14," C\xF3digo cabys "),t()()()(),e(15,"div",11)(16,"div",12)(17,"form",13),p("ngSubmit",function(){return r.onSubmit()}),e(18,"div",14)(19,"div",15)(20,"label",16),i(21,"Nombre "),e(22,"span",17),i(23,"*"),t()(),s(24,"input",18),T(25,ee,2,0,"small",19),t(),e(26,"div",15)(27,"label",20),i(28,"Tipo "),e(29,"span",17),i(30,"*"),t()(),e(31,"custom-checkbox",21),p("checkboxEmitter",function(d){return r.onTypeItemChange(d)}),t()()(),e(32,"h2",22),i(33,"Compra"),t(),e(34,"div",14)(35,"div",15)(36,"label",23),i(37," Coste "),e(38,"span",24),i(39,"opcional"),t()(),s(40,"input",25),t(),e(41,"div",15)(42,"label",26),i(43," Cuenta de compra "),e(44,"span",24),i(45,"opcional"),t()(),e(46,"select",27)(47,"option",28),i(48,"--Seleccione--"),t(),u(49,te,2,2,"option",29,Z),t()(),e(51,"div",15)(52,"label",30),i(53," Impuesto "),e(54,"span",24),i(55,"opcional"),t()(),e(56,"select",31)(57,"option",28),i(58,"--Seleccione--"),t(),u(59,ie,2,2,"option",29,x),t()()(),e(61,"div",14)(62,"div",32)(63,"div",33)(64,"label",34),i(65," Descripci\xF3n compra "),e(66,"span",24),i(67,"opcional"),t()(),e(68,"custom-checkbox",35),p("checkboxEmitter",function(d){return r.onDescriptionPropagationToggle(d)}),t()(),s(69,"textarea",36),t()(),e(70,"h2",22),i(71,"Venta"),t(),e(72,"div",14)(73,"div",15)(74,"label",37),i(75," Precio venta "),e(76,"span",24),i(77,"opcional"),t()(),s(78,"input",38),t(),e(79,"div",15)(80,"label",39),i(81," Cuenta de venta "),e(82,"span",24),i(83,"opcional"),t()(),e(84,"select",40)(85,"option",28),i(86,"--Seleccione--"),t(),u(87,ne,2,2,"option",29,Z),t()(),e(89,"div",15)(90,"label",41),i(91," Impuesto "),e(92,"span",24),i(93,"opcional"),t()(),e(94,"select",42)(95,"option",28),i(96,"--Seleccione--"),t(),u(97,oe,2,2,"option",29,x),t()()(),e(99,"div",14)(100,"div",32)(101,"label",43),i(102," Descripci\xF3n venta "),e(103,"span",24),i(104,"opcional"),t()(),s(105,"textarea",44),t()(),e(106,"div",45)(107,"button",46),i(108,"Guardar"),t()()()(),e(109,"div",47)(110,"cabys-select",48),p("cabysChange",function(d){return r.onCabysChange(d)}),t()()()()()),o&2&&(l(17),c("formGroup",r.newItemForm()),l(8),D(r.validField("name")?25:-1),l(6),c("affirmativeLabel","Producto")("negativeLabel","Servicio")("checkboxDefaultValue",!0)("hostCheckboxDefaultClass","d-flex align-items-end justify-content-start cp w-100"),l(18),f(r.accounts()),l(10),f(r.taxesArray),l(9),c("affirmativeLabel","Propagar")("negativeLabel","Detener")("checkboxDefaultValue",!0),l(19),f(r.accounts()),l(10),f(r.taxesArray))},dependencies:[J,O,U,q,V,B,j,L,$,z,G,M,X,Y],encapsulation:2,changeDetection:0})};export{g as default};
