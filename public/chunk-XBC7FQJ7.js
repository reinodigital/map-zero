import{a as z}from"./chunk-TFQCOCDO.js";import{a as R}from"./chunk-N2AJ3Z2J.js";import{a as P}from"./chunk-Y5YTRTSY.js";import{b as T,d as O,e as A,h as N,k as V,n as D,t as j,u as G}from"./chunk-ALH4IQ5M.js";import{I as k,s as y}from"./chunk-MJVO5DD5.js";import{Ib as s,Jb as x,Kb as g,La as l,Va as F,_a as h,ba as f,eb as b,ec as E,ia as u,ja as _,jb as p,mb as L,na as S,nb as w,ob as n,pb as e,qb as C,ub as v,wa as m,yb as d,zb as c}from"./chunk-54LR7GFL.js";var $=(i,o)=>o.id;function q(i,o){if(i&1){let t=v();n(0,"i",20),d("click",function(){u(t);let r=c();return _(r.openCloseFilters())}),e()}}function B(i,o){if(i&1){let t=v();n(0,"i",21),d("click",function(){u(t);let r=c();return _(r.openCloseFilters())}),e()}}function U(i,o){i&1&&(n(0,"div",17)(1,"div",22)(2,"div",23)(3,"h4",24),s(4,"Loading"),e(),C(5,"i",25),n(6,"p",26),s(7,"Cargando..."),e()()()())}function H(i,o){if(i&1&&(n(0,"tr",32)(1,"td"),s(2),e(),n(3,"td"),s(4),e(),n(5,"td"),s(6),e()()),i&2){let t,a,r=o.$implicit;b("routerLink","/detail-item/"+r.id),l(2),x(r.name),l(2),x((t=r.costPrice)!==null&&t!==void 0?t:"_"),l(2),x((a=r.salePrice)!==null&&a!==void 0?a:"_")}}function J(i,o){if(i&1&&(n(0,"tr")(1,"div",33)(2,"div",34),s(3),e()()()),i&2){let t=c(2);l(3),g(" ",t.isActiveFilters()?"Sin resultados para esa b\xFAsqueda":"No existen items por el momento en el sistema"," ")}}function K(i,o){if(i&1&&(n(0,"div",18)(1,"div",2)(2,"div",10)(3,"div",27)(4,"h3"),s(5),e(),n(6,"button",28),s(7," + Nuevo item "),e()(),n(8,"div",29)(9,"table",30)(10,"thead")(11,"tr")(12,"th"),s(13,"Nombre"),e(),n(14,"th"),s(15,"Precio coste"),e(),n(16,"th"),s(17,"Precio venta"),e()()(),n(18,"tbody",31),L(19,H,7,4,"tr",32,$,!1,J,4,1,"tr"),e()()()()()()),i&2){let t=c();l(5),g("Listado items (",t.total(),")"),l(14),w(t.items())}}function Q(i,o){if(i&1){let t=v();n(0,"div",19)(1,"app-pagination",35),d("offsetEmitter",function(r){u(t);let M=c();return _(M.detectChangeOffset(r))}),e()()}if(i&2){let t=c();l(),b("total",t.total())("factor",t.limit)("initialOffset",t.offset())}}var I=class i{fb=f(j);destroyRef=f(S);itemService=f(k);listItemsService=f(z);items=m([]);limit=5;offset=E(()=>this.listItemsService.lastOffsetItemsList());total=m(0);isLoading=m(!0);filtersOpen=m(!1);filters=m({});isActiveFilters=m(!1);searchForm=m(this.fb.group({name:["",[]]}));ngOnInit(){this.fetchAllItems()}fetchAllItems(){this.itemService.fetchAll(this.limit,this.offset(),this.filters()).pipe(R(this.destroyRef)).subscribe(o=>{o&&o.count>=0&&(this.total.set(o.count),this.items.set(o.items)),this.isLoading.set(!1)})}openCloseFilters(){this.filtersOpen.set(!this.filtersOpen())}searchFormSubmit(){this.filters.set(this.searchForm().value),this.listItemsService.lastOffsetItemsList.set(0),this.isActiveFilters.set(!0),this.fetchAllItems()}restartFilters(){this.listItemsService.lastOffsetItemsList.set(0),this.isActiveFilters.set(!1),this.filters.set({}),this.searchForm().reset(),this.fetchAllItems()}detectChangeOffset(o){this.isLoading.set(!0),this.listItemsService.lastOffsetItemsList.set(o),this.fetchAllItems()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=F({type:i,selectors:[["list-items"]],decls:24,vars:5,consts:[[1,"main_content"],[1,"filters","mb-4"],[1,"box"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],[1,"mb-0"],["data-bs-toggle","collapse","data-bs-target","#collapseFilters","aria-expanded","false","aria-controls","collapseFilters",1,"fa-solid","fa-window-minimize"],["data-bs-toggle","collapse","data-bs-target","#collapseFilters","aria-expanded","false","aria-controls","collapseFilters",1,"fa-solid","fa-window-maximize"],["id","collapseFilters",1,"collapse"],[1,"card","card-body"],["autocomplete","off",1,"search_form",3,"ngSubmit","formGroup"],[1,"row"],[1,"col-12","col-sm-6","col-lg-4"],["for","name"],["type","text","formControlName","name"],[1,"d-flex","justify-content-start","mt-4"],["type","submit",1,"btn","btn-success"],["type","button",1,"btn","btn-light","ms-2",3,"click"],[1,"row","animate__animated","animate__fadeIn"],[1,"table_clients"],[1,"d-flex","justify-content-center","w_100","mt-4"],["data-bs-toggle","collapse","data-bs-target","#collapseFilters","aria-expanded","false","aria-controls","collapseFilters",1,"fa-solid","fa-window-minimize",3,"click"],["data-bs-toggle","collapse","data-bs-target","#collapseFilters","aria-expanded","false","aria-controls","collapseFilters",1,"fa-solid","fa-window-maximize",3,"click"],[1,"col-12"],["role","alert",1,"alert","alert-info","text-center"],[1,"alert-heading"],[1,"fa","fa-spin","fa-refresh","fa-2x"],[1,"mb-o"],[1,"d-flex","justify-content-between","mb-3"],["routerLink","/new-item",1,"btn","btn-primary","mb-2"],[1,"table-responsive"],[1,"table","table-bordered"],[1,"animate__animated","animate__fadeIn"],[1,"admin_tr",3,"routerLink"],[1,"w-100","d-flex","justify-content-start"],[1,"alert","alert-warning"],[3,"offsetEmitter","total","factor","initialOffset"]],template:function(t,a){t&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),s(5,"Filtrar items"),e(),h(6,q,1,0,"i",5)(7,B,1,0,"i",6),e(),n(8,"div",7)(9,"div",8)(10,"form",9),d("ngSubmit",function(){return a.searchFormSubmit()}),n(11,"div",10)(12,"div",11)(13,"label",12),s(14,"Nombre"),e(),C(15,"input",13),e()(),n(16,"div",14)(17,"button",15),s(18,"Filtrar"),e(),n(19,"button",16),d("click",function(){return a.restartFilters()}),s(20," Restablecer filtros "),e()()()()()()(),h(21,U,8,0,"div",17)(22,K,22,2,"div",18)(23,Q,2,3,"div",19),e()),t&2&&(l(6),p(a.filtersOpen()?6:7),l(4),b("formGroup",a.searchForm()),l(11),p(a.isLoading()?21:-1),l(),p(a.isLoading()?-1:22),l(),p(a.total()?23:-1))},dependencies:[G,N,T,O,A,V,D,y,P],encapsulation:2,changeDetection:0})};export{I as default};
