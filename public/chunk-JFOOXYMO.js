import{a as fe}from"./chunk-RZZHY2IM.js";import{a as J}from"./chunk-7H4JIEJ2.js";import{a as pe}from"./chunk-UV7LDJRE.js";import{a as ue}from"./chunk-LQYKURGZ.js";import{u as P,w as ce}from"./chunk-UYDUL6F7.js";import{a as _}from"./chunk-KGOR65YN.js";import{a as me}from"./chunk-H3WDBP26.js";import{a as O}from"./chunk-EO4DNGQO.js";import{a as se}from"./chunk-QULINWIQ.js";import{b as A,c as g,d as I,e as D,h as M,k as N,n as w,o as le,p as re,q as de,t as k,u as R}from"./chunk-7DSSDOH7.js";import{A as T,F as ne,G as oe,H as ae,k as Z,p as ee,s as te,z as ie}from"./chunk-GCLW45SM.js";import{Ba as X,Ib as i,Jb as m,Kb as x,La as d,Mb as q,Va as y,X as W,_a as v,ba as s,eb as p,hb as Y,ia as L,j as Q,ja as j,jb as f,kb as G,mb as h,na as F,nb as E,ob as t,pb as e,qb as c,ub as U,wa as b,yb as C,zb as S}from"./chunk-QAVPLLNK.js";var z=(a,n)=>n.id;function ge(a,n){if(a&1&&(t(0,"option",7),i(1),e()),a&2){let o=n.$implicit;p("ngValue",o),d(),x(" ",o.name," ")}}function _e(a,n){a&1&&(t(0,"small",8),i(1," seleccione una provincia por favor "),e())}function xe(a,n){if(a&1&&(t(0,"option",7),i(1),e()),a&2){let o=n.$implicit;p("ngValue",o),d(),x(" ",o.name," ")}}function he(a,n){a&1&&(t(0,"small",8),i(1," seleccione un cant\xF3n por favor "),e())}function Ee(a,n){if(a&1&&(t(0,"option",7),i(1),e()),a&2){let o=n.$implicit;p("ngValue",o),d(),x(" ",o.name," ")}}function ye(a,n){a&1&&(t(0,"small",8),i(1," seleccione un distrito por favor "),e())}function Fe(a,n){a&1&&(t(0,"small",8),i(1," Longitud de texto debe ser entre 8 a 120 letras. "),e())}function Te(a,n){if(a&1&&(t(0,"div",14)(1,"div",16),i(2),e()()),a&2){let o=S();d(2),x(" ",o.errMsg()," ")}}var V=class a{fb=s(k);destroyRef=s(F);territoryService=s(ae);formErrorService=s(O);dialogRef=s(P);provinces=b([]);cantons=b([]);districts=b([]);errMsg=b("");addressForm=b(this.fb.group({province:[null,[g.required]],canton:[null,[g.required]],district:[null,[g.required]],exactAddress:[null,[g.minLength(8),g.maxLength(120)]]}));ngOnInit(){this.fetchSevenProvinces(),this.addressForm().controls.province.valueChanges.pipe(_(this.destroyRef)).subscribe(n=>{n&&this.fetchCantonsByProvinceId(n.id),this.addressForm().controls.canton.patchValue(null)}),this.addressForm().controls.canton.valueChanges.pipe(_(this.destroyRef)).subscribe(n=>{n&&this.fetchDistrictsByCantonId(n.id),this.addressForm().controls.district.patchValue(null)})}closePopUp(n=null){this.dialogRef.close(n)}validField(n){return this.addressForm().controls[n].touched&&this.addressForm().controls[n].invalid}fetchSevenProvinces(){this.territoryService.fetchProvinces().pipe(_(this.destroyRef)).subscribe(n=>{n&&n.length&&this.provinces.set(n)})}fetchCantonsByProvinceId(n){this.territoryService.fetchCantonsByProvinceId(n).pipe(_(this.destroyRef)).subscribe(o=>{o&&o.length&&this.cantons.set(o)})}fetchDistrictsByCantonId(n){this.territoryService.fetchDistrictsByCantonId(n).pipe(_(this.destroyRef)).subscribe(o=>{o&&o.length&&this.districts.set(o)})}saveAddress(){if(this.addressForm().invalid){this.formErrorService.throwFormErrors(this.addressForm());return}let{province:n,canton:o,district:r,exactAddress:l}=this.addressForm().value,u={createdAt:T(new Date),provinceName:n.name,provinceCode:n.code.toString(),cantonName:o.name,cantonCode:o.code.toString(),districtName:r.name,districtCode:r.code.toString(),exactAddress:l??null};this.closePopUp(JSON.stringify(u))}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=y({type:a,selectors:[["modal-client-address"]],decls:50,vars:10,consts:[["autocomplete","off",1,"form","container",3,"ngSubmit","formGroup"],[1,"header_form"],[1,"fa-solid","fa-xmark","icon_close",3,"click"],[1,"form_content"],[1,"col-12"],[1,"asterisk"],["formControlName","province",1,"w-100"],[3,"ngValue"],[1,"form-text","text-danger"],["formControlName","canton",1,"w-100"],["formControlName","district",1,"w-100"],[1,"d-flex","flex-column"],[1,"muted"],["formControlName","exactAddress","rows","2"],[1,"d-flex","justify-content-center","mt-3"],["type","submit",1,"btn","btn-success","mt-4","mb-4","w-100",3,"disabled"],[1,"alert","alert-danger"]],template:function(o,r){o&1&&(t(0,"form",0),C("ngSubmit",function(){return r.saveAddress()}),t(1,"div",1)(2,"h3"),i(3,"Agregar direcci\xF3n"),e(),t(4,"i",2),C("click",function(){return r.closePopUp()}),e()(),t(5,"div",3)(6,"div",4)(7,"label"),i(8,"Provincia "),t(9,"span",5),i(10,"*"),e()(),t(11,"select",6)(12,"option",7),i(13,"-- Seleccione --"),e(),h(14,ge,2,2,"option",7,z),e(),v(16,_e,2,0,"small",8),e(),t(17,"div",4)(18,"label"),i(19,"Cant\xF3n "),t(20,"span",5),i(21,"*"),e()(),t(22,"select",9)(23,"option",7),i(24,"-- Seleccione --"),e(),h(25,xe,2,2,"option",7,z),e(),v(27,he,2,0,"small",8),e(),t(28,"div",4)(29,"label"),i(30,"Distrito "),t(31,"span",5),i(32,"*"),e()(),t(33,"select",10)(34,"option",7),i(35,"-- Seleccione --"),e(),h(36,Ee,2,2,"option",7,z),e(),v(38,ye,2,0,"small",8),e(),t(39,"div",4)(40,"div",11)(41,"label"),i(42,"Direcci\xF3n exacta "),t(43,"span",12),i(44,"opcional"),e()(),c(45,"textarea",13),e(),v(46,Fe,2,0,"small",8),e(),v(47,Te,3,1,"div",14),t(48,"button",15),i(49," Agregar "),e()()()),o&2&&(p("formGroup",r.addressForm()),d(12),p("ngValue",null),d(2),E(r.provinces()),d(2),f(r.validField("province")?16:-1),d(7),p("ngValue",null),d(2),E(r.cantons()),d(2),f(r.validField("canton")?27:-1),d(7),p("ngValue",null),d(2),E(r.districts()),d(2),f(r.validField("district")?38:-1),d(8),f(r.validField("exactAddress")?46:-1),d(),f(r.errMsg()?47:-1),d(),p("disabled",r.addressForm().invalid))},dependencies:[R,M,re,de,A,le,I,D,N,w],styles:[".form[_ngcontent-%COMP%]{padding:2rem}label[_ngcontent-%COMP%]{color:var(--black)}.header_form[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.header_form[_ngcontent-%COMP%]   .icon_close[_ngcontent-%COMP%]{font-size:2.3rem}"],changeDetection:0})};function Ae(a,n){a&1&&(t(0,"small",7),i(1," nombre debe tener al menos 2 caracteres "),e())}var B=class a{fb=s(k);formErrorService=s(O);dialogRef=s(P);errMsg=b("");contactForm=b(this.fb.group({name:["",[g.required,g.minLength(2)]],lastName:["",[]],email:["",[]],mobile:["",[]]}));closePopUp(n=null){this.dialogRef.close(n)}validField(n){return this.contactForm().controls[n].touched&&this.contactForm().controls[n].invalid}onSubmit(){if(this.contactForm().invalid){this.formErrorService.throwFormErrors(this.contactForm());return}let n={createdAt:T(new Date),name:this.contactForm().controls.name.value,lastName:this.contactForm().controls.lastName.value?this.contactForm().controls.lastName.value:null,email:this.contactForm().controls.email.value?this.contactForm().controls.email.value:null,mobile:this.contactForm().controls.mobile.value?this.contactForm().controls.mobile.value:null};this.closePopUp(JSON.stringify(n))}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=y({type:a,selectors:[["modal-client-contact"]],decls:33,vars:3,consts:[["autocomplete","off",1,"form","container",3,"ngSubmit","formGroup"],[1,"header_form"],[1,"fa-solid","fa-xmark","icon_close",3,"click"],[1,"form_content"],[1,"col-12"],[1,"asterisk"],["formControlName","name"],[1,"form-text","text-danger"],[1,"muted"],["formControlName","lastName"],["formControlName","email"],["formControlName","mobile"],["type","submit",1,"btn","btn-success","mt-4","mb-4","w-100",3,"disabled"]],template:function(o,r){o&1&&(t(0,"form",0),C("ngSubmit",function(){return r.onSubmit()}),t(1,"div",1)(2,"h3"),i(3,"Agregar contacto"),e(),t(4,"i",2),C("click",function(){return r.closePopUp()}),e()(),t(5,"div",3)(6,"div",4)(7,"label"),i(8,"Nombre "),t(9,"span",5),i(10,"*"),e()(),c(11,"input",6),v(12,Ae,2,0,"small",7),e(),t(13,"div",4)(14,"label"),i(15,"Apellidos "),t(16,"span",8),i(17,"opcional"),e()(),c(18,"input",9),e(),t(19,"div",4)(20,"label"),i(21,"Correo "),t(22,"span",8),i(23,"opcional"),e()(),c(24,"input",10),e(),t(25,"div",4)(26,"label"),i(27,"Tel\xE9fono "),t(28,"span",8),i(29,"opcional"),e()(),c(30,"input",11),e()(),t(31,"button",12),i(32," Agregar "),e()()),o&2&&(p("formGroup",r.contactForm()),d(12),f(r.validField("name")?12:-1),d(19),p("disabled",r.contactForm().invalid))},dependencies:[R,M,A,I,D,N,w],styles:[".form[_ngcontent-%COMP%]{padding:2rem}label[_ngcontent-%COMP%]{color:var(--black)}.header_form[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.header_form[_ngcontent-%COMP%]   .icon_close[_ngcontent-%COMP%]{font-size:2.3rem}"],changeDetection:0})};var $=class a{clientAddressService=s(ne);clientContactService=s(oe);customToastService=s(se);dialog=s(ce);_newAddress$=new Q;newAddress$=this._newAddress$.asObservable();addNewAddress(n){let o=this.dialog.open(V,{width:"35rem",height:"auto",autoFocus:!1,data:null});o.updatePosition({top:"100px"}),o.afterClosed().subscribe(r=>{r&&this.clientAddressService.create(n,JSON.parse(r)).subscribe(l=>{l&&l.msg?(this.customToastService.add({message:l.msg,type:"success",duration:1e4}),this._newAddress$.next()):this.customToastService.add({message:l.message,type:"error",duration:1e4})})})}removeAddress(n){let o=this.dialog.open(J,{width:"60rem",height:"20rem",autoFocus:!1,data:"Est\xE1s seguro/a de que deseas eliminar esta direcci\xF3n de cliente ?"});o.updatePosition({top:"100px"}),o.afterClosed().subscribe(r=>{r&&this.clientAddressService.removeOne(n).subscribe(l=>{l&&l.msg?(this.customToastService.add({message:l.msg,type:"success",duration:1e4}),this._newAddress$.next()):this.customToastService.add({message:l.message,type:"error",duration:1e4})})})}addNewContact(n){let o=this.dialog.open(B,{width:"35rem",height:"auto",autoFocus:!1,data:null});o.updatePosition({top:"100px"}),o.afterClosed().subscribe(r=>{r&&this.clientContactService.create(n,JSON.parse(r)).subscribe(l=>{l&&l.msg?(this.customToastService.add({message:l.msg,type:"success",duration:1e4}),this._newAddress$.next()):this.customToastService.add({message:l.message,type:"error",duration:1e4})})})}removeContact(n){let o=this.dialog.open(J,{width:"60rem",height:"20rem",autoFocus:!1,data:"Est\xE1s seguro/a de que deseas eliminar este contacto de cliente ?"});o.updatePosition({top:"100px"}),o.afterClosed().subscribe(r=>{r&&this.clientContactService.removeOne(n).subscribe(l=>{l&&l.msg?(this.customToastService.add({message:l.msg,type:"success",duration:1e4}),this._newAddress$.next()):this.customToastService.add({message:l.message,type:"error",duration:1e4})})})}static \u0275fac=function(o){return new(o||a)};static \u0275prov=W({token:a,factory:a.\u0275fac,providedIn:"root"})};var Ce=()=>[];function Ie(a,n){if(a&1&&(t(0,"div",28)(1,"label"),i(2,"Notas "),e(),t(3,"span"),i(4),e()()),a&2){let o=S(2);d(4),m(o.client().notes)}}function De(a,n){if(a&1&&(t(0,"div",28)(1,"label"),i(2,"Vendedor/a "),e(),t(3,"span"),i(4),e()()),a&2){let o=S(2);d(4),m(o.client().defaultSeller)}}function Me(a,n){if(a&1&&(t(0,"div",22)(1,"div",28)(2,"label"),i(3,"Nombre"),e(),t(4,"span"),i(5),e()(),t(6,"div",28)(7,"label"),i(8,"Tipo"),e(),t(9,"span"),i(10),e()(),t(11,"div",28)(12,"label"),i(13,"C\xE9dula"),e(),t(14,"span"),i(15),e()(),t(16,"div",28)(17,"label"),i(18,"Tipo c\xE9dula"),e(),t(19,"span"),i(20),e()(),t(21,"div",28)(22,"label"),i(23,"Tel\xE9fono"),e(),t(24,"span"),i(25),e()(),t(26,"div",28)(27,"label"),i(28,"Moneda "),e(),t(29,"span"),i(30),e()(),t(31,"div",28)(32,"label"),i(33,"Correo electr\xF3nico "),e(),t(34,"span"),i(35),e()(),v(36,Ie,5,1,"div",28)(37,De,5,1,"div",28),e()),a&2){let o,r,l=S();d(5),m(l.client().name),d(4),Y(l.listClientsService.getClientContactTypeBadge(l.client().type)),d(),x(" ",l.client().type," "),d(5),m(l.client().identity),d(5),x(" ",l.listClientsService.getIdentityType(l.client().identityType)," "),d(5),m(l.client().mobile),d(5),m(l.client().currency),d(5),m(l.client().email),d(),f((o=l.client())!=null&&o.notes?36:-1),d(),f((r=l.client())!=null&&r.defaultSeller?37:-1)}}function Ne(a,n){if(a&1){let o=U();t(0,"tr")(1,"td"),i(2),e(),t(3,"td"),i(4),e(),t(5,"td"),i(6),e(),t(7,"td"),i(8),e(),t(9,"td"),i(10),e(),t(11,"td")(12,"div",29),C("click",function(){let l=L(o).$implicit,u=S();return j(u.removeAddress(l.id))}),c(13,"i",30),e()()()}if(a&2){let o=n.$implicit,r=n.$index;d(2),m(r+1),d(2),m(o.provinceName),d(2),m(o.cantonName),d(2),m(o.districtName),d(2),m(o.exactAddress?o.exactAddress:"_")}}function we(a,n){a&1&&(t(0,"tr")(1,"div",31)(2,"div",32),i(3," Sin direcciones por el momento. "),e()()())}function ke(a,n){if(a&1){let o=U();t(0,"tr")(1,"td"),i(2),e(),t(3,"td"),i(4),e(),t(5,"td"),i(6),e(),t(7,"td"),i(8),e(),t(9,"td"),i(10),e(),t(11,"td")(12,"div",29),C("click",function(){let l=L(o).$implicit,u=S();return j(u.removeContact(l.id))}),c(13,"i",30),e()()()}if(a&2){let o,r,l,u=n.$implicit,be=n.$index;d(2),m(be+1),d(2),m(u.name),d(2),m((o=u.lastName)!==null&&o!==void 0?o:"_"),d(2),m((r=u.email)!==null&&r!==void 0?r:"_"),d(2),m((l=u.mobile)!==null&&l!==void 0?l:"_")}}function Re(a,n){a&1&&(t(0,"tr")(1,"div",31)(2,"div",32),i(3," Sin personas secundarias por el momento. "),e()()())}function Pe(a,n){if(a&1&&c(0,"tracking-entity",27),a&2){let o=S();p("tracking",o.client().tracking)}}var K=class a{platformId=s(X);activatedRoute=s(ee);commonAdminService=s(me);destroyRef=s(F);clientService=s(ie);listClientsService=s(ue);detailClientService=s($);get isBrowser(){return Z(this.platformId)}clientId;client=b(null);constructor(){this.clientId=this.activatedRoute.snapshot.params.id}ngOnInit(){this.fetchClientById(),this.detailClientService.newAddress$.pipe(_(this.destroyRef)).subscribe(()=>{this.fetchClientById()})}fetchClientById(){this.clientService.fetchOne(this.clientId).pipe(_(this.destroyRef)).subscribe(n=>{n&&n.id&&this.client.set(n)})}addNewAddress(){this.detailClientService.addNewAddress(this.clientId)}removeAddress(n){this.detailClientService.removeAddress(n)}addNewContact(){this.detailClientService.addNewContact(this.clientId)}removeContact(n){this.detailClientService.removeContact(n)}comeBackToList(){this.commonAdminService.comeBackToList("/list-clients")}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=y({type:a,selectors:[["detail-client"]],decls:72,vars:9,consts:[[1,"main_content"],[3,"primaryText","primaryLink"],[1,"box"],[1,"d-flex","justify-content-between"],[1,""],[1,"cp",3,"click"],[1,"fa-solid","fa-angles-left"],[1,"d-flex","justify-content-between","align-items-center","mt-4","mb-3"],["id","pills-tab","role","tablist",1,"nav","nav-pills","mb-4","div_pills"],["role","presentation",1,"nav-item"],["id","pills-info-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-info","role","tab","aria-controls","pills-info","aria-selected","true",1,"nav-link","active"],["id","pills-address-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-address","role","tab","aria-controls","pills-address","aria-selected","false",1,"nav-link"],["id","pills-contact-tab","data-bs-toggle","pill","type","button","data-bs-target","#pills-contact","role","tab","aria-controls","pills-contact","aria-selected","false",1,"nav-link"],[1,"hstack","gap-3"],["role","button","title","Agregar contacto","data-bs-toggle","contactModal","data-bs-target","#contactModal",1,"btn","btn-secondary",3,"click"],[1,"fa-solid","fa-address-book"],["role","button","title","Agregar direcci\xF3n","data-bs-toggle","addressModal","data-bs-target","#addressModal",1,"btn","btn-warning",3,"click"],[1,"fa-solid","fa-location-dot"],["role","button","title","Actualizar",1,"btn","btn-success","btn_detail",3,"routerLink"],[1,"fa-solid","fa-pen-to-square","action_icon_edit"],["id","pills-tabContent",1,"tab-content"],["id","pills-info","role","tabpanel","aria-labelledby","pills-info-tab","tabindex","0",1,"tab-pane","fade","active","show"],[1,"row","mt-3"],["id","pills-address","role","tabpanel","aria-labelledby","pills-address-tab","tabindex","0",1,"tab-pane","fade"],[1,"table","table-bordered"],["scope","col"],["id","pills-contact","role","tabpanel","aria-labelledby","pills-contact-tab","tabindex","0",1,"tab-pane","fade"],[3,"tracking"],[1,"col-12","col-md-4","col-lg-3","mb-3"],[3,"click"],["title","Eliminar",1,"fa-solid","fa-trash","icon_trash"],[1,"d-flex","justify-content-start"],[1,"alert","alert-warning"]],template:function(o,r){if(o&1&&(t(0,"div",0),c(1,"breadcrumb",1),t(2,"div",2)(3,"div",3)(4,"h3",4),i(5,"Detalle contacto"),e(),t(6,"h4",5),C("click",function(){return r.comeBackToList()}),c(7,"i",6),i(8," Regresar "),e()(),t(9,"div",7)(10,"ul",8)(11,"li",9)(12,"button",10),i(13," Informaci\xF3n "),e(),t(14,"button",11),i(15," Direcciones "),e(),t(16,"button",12),i(17," Personas "),e()()(),t(18,"div",13)(19,"a",14),C("click",function(){return r.addNewContact()}),c(20,"i",15),i(21," Agregar persona "),e(),t(22,"a",16),C("click",function(){return r.addNewAddress()}),c(23,"i",17),i(24," Agregar direcci\xF3n "),e(),t(25,"a",18),c(26,"i",19),i(27," Editar "),e()()(),t(28,"div",20)(29,"div",21),v(30,Me,38,11,"div",22),e(),t(31,"div",23)(32,"table",24)(33,"thead")(34,"tr")(35,"th",25),c(36,"i",17),e(),t(37,"th",25),i(38,"Provincia"),e(),t(39,"th",25),i(40,"Canton"),e(),t(41,"th",25),i(42,"Distrito"),e(),t(43,"th",25),i(44,"Direcci\xF3n exacta"),e(),t(45,"th",25),i(46,"Acci\xF3n"),e()()(),t(47,"tbody"),h(48,Ne,14,5,"tr",null,G,!1,we,4,0,"tr"),e()()(),t(51,"div",26)(52,"table",24)(53,"thead")(54,"tr")(55,"th",25),c(56,"i",17),e(),t(57,"th",25),i(58,"Nombre"),e(),t(59,"th",25),i(60,"Apellidos"),e(),t(61,"th",25),i(62,"Correo"),e(),t(63,"th",25),i(64,"Tel\xE9fono"),e(),t(65,"th",25),i(66,"Acci\xF3n"),e()()(),t(67,"tbody"),h(68,ke,14,5,"tr",null,G,!1,Re,4,0,"tr"),e()()()()()(),v(71,Pe,1,1,"tracking-entity",27)),o&2){let l,u;d(),p("primaryText","Listado de contactos")("primaryLink","/list-clients"),d(24),p("routerLink","/edit-client/"+r.clientId),d(5),f(r.client()?30:-1),d(18),E(((l=r.client())==null?null:l.addresses)||q(7,Ce)),d(20),E(((u=r.client())==null?null:u.contacts)||q(8,Ce)),d(3),f(r.client()?71:-1)}},dependencies:[te,fe,pe],encapsulation:2,changeDetection:0})};export{K as default};
